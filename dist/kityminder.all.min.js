/*!
 * ====================================================
 * kityminder - v1.2.1 - 2014-08-14
 * https://github.com/fex-team/kityminder
 * GitHub: https://github.com/fex-team/kityminder.git 
 * Copyright (c) 2014 f-cube @ FEX; Licensed MIT
 * ====================================================
 */

!function(window){function asc(a,b){return a.getIndex()-b.getIndex()}function desc(a,b){return-asc(a,b)}function canArrange(a){var b=a.getSelectedNode();return b&&b.parent&&b.parent.children.length>1}function fontUI(a,b,c,d){var e=new FUI.LabelPanel({label:a.getLang("panels.font"),id:"font-panel"}),f=new FUI.Panel({column:!0}),g=new FUI.Panel({column:!0}),h=c.generate("fontfamily",a.getOptions("fontfamily").map(function(a){return{label:{text:a.name,style:{fontFamily:a.val}},text:a.name,value:a.val}})),i=c.generate("fontsize",a.getOptions("fontsize").map(function(a){return{label:{text:a,style:{fontSize:a}},text:a,value:a}}));f.appendWidgets([h,i]);var j=d.generate("bold"),k=d.generate("italic");g.appendWidgets([j,k]),e.appendWidgets([f,g]),b.edit.appendWidget(e)}function generateSerisColor(){return["#e75d66","#fac75b","#99ca6a","#00c5ad","#3bbce0","#c9ced1","#425b71","white"]}!function(){function use(a){_p.r([moduleMapping[a]])}var _p={r:function(a){if(_p[a].inited)return _p[a].value;if("function"!=typeof _p[a].value)return _p[a].inited=!0,_p[a].value;var b={exports:{}},c=_p[a].value(null,b.exports,b);if(_p[a].inited=!0,_p[a].value=c,void 0!==c)return c;for(var d in b.exports)if(b.exports.hasOwnProperty(d))return _p[a].inited=!0,_p[a].value=b.exports,b.exports}};_p[0]={value:function(){function a(a){var b=parseFloat(a,10);return/ms/.test(a)?b:/s/.test(a)?1e3*b:/min/.test(a)?60*b*1e3:b}var b=_p.r(8),c=_p.r(1),d=_p.r(11).createClass("Animator",{constructor:function(a,b,c){if(1==arguments.length){var d=arguments[0];this.beginValue=d.beginValue,this.finishValue=d.finishValue,this.setter=d.setter}else this.beginValue=a,this.finishValue=b,this.setter=c},start:function(b,c,d,e,f){2===arguments.length&&"object"==typeof c&&(d=c.easing,e=c.delay,f=c.callback,c=c.duration),4===arguments.length&&"function"==typeof e&&(f=e,e=0);var g=this.create(b,c,d,f);return e=a(e),e>0?setTimeout(function(){g.play()},e):g.play(),g},create:function(e,f,g,h){var i;return f=f&&a(f)||d.DEFAULT_DURATION,g=g||d.DEFAULT_EASING,"string"==typeof g&&(g=c[g]),i=new b(this,e,f,g),"function"==typeof h&&i.on("finish",h),i},reverse:function(){return new d(this.finishValue,this.beginValue,this.setter)}});d.DEFAULT_DURATION=300,d.DEFAULT_EASING="linear";var e=_p.r(61);return _p.r(11).extendClass(e,{animate:function(a,b,c,d,e){function f(){g.shift(),g.length&&setTimeout(g[0].t.play.bind(g[0].t),g[0].d)}var g=this._KityAnimateQueue=this._KityAnimateQueue||[],h=a.create(this,b,c,e);return h.on("finish",f),g.push({t:h,d:d}),1==g.length&&setTimeout(h.play.bind(h),d),this},timeline:function(){return this._KityAnimateQueue[0].t},stop:function(){var a=this._KityAnimateQueue;if(a)for(;a.length;)a.shift().t.stop();return this}}),d}},_p[1]={value:function(){var a={linear:function(a,b,c,d){return c*(a/d)+b},swing:function(b,c,d,e){return a.easeOutQuad(b,c,d,e)},ease:function(b,c,d,e){return a.easeInOutCubic(b,c,d,e)},easeInQuad:function(a,b,c,d){return c*(a/=d)*a+b},easeOutQuad:function(a,b,c,d){return-c*(a/=d)*(a-2)+b},easeInOutQuad:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b},easeInCubic:function(a,b,c,d){return c*(a/=d)*a*a+b},easeOutCubic:function(a,b,c,d){return c*((a=a/d-1)*a*a+1)+b},easeInOutCubic:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a+b:c/2*((a-=2)*a*a+2)+b},easeInQuart:function(a,b,c,d){return c*(a/=d)*a*a*a+b},easeOutQuart:function(a,b,c,d){return-c*((a=a/d-1)*a*a*a-1)+b},easeInOutQuart:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a*a+b:-c/2*((a-=2)*a*a*a-2)+b},easeInQuint:function(a,b,c,d){return c*(a/=d)*a*a*a*a+b},easeOutQuint:function(a,b,c,d){return c*((a=a/d-1)*a*a*a*a+1)+b},easeInOutQuint:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a*a*a+b:c/2*((a-=2)*a*a*a*a+2)+b},easeInSine:function(a,b,c,d){return-c*Math.cos(a/d*(Math.PI/2))+c+b},easeOutSine:function(a,b,c,d){return c*Math.sin(a/d*(Math.PI/2))+b},easeInOutSine:function(a,b,c,d){return-c/2*(Math.cos(Math.PI*a/d)-1)+b},easeInExpo:function(a,b,c,d){return 0===a?b:c*Math.pow(2,10*(a/d-1))+b},easeOutExpo:function(a,b,c,d){return a==d?b+c:c*(-Math.pow(2,-10*a/d)+1)+b},easeInOutExpo:function(a,b,c,d){return 0===a?b:a==d?b+c:(a/=d/2)<1?c/2*Math.pow(2,10*(a-1))+b:c/2*(-Math.pow(2,-10*--a)+2)+b},easeInCirc:function(a,b,c,d){return-c*(Math.sqrt(1-(a/=d)*a)-1)+b},easeOutCirc:function(a,b,c,d){return c*Math.sqrt(1-(a=a/d-1)*a)+b},easeInOutCirc:function(a,b,c,d){return(a/=d/2)<1?-c/2*(Math.sqrt(1-a*a)-1)+b:c/2*(Math.sqrt(1-(a-=2)*a)+1)+b},easeInElastic:function(a,b,c,d){var e=1.70158,f=0,g=c;return 0===a?b:1==(a/=d)?b+c:(f||(f=.3*d),g<Math.abs(c)?(g=c,e=f/4):e=f/(2*Math.PI)*Math.asin(c/g),-(g*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-e)*Math.PI/f))+b)},easeOutElastic:function(a,b,c,d){var e=1.70158,f=0,g=c;return 0===a?b:1==(a/=d)?b+c:(f||(f=.3*d),g<Math.abs(c)?(g=c,e=f/4):e=f/(2*Math.PI)*Math.asin(c/g),g*Math.pow(2,-10*a)*Math.sin(2*(a*d-e)*Math.PI/f)+c+b)},easeInOutElastic:function(a,b,c,d){var e=1.70158,f=0,g=c;if(0===a)return b;if(2==(a/=d/2))return b+c;if(f||(f=.3*d*1.5),g<Math.abs(c)){g=c;var e=f/4}else var e=f/(2*Math.PI)*Math.asin(c/g);return 1>a?-.5*g*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-e)*Math.PI/f)+b:g*Math.pow(2,-10*(a-=1))*Math.sin(2*(a*d-e)*Math.PI/f)*.5+c+b},easeInBack:function(a,b,c,d,e){return void 0==e&&(e=1.70158),c*(a/=d)*a*((e+1)*a-e)+b},easeOutBack:function(a,b,c,d,e){return void 0==e&&(e=1.70158),c*((a=a/d-1)*a*((e+1)*a+e)+1)+b},easeInOutBack:function(a,b,c,d,e){return void 0==e&&(e=1.70158),(a/=d/2)<1?c/2*a*a*(((e*=1.525)+1)*a-e)+b:c/2*((a-=2)*a*(((e*=1.525)+1)*a+e)+2)+b},easeInBounce:function(b,c,d,e){return d-a.easeOutBounce(e-b,0,d,e)+c},easeOutBounce:function(a,b,c,d){return(a/=d)<1/2.75?7.5625*c*a*a+b:2/2.75>a?c*(7.5625*(a-=1.5/2.75)*a+.75)+b:2.5/2.75>a?c*(7.5625*(a-=2.25/2.75)*a+.9375)+b:c*(7.5625*(a-=2.625/2.75)*a+.984375)+b},easeInOutBounce:function(b,c,d,e){return e/2>b?.5*a.easeInBounce(2*b,0,d,e)+c:.5*a.easeOutBounce(2*b-e,0,d,e)+.5*d+c}};return a}},_p[2]={value:function(a,b){function c(a){1===l.push(a)&&(i=j(d))}function d(){var a=l;for(l=[];a.length;)h(a.pop());i=0}function e(a){var b=g(a);return c(b),b}function f(a){var b=l.indexOf(a);~b&&l.splice(b,1),0===l.length&&k(i)}function g(a){var b={index:0,time:+new Date,elapsed:0,action:a,next:function(){c(b)}};return b}function h(a){var b=+new Date,c=b-a.time;c>200&&(c=1e3/60),a.dur=c,a.elapsed+=c,a.time=b,a.action.call(null,a),a.index++}var i,j=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return setTimeout(a,1e3/60)},k=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||window.clearTimeout,l=[];b.requestFrame=e,b.releaseFrame=f}},_p[3]={value:function(){var a=_p.r(0),b=_p.r(35),c=_p.r(47),d=_p.r(61),e=_p.r(11).createClass("MotionAnimator",{base:a,constructor:function(a,d){var e=this;this.callBase({beginValue:0,finishValue:1,setter:function(a,d){var f=e.motionPath instanceof c?e.motionPath.getPathData():e.motionPath,g=b.pointAtPath(f,d);a.setTranslate(g.x,g.y),this.doRotate&&a.setRotate(g.tan.getAngle())}}),this.doRotate=d,this.motionPath=a}});return _p.r(11).extendClass(d,{motion:function(a,b,c,d,f){return this.animate(new e(a),b,c,d,f)}}),e}},_p[4]={value:function(){var a=_p.r(0),b=_p.r(11).createClass("OpacityAnimator",{base:a,constructor:function(a){this.callBase({beginValue:function(a){return a.getOpacity()},finishValue:a,setter:function(a,b){a.setOpacity(b)}})}}),c=_p.r(61);return _p.r(11).extendClass(c,{fxOpacity:function(a,c,d,e,f){return this.animate(new b(a),c,d,e,f)},fadeTo:function(){return this.fxOpacity.apply(this,arguments)},fadeIn:function(){return this.fxOpacity.apply(this,[1].concat([].slice.call(arguments)))},fadeOut:function(){return this.fxOpacity.apply(this,[0].concat([].slice.call(arguments)))}}),b}},_p[5]={value:function(){var a=_p.r(0),b=_p.r(35),c=_p.r(11).createClass("OpacityAnimator",{base:a,constructor:function(a){this.callBase({beginValue:function(a){return this.beginPath=a.getPathData(),0},finishValue:1,setter:function(c,d){c.setPathData(b.pathTween(this.beginPath,a,d))}})}}),d=_p.r(47);return _p.r(11).extendClass(d,{fxPath:function(a,b,d,e,f){return this.animate(new c(a),b,d,e,f)}}),c}},_p[6]={value:function(){var a=_p.r(0),b=_p.r(11).createClass("RotateAnimator",{base:a,constructor:function(a){this.callBase({beginValue:0,finishValue:a,setter:function(a,b,c){var d=c.getDelta();a.rotate(d,ax,ay)}})}}),c=_p.r(61);return _p.r(11).extendClass(c,{fxRotate:function(a,c,d,e,f){return this.animate(new b(a),c,d,e,f)}}),b}},_p[7]={value:function(){var a=_p.r(0),b=_p.r(11).createClass("ScaleAnimator",{base:a,constructor:function(a,b){this.callBase({beginValue:0,finishValue:1,setter:function(c,d,e){var f=e.getDelta(),g=Math.pow(a,f),h=Math.pow(b,f);c.scale(h,g)}})}}),c=_p.r(61);return _p.r(11).extendClass(c,{fxScale:function(a,c,d,e,f,g){return this.animate(new b(a,c),d,e,f,g)}}),b}},_p[8]={value:function(){function a(a,b,c){return f.paralle(a,b,function(a,b){return a+(b-a)*c})}function b(a,b){return f.paralle(a,b,function(a,b){return b-a})}function c(a,b,c){this.timeline=a,this.target=a.target,this.type=b;for(var d in c)c.hasOwnProperty(d)&&(this[d]=c[d])}var d=_p.r(34),e=_p.r(2),f=_p.r(12),g=_p.r(11).createClass("Timeline",{mixins:[d],constructor:function(a,b,c,d){this.callMixin(),this.target=b,this.time=0,this.duration=c,this.easing=d,this.animator=a,this.beginValue=a.beginValue,this.finishValue=a.finishValue,this.setter=a.setter,this.status="ready"},nextFrame:function(a){"playing"==this.status&&(this.time+=a.dur,this.setValue(this.getValue()),this.time>=this.duration&&this.timeUp(),a.next())},getPlayTime:function(){return this.rollbacking?this.duration-this.time:this.time},getTimeProportion:function(){return this.getPlayTime()/this.duration},getValueProportion:function(){return this.easing(this.getPlayTime(),0,1,this.duration)},getValue:function(){var b=this.beginValue,c=this.finishValue,d=this.getValueProportion();return a(b,c,d)},setValue:function(a){this.lastValue=this.currentValue,this.currentValue=a,this.setter.call(this.target,this.target,a,this)},getDelta:function(){return this.lastValue=void 0===this.lastValue?this.beginValue:this.lastValue,b(this.lastValue,this.currentValue)},play:function(){var a=this.status;switch(this.status="playing",a){case"ready":f.isFunction(this.beginValue)&&(this.beginValue=this.beginValue.call(this.target,this.target)),f.isFunction(this.finishValue)&&(this.finishValue=this.finishValue.call(this.target,this.target)),this.time=0,this.setValue(this.beginValue),this.frame=e.requestFrame(this.nextFrame.bind(this));break;case"finished":case"stoped":this.time=0,this.frame=e.requestFrame(this.nextFrame.bind(this));break;case"paused":this.frame.next()}return this.fire("play",new c(this,"play",{lastStatus:a})),this},pause:function(){return this.status="paused",this.fire("pause",new c(this,"pause")),e.releaseFrame(this.frame),this},stop:function(){return this.status="stoped",this.setValue(this.finishValue),this.rollbacking=!1,this.fire("stop",new c(this,"stop")),e.releaseFrame(this.frame),this},timeUp:function(){this.repeatOption?(this.time=0,this.rollback?this.rollbacking?(this.decreaseRepeat(),this.rollbacking=!1):(this.rollbacking=!0,this.fire("rollback",new c(this,"rollback"))):this.decreaseRepeat(),this.repeatOption?this.fire("repeat",new c(this,"repeat")):this.finish()):this.finish()},finish:function(){this.setValue(this.finishValue),this.status="finished",this.fire("finish",new c(this,"finish")),e.releaseFrame(this.frame)},decreaseRepeat:function(){this.repeatOption!==!0&&this.repeatOption--},repeat:function(a,b){return this.repeatOption=a,this.rollback=b,this}});return g.requestFrame=e.requestFrame,g.releaseFrame=e.releaseFrame,g}},_p[9]={value:function(){var a=_p.r(0),b=_p.r(11).createClass("TranslateAnimator",{base:a,constructor:function(a,b){this.callBase({x:0,y:0},{x:a,y:b},function(a,b,c){var d=c.getDelta();a.translate(d.x,d.y)})}}),c=_p.r(61);return _p.r(11).extendClass(c,{fxTranslate:function(a,c,d,e,f,g){return this.animate(new b(a,c),d,e,f,g)}}),b}},_p[10]={value:function(){var a=function(){var a,b=navigator.userAgent.toLowerCase(),c=window.opera;a={ie:/(msie\s|trident.*rv:)([\w.]+)/.test(b),opera:!!c&&c.version,webkit:b.indexOf(" applewebkit/")>-1,mac:b.indexOf("macintosh")>-1},a.gecko="Gecko"==navigator.product&&!a.webkit&&!a.opera&&!a.ie;var d=0;if(a.ie&&(d=1*(b.match(/(msie\s|trident.*rv:)([\w.]+)/)[2]||0),a.ie11Compat=11==document.documentMode,a.ie9Compat=9==document.documentMode),a.gecko){var e=b.match(/rv:([\d\.]+)/);e&&(e=e[1].split("."),d=1e4*e[0]+100*(e[1]||0)+1*(e[2]||0))}return/chrome\/(\d+\.\d)/i.test(b)&&(a.chrome=+RegExp.$1),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(b)&&!/chrome/i.test(b)&&(a.safari=+(RegExp.$1||RegExp.$2)),a.opera&&(d=parseFloat(c.version())),a.webkit&&(d=parseFloat(b.match(/ applewebkit\/(\d+)/)[1])),a.version=d,a.isCompatible=!a.mobile&&(a.ie&&d>=6||a.gecko&&d>=10801||a.opera&&d>=9.5||a.air&&d>=1||a.webkit&&d>=522||!1),a}();return a}},_p[11]={value:function(require,exports){function Class(){}function checkBaseConstructorCall(a,b){var c=a.toString();if(!/this\.callBase/.test(c))throw new Error(b+" : 类构造函数没有调用父类的构造函数！为了安全，请调用父类的构造函数")}function inherit(constructor,BaseClass,classname){var KityClass=eval("(function "+classname+"( __inherit__flag ) {if( __inherit__flag != KITY_INHERIT_FLAG ) {KityClass.__KityConstructor.apply(this, arguments);}this.__KityClassName = KityClass.__KityClassName;})");KityClass.__KityConstructor=constructor,KityClass.prototype=new BaseClass(KITY_INHERIT_FLAG);for(var methodName in BaseClass.prototype)BaseClass.prototype.hasOwnProperty(methodName)&&0!==methodName.indexOf("__Kity")&&(KityClass.prototype[methodName]=BaseClass.prototype[methodName]);return KityClass.prototype.constructor=KityClass,KityClass}function mixin(a,b){if(!1==b instanceof Array)return a;var c,d,e,f=b.length;for(a.__KityMixins={constructor:[]},c=0;f>c;c++){d=b[c].prototype;for(e in d)!1!==d.hasOwnProperty(e)&&0!==e.indexOf("__Kity")&&("constructor"===e?a.__KityMixins.constructor.push(d[e]):a.prototype[e]=a.__KityMixins[e]=d[e])}return a}function extend(a,b){b.__KityClassName&&(b=b.prototype);for(var c in b)if(b.hasOwnProperty(c)&&c.indexOf("__Kity")&&"constructor"!=c){var d=a.prototype[c]=b[c];d.__KityMethodClass=a,d.__KityMethodName=c}return a}Function.prototype.bind=Function.prototype.bind||function(a){var b=Array.prototype.slice.call(arguments,1);return this.apply(a,b)},exports.Class=Class,Class.__KityClassName="Class",Class.prototype.base=function(a){var b=arguments.callee.caller,c=b.__KityMethodClass.__KityBaseClass.prototype[a];return c.apply(this,Array.prototype.slice.call(arguments,1))},Class.prototype.callBase=function(){var a=arguments.callee.caller,b=a.__KityMethodClass.__KityBaseClass.prototype[a.__KityMethodName];return b.apply(this,arguments)},Class.prototype.mixin=function(a){var b=arguments.callee.caller,c=b.__KityMethodClass.__KityMixins;if(!c)return this;var d=c[a];return d.apply(this,Array.prototype.slice.call(arguments,1))},Class.prototype.callMixin=function(){var a=arguments.callee.caller,b=a.__KityMethodName,c=a.__KityMethodClass.__KityMixins;if(!c)return this;var d=c[b];if("constructor"==b){for(var e=0,f=d.length;f>e;e++)d[e].call(this);return this}return d.apply(this,arguments)},Class.prototype.pipe=function(a){return"function"==typeof a&&a.call(this,this),this},Class.prototype.getType=function(){return this.__KityClassName},Class.prototype.getClass=function(){return this.constructor};var KITY_INHERIT_FLAG="__KITY_INHERIT_FLAG_"+ +new Date;exports.createClass=function(a,b){var c,d,e;return 1===arguments.length&&(b=arguments[0],a="AnonymousClass"),e=b.base||Class,b.hasOwnProperty("constructor")?(c=b.constructor,e!=Class&&checkBaseConstructorCall(c,a)):c=function(){this.callBase.apply(this,arguments),this.callMixin.apply(this,arguments)},d=inherit(c,e,a),d=mixin(d,b.mixins),d.__KityClassName=c.__KityClassName=a,d.__KityBaseClass=c.__KityBaseClass=e,d.__KityMethodName=c.__KityMethodName="constructor",d.__KityMethodClass=c.__KityMethodClass=d,delete b.mixins,delete b.constructor,delete b.base,d=extend(d,b)},exports.extendClass=extend}},_p[12]={value:function(){var a={each:function(a,b,c){if(null!==a)if(a.length===+a.length){for(var d=0,e=a.length;e>d;d++)if(b.call(c,a[d],d,a)===!1)return!1}else for(var f in a)if(a.hasOwnProperty(f)&&b.call(c,a[f],f,a)===!1)return!1},extend:function(a){for(var b=arguments,c=this.isBoolean(b[b.length-1])?b[b.length-1]:!1,d=this.isBoolean(b[b.length-1])?b.length-1:b.length,e=1;d>e;e++){var f=b[e];for(var g in f)c&&a.hasOwnProperty(g)||(a[g]=f[g])}return a},deepExtend:function(a){for(var b=arguments,c=this.isBoolean(b[b.length-1])?b[b.length-1]:!1,d=this.isBoolean(b[b.length-1])?b.length-1:b.length,e=1;d>e;e++){var f=b[e];for(var g in f)c&&a.hasOwnProperty(g)||(this.isObject(a[g])&&this.isObject(f[g])?this.deepExtend(a[g],f[g],c):a[g]=f[g])}return a},clone:function(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b},copy:function(a){return"object"!=typeof a?a:"function"==typeof a?null:JSON.parse(JSON.stringify(a))},queryPath:function(a,b){for(var c=a.split("."),d=0,e=b,f=c.length;f>d;){if(!(c[d]in e))return void 0;if(e=e[c[d]],d++,d>=f||void 0===e)return e}},getValue:function(a,b){return void 0!==a?a:b},flatten:function(b){var c,d=[],e=b.length;for(c=0;e>c;c++)b[c]instanceof Array?d=d.concat(a.flatten(b[c])):d.push(b[c]);return d},paralle:function(b,c,d){var e,f,g,h;if(b instanceof Array){for(h=[],f=0;f<b.length;f++)h.push(a.paralle(b[f],c[f],d));return h}if(b instanceof Object){if(e=b.getClass&&b.getClass(),e&&e.parse)b=b.valueOf(),c=c.valueOf(),h=a.paralle(b,c,d),h=e.parse(h);else{h={};for(g in b)b.hasOwnProperty(g)&&c.hasOwnProperty(g)&&(h[g]=a.paralle(b[g],c[g],d))}return h}return!1===isNaN(parseFloat(b))?d(b,c):h},parallelize:function(b){return function(c,d){return a.paralle(c,d,b)}}};return a.each(["String","Function","Array","Number","RegExp","Object","Boolean"],function(b){a["is"+b]=function(a){return Object.prototype.toString.apply(a)=="[object "+b+"]"}}),a}},_p[13]={value:function(){var a=_p.r(16),b=_p.r(12),c=_p.r(11).createClass("ColorMatrixEffect",{base:a,constructor:function(d,e){this.callBase(a.NAME_COLOR_MATRIX),this.set("type",b.getValue(d,c.TYPE_MATRIX)),this.set("in",b.getValue(e,a.INPUT_SOURCE_GRAPHIC))}});return b.extend(c,{TYPE_MATRIX:"matrix",TYPE_SATURATE:"saturate",TYPE_HUE_ROTATE:"hueRotate",TYPE_LUMINANCE_TO_ALPHA:"luminanceToAlpha",MATRIX_ORIGINAL:"10000010000010000010".split("").join(" "),MATRIX_EMPTY:"00000000000000000000".split("").join(" ")}),c}},_p[14]={value:function(){var a=_p.r(16),b=_p.r(12),c=_p.r(11).createClass("CompositeEffect",{base:a,constructor:function(d,e,f){this.callBase(a.NAME_COMPOSITE),this.set("operator",b.getValue(d,c.OPERATOR_OVER)),e&&this.set("in",e),f&&this.set("in2",f)}});return b.extend(c,{OPERATOR_OVER:"over",OPERATOR_IN:"in",OPERATOR_OUT:"out",OPERATOR_ATOP:"atop",OPERATOR_XOR:"xor",OPERATOR_ARITHMETIC:"arithmetic"}),c}},_p[15]={value:function(){var a=_p.r(16),b=_p.r(12),c=_p.r(11).createClass("ConvolveMatrixEffect",{base:a,constructor:function(d,e){this.callBase(a.NAME_CONVOLVE_MATRIX),this.set("edgeMode",b.getValue(d,c.MODE_DUPLICATE)),this.set("in",b.getValue(e,a.INPUT_SOURCE_GRAPHIC))}});return b.extend(c,{MODE_DUPLICATE:"duplicate",MODE_WRAP:"wrap",MODE_NONE:"none"}),c}},_p[16]={value:function(){var a=_p.r(68),b=_p.r(11).createClass("Effect",{constructor:function(b){this.node=a.createNode(b)},getId:function(){return this.node.id},setId:function(a){return this.node.id=a,this},set:function(a,b){return this.node.setAttribute(a,b),this},get:function(a){return this.node.getAttribute(a)},getNode:function(){return this.node},toString:function(){return this.node.getAttribute("result")||""}});return _p.r(12).extend(b,{NAME_GAUSSIAN_BLUR:"feGaussianBlur",NAME_OFFSET:"feOffset",NAME_COMPOSITE:"feComposite",NAME_COLOR_MATRIX:"feColorMatrix",NAME_CONVOLVE_MATRIX:"feConvolveMatrix",INPUT_SOURCE_GRAPHIC:"SourceGraphic",INPUT_SOURCE_ALPHA:"SourceAlpha",INPUT_BACKGROUND_IMAGE:"BackgroundImage",INPUT_BACKGROUND_ALPHA:"BackgroundAlpha",INPUT_FILL_PAINT:"FillPaint",INPUT_STROKE_PAINT:"StrokePaint"}),b}},_p[17]={value:function(){var a=_p.r(16),b=_p.r(12);return _p.r(11).createClass("GaussianblurEffect",{base:a,constructor:function(c,d){this.callBase(a.NAME_GAUSSIAN_BLUR),this.set("stdDeviation",b.getValue(c,1)),this.set("in",b.getValue(d,a.INPUT_SOURCE_GRAPHIC))}})}},_p[18]={value:function(){var a=_p.r(16),b=_p.r(12);return _p.r(11).createClass("OffsetEffect",{base:a,constructor:function(c,d,e){this.callBase(a.NAME_OFFSET),this.set("dx",b.getValue(c,0)),this.set("dy",b.getValue(d,0)),this.set("in",b.getValue(e,a.INPUT_SOURCE_GRAPHIC))}})}},_p[19]={value:function(){return _p.r(11).createClass("EffectContainer",{base:_p.r(29),addEffect:function(){return this.addItem.apply(this,arguments)},prependEffect:function(){return this.prependItem.apply(this,arguments)},appendEffect:function(){return this.appendItem.apply(this,arguments)},removeEffect:function(){return this.removeItem.apply(this,arguments)},addEffects:function(){return this.addItems.apply(this,arguments)},setEffects:function(){return this.setItems.apply(this,arguments)},getEffect:function(){return this.getItem.apply(this,arguments)},getEffects:function(){return this.getItems.apply(this,arguments)},getFirstEffect:function(){return this.getFirstItem.apply(this,arguments)},getLastEffect:function(){return this.getLastItem.apply(this,arguments)},handleAdd:function(a,b){var c=this.getEffects().length,d=this.getItem(b+1);return c===b+1?void this.node.appendChild(a.getNode()):void this.node.insertBefore(a.getNode(),d.getNode())}})}},_p[20]={value:function(){var a=_p.r(68),b=_p.r(11),c=b.createClass("Filter",{mixins:[_p.r(19)],constructor:function(b,c,d,e){this.node=a.createNode("filter"),void 0!==b&&this.set("x",b),void 0!==c&&this.set("y",c),void 0!==d&&this.set("width",d),void 0!==e&&this.set("height",e)},getId:function(){return this.id},setId:function(a){return this.node.id=a,this},set:function(a,b){return this.node.setAttribute(a,b),this},get:function(a){return this.node.getAttribute(a)},getNode:function(){return this.node}}),d=_p.r(61);return b.extendClass(d,{applyFilter:function(a){var b=a.get("id");return b&&this.node.setAttribute("filter","url(#"+b+")"),this}}),c}},_p[21]={value:function(){var a=_p.r(17);return _p.r(11).createClass("GaussianblurFilter",{base:_p.r(20),constructor:function(b){this.callBase(),this.addEffect(new a(b))}})}},_p[22]={value:function(){var a=_p.r(17),b=_p.r(16),c=_p.r(13),d=_p.r(28),e=_p.r(12),f=_p.r(14),g=_p.r(18);return _p.r(11).createClass("ProjectionFilter",{base:_p.r(20),constructor:function(d,e,h){this.callBase(),this.gaussianblurEffect=new a(d,b.INPUT_SOURCE_ALPHA),this.gaussianblurEffect.set("result","gaussianblur"),this.addEffect(this.gaussianblurEffect),this.offsetEffect=new g(e,h,this.gaussianblurEffect),this.offsetEffect.set("result","offsetBlur"),this.addEffect(this.offsetEffect),this.colorMatrixEffect=new c(c.TYPE_MATRIX,this.offsetEffect),this.colorMatrixEffect.set("values",c.MATRIX_ORIGINAL),this.colorMatrixEffect.set("result","colorOffsetBlur"),this.addEffect(this.colorMatrixEffect),this.compositeEffect=new f(f.OPERATOR_OVER,b.INPUT_SOURCE_GRAPHIC,this.colorMatrixEffect),this.addEffect(this.compositeEffect)},setColor:function(a){var b=null,f=[];if(e.isString(a)&&(a=d.parse(a)),!a)return this;b=c.MATRIX_EMPTY.split(" "),f.push(a.get("r")),f.push(a.get("g")),f.push(a.get("b"));for(var g=0,h=f.length;h>g;g++)b[5*g+3]=f[g]/255;return b[18]=a.get("a"),this.colorMatrixEffect.set("values",b.join(" ")),this},setOpacity:function(a){var b=this.colorMatrixEffect.get("values").split(" ");return b[18]=a,this.colorMatrixEffect.set("values",b.join(" ")),this},setOffset:function(a,b){this.setOffsetX(a),this.setOffsetY(b)},setOffsetX:function(a){this.offsetEffect.set("dx",a)},setOffsetY:function(a){this.offsetEffect.set("dy",a)},setDeviation:function(a){this.gaussianblurEffect.set("stdDeviation",a)}})}},_p[23]={value:function(){return _p.r(11).createClass("Bezier",{mixins:[_p.r(52)],base:_p.r(47),constructor:function(a){this.callBase(),a=a||[],this.changeable=!0,this.setBezierPoints(a)},getBezierPoints:function(){return this.getPoints()},setBezierPoints:function(a){return this.setPoints(a)},onContainerChanged:function(){this.changeable&&this.update()},update:function(){var a=null,b=this.getBezierPoints();if(!(b.length<2)){a=this.getDrawer(),a.clear();var c=b[0].getVertex(),d=null,e=null;a.moveTo(c.x,c.y);for(var f=1,g=b.length;g>f;f++)c=b[f].getVertex(),e=b[f].getBackward(),d=b[f-1].getForward(),a.bezierTo(d.x,d.y,e.x,e.y,c.x,c.y);return this}}})}},_p[24]={value:function(){var a=_p.r(64),b=_p.r(74),c=_p.r(11).createClass("BezierPoint",{constructor:function(b,c,d){this.vertex=new a(b,c),this.forward=new a(b,c),this.backward=new a(b,c),this.setSmooth(void 0===d||d),this.setSymReflaction(!0)},clone:function(){var a=new c,b=null;return b=this.getVertex(),a.setVertex(b.x,b.y),b=this.getForward(),a.setForward(b.x,b.y),b=this.getBackward(),a.setBackward(b.x,b.y),a.setSymReflaction(this.isSymReflaction),a.setSmooth(this.isSmooth()),a},setVertex:function(a,b){return this.vertex.setPoint(a,b),this.update(),this},moveTo:function(a,b){var c=this.forward.getPoint(),d=this.backward.getPoint(),e=this.vertex.getPoint(),f={left:a-e.x,top:b-e.y};this.forward.setPoint(c.x+f.left,c.y+f.top),this.backward.setPoint(d.x+f.left,d.y+f.top),this.vertex.setPoint(a,b),this.update()},setForward:function(a,b){return this.forward.setPoint(a,b),this.smooth&&this.updateAnother(this.forward,this.backward),this.update(),this.lastControlPointSet=this.forward,this},setBackward:function(a,b){return this.backward.setPoint(a,b),this.smooth&&this.updateAnother(this.backward,this.forward),this.update(),this.lastControlPointSet=this.backward,this},setSymReflaction:function(a){return this.symReflaction=a,this.smooth&&this.setSmooth(!0),this},isSymReflaction:function(){return this.symReflaction},updateAnother:function(a,c){var d=this.getVertex(),e=b.fromPoints(a.getPoint(),d),f=b.fromPoints(d,c.getPoint());return f=e.normalize(this.isSymReflaction()?e.length():f.length()),c.setPoint(d.x+f.x,d.y+f.y),this},setSmooth:function(a){var b;return this.smooth=!!a,this.smooth&&(b=this.lastControlPointSet)&&this.updateAnother(b,b==this.forward?this.backward:this.forward),this},isSmooth:function(){return this.smooth},getVertex:function(){return this.vertex.getPoint()},getForward:function(){return this.forward.getPoint()},getBackward:function(){return this.backward.getPoint()},update:function(){return this.container?void(this.container.update&&this.container.update(this)):this}});return c}},_p[25]={value:function(){var a=_p.r(11).createClass("Box",{constructor:function(a,b,c,d){var e=arguments[0];e&&"object"==typeof e&&(a=e.x,b=e.y,c=e.width,d=e.height),0>c&&(a-=c=-c),0>d&&(b-=d=-d),this.x=a||0,this.y=b||0,this.width=c||0,this.height=d||0,this.left=this.x,this.right=this.x+this.width,this.top=this.y,this.bottom=this.y+this.height,this.cx=this.x+this.width/2,this.cy=this.y+this.height/2},getRangeX:function(){return[this.left,this.right]},getRangeY:function(){return[this.top,this.bottom]},merge:function(b){var c=Math.min(this.left,b.left),d=Math.max(this.right,b.right),e=Math.min(this.top,b.top),f=Math.max(this.bottom,b.bottom);return new a(c,e,d-c,f-e)},expand:function(b,c,d,e){if(arguments.length<1)return new a(this);arguments.length<2&&(c=b),arguments.length<3&&(d=b),arguments.length<4&&(e=c);var f=this.left-e,g=this.top-b,h=this.width+c,i=this.height+b;return new a(f,g,h,i)},valueOf:function(){return[this.x,this.y,this.width,this.height]},toString:function(){return this.valueOf().join(" ")}});return a.parse=function(b){return"string"==typeof b?a.parse(b.split(/[\s,]+/).map(parseFloat)):b instanceof Array?new a(b[0],b[1],b[2],b[3]):"x"in b?new a(b):null},a}},_p[26]={value:function(){return _p.r(11).createClass("Circle",{base:_p.r(33),constructor:function(a,b,c){this.callBase(a,a,b,c)},getRadius:function(){return this.getRadiusX()},setRadius:function(a){return this.callBase(a,a)}})}},_p[27]={value:function(){var a=_p.r(11),b=_p.r(61),c=a.createClass("Clip",{base:b,mixins:[_p.r(62)],constructor:function(){this.callBase("clipPath")},clip:function(a){return a.getNode().setAttribute("clip-path","url(#"+this.getId()+")"),this}});return a.extendClass(b,{clipWith:function(a){return a.clip(this),this}}),c}},_p[28]={value:function(){var a=_p.r(12),b=_p.r(65),c={},d=_p.r(11).createClass("Color",{constructor:function(){var b=null;"string"==typeof arguments[0]?(b=c.parseToValue(arguments[0]),null===b&&(b={r:0,g:0,b:0,h:0,s:0,l:0,a:1})):(b={r:0|arguments[0],g:0|arguments[1],b:0|arguments[2],a:parseFloat(arguments[3])||1},b=c.overflowFormat(b),b=a.extend(b,c.rgbValueToHslValue(b))),this._color=b},set:function(b,e){if(!d._MAX_VALUE[b])throw new Error("Color set(): Illegal parameter");return"a"!==b&&(e=Math.floor(e)),"h"==b&&(e=(e+360)%360),this._color[b]=Math.max(d._MIN_VALUE[b],Math.min(d._MAX_VALUE[b],e)),-1!=="rgb".indexOf(b)?this._color=a.extend(this._color,c.rgbValueToHslValue(this._color)):-1!=="hsl".indexOf(b)&&(this._color=a.extend(this._color,c.hslValueToRGBValue(this._color))),this},inc:function(a,b){return b=this.get(a)+b,"h"==a?b=(b+360)%360:(b=Math.min(d._MAX_VALUE[a],b),b=Math.max(d._MIN_VALUE[a],b)),this.clone().set(a,b)},dec:function(a,b){return this.inc(a,-b)},clone:function(){return new d(this.toRGBA())},get:function(a){return d._MAX_VALUE[a]?this._color[a]:null},getValues:function(){return a.clone(this._color)},valueOf:function(){return this.getValues()},toRGB:function(){return c.toString(this._color,"rgb")},toRGBA:function(){return c.toString(this._color,"rgba")},toHEX:function(){return c.toString(this._color,"hex")},toHSL:function(){return c.toString(this._color,"hsl")},toHSLA:function(){return c.toString(this._color,"hsla")},toString:function(){return 1===this._color.a?this.toRGB():this.toRGBA()}});return a.extend(d,{_MAX_VALUE:{r:255,g:255,b:255,h:360,s:100,l:100,a:1},_MIN_VALUE:{r:0,g:0,b:0,h:0,s:0,l:0,a:0},R:"r",G:"g",B:"b",H:"h",S:"s",L:"l",A:"a",parse:function(b){var e;return a.isString(b)&&(e=c.parseToValue(b)),a.isObject(b)&&"r"in b&&(e=b),null===e?new d:new d(e.r,e.g,e.b,e.a)},createHSL:function(a,b,c){return d.createHSLA(a,b,c,1)},createHSLA:function(a,b,c,e){var f=null;return b+="%",c+="%",f=["hsla("+a,b,c,e+")"],d.parse(f.join(", "))},createRGB:function(a,b,c){return d.createRGBA(a,b,c,1)},createRGBA:function(a,b,c,e){return new d(a,b,c,e)}}),a.extend(c,{parseToValue:function(a){var d={};if(a=b.EXTEND_STANDARD[a]||b.COLOR_STANDARD[a]||a,/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(a))d=c.hexToValue(a);else if(/^(rgba?)/i.test(a))d=c.rgbaToValue(a);else{if(!/^(hsla?)/i.test(a))return null;d=c.hslaToValue(a)}return c.overflowFormat(d)},hexToValue:function(b){var d={},e=["r","g","b"];return/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(b)?(b=RegExp.$1.split(""),a.each(e,function(a,e){d[a]=c.toNumber(3===b.length?b[e]+b[e]:b[2*e]+b[2*e+1])}),d=a.extend(d,c.rgbValueToHslValue(d)),d.a=1,d):null},rgbaToValue:function(b){var d={},e=!1,f=["r","g","b"];return/^(rgba?)/i.test(b)?(e=4===RegExp.$1.length,b=b.replace(/^rgba?/i,"").replace(/\s+/g,"").replace(/[^0-9,.]/g,"").split(","),a.each(f,function(a,c){d[a]=0|b[c]}),d=a.extend(d,c.rgbValueToHslValue(d)),d.a=e?parseFloat(b[3]):1,d):null},hslaToValue:function(b){var d={},e=!1;return/^(hsla?)/i.test(b)?(e=4===RegExp.$1.length,b=b.replace(/^hsla?/i,"").replace(/\s+/g,"").replace(/[^0-9,.]/g,"").split(","),d.h=0|b[0],d.s=0|b[1],d.l=0|b[2],d=a.extend(d,c.hslValueToRGBValue(d)),d=c.hslValueToRGBValue(d),d.a=e?parseFloat(b[3]):1,d):null},hslValueToRGBValue:function(b){function c(a,b,c){return 0>c?c+=1:c>1&&(c-=1),1>6*c?a+6*(b-a)*c:1>2*c?b:2>3*c?a+6*(b-a)*(2/3-c):a}var d=null,e=null,f={};return b=a.extend({},b),b.h=b.h/360,b.s=b.s/100,b.l=b.l/100,0===b.s?f.r=f.g=f.b=b.l:(d=b.l<.5?b.l*(1+b.s):b.l+b.s-b.l*b.s,e=2*b.l-d,f.r=c(e,d,b.h+1/3),f.g=c(e,d,b.h),f.b=c(e,d,b.h-1/3)),f.r=Math.min(Math.round(255*f.r),255),f.g=Math.min(Math.round(255*f.g),255),f.b=Math.min(Math.round(255*f.b),255),f
},rgbValueToHslValue:function(b){var c=null,d=null,e={};return b=a.extend({},b),b.r=b.r/255,b.g=b.g/255,b.b=b.b/255,c=Math.max(b.r,b.g,b.b),d=Math.min(b.r,b.g,b.b),c===d?e.h=0:c===b.r?e.h=b.g>=b.b?60*(b.g-b.b)/(c-d):60*(b.g-b.b)/(c-d)+360:c===b.g?e.h=60*(b.b-b.r)/(c-d)+120:c===b.b&&(e.h=60*(b.r-b.g)/(c-d)+240),e.l=(c+d)/2,e.s=0===e.l||c===d?0:e.l>0&&e.l<=.5?(c-d)/(c+d):(c-d)/(2-c-d),e.h=Math.round(e.h),e.s=Math.round(100*e.s),e.l=Math.round(100*e.l),e},toString:function(b,d){var e=[];return b=a.extend({},b),-1!==d.indexOf("hsl")&&(b.s+="%",b.l+="%"),"hex"!==d?(a.each(d.split(""),function(a){e.push(b[a])}),(d+"("+e.join(", ")+")").toLowerCase()):(e.push(c.toHexValue(+b.r)),e.push(c.toHexValue(+b.g)),e.push(c.toHexValue(+b.b)),("#"+e.join("")).toLowerCase())},toNumber:function(a){return 0|Number("0x"+a)},toHexValue:function(a){var b=a.toString(16);return 1===b.length?"0"+b:b},overflowFormat:function(b){var c=a.extend({},b),e="rgba";return a.each(e.split(""),function(a){c.hasOwnProperty(a)&&(c[a]=Math.min(d._MAX_VALUE[a],c[a]),c[a]=Math.max(d._MIN_VALUE[a],c[a]))}),c}}),d}},_p[29]={value:function(){function a(){return this.container.removeItem(this),this}return _p.r(11).createClass("Container",{getItems:function(){return this.items||(this.items=[])},getItem:function(a){return this.getItems()[a]},getFirstItem:function(){return this.getItem(0)},getLastItem:function(){return this.getItem(this.getItems().length-1)},indexOf:function(a){return this.getItems().indexOf(a)},eachItem:function(a){var b,c=this.getItems(),d=c.length;for(b=0;d>b;b++)a.call(this,b,c[b]);return this},addItem:function(b,c,d){var e=this.getItems(),f=e.length;return~e.indexOf(b)?this:(c>=0&&f>c||(c=f),e.splice(c,0,b),"object"==typeof b&&(b.container=this,b.remove=a),this.handleAdd(b,c),d||this.onContainerChanged("add",[b]),this)},addItems:function(a){for(var b=0,c=a.length;c>b;b++)this.addItem(a[b],-1,!0);return this.onContainerChanged("add",a),this},setItems:function(a){return this.clear().addItems(a)},appendItem:function(a){return this.addItem(a)},prependItem:function(a){return this.addItem(a,0)},removeItem:function(a,b){if("number"!=typeof a)return this.removeItem(this.indexOf(a));var c=this.getItems(),d=(c.length,c[a]);return void 0===d?this:(c.splice(a,1),d.container&&delete d.container,d.remove&&delete d.remove,this.handleRemove(d,a),b||this.onContainerChanged("remove",[d]),this)},clear:function(){for(var a,b=[];a=this.getFirstItem();)b.push(a),this.removeItem(0,!0);return this.onContainerChanged("remove",b),this},onContainerChanged:function(){},handleAdd:function(){},handleRemove:function(){}})}},_p[30]={value:function(){var a=_p.r(12),b={getCurvePanLines:function(a,c){var d=b.getCenterPoints(a),e=b.getPanLine(a.length,d);return b.getMovedPanLines(a,e,c)},getCenterPoints:function(a){for(var b={},c=null,d=0,e=0,f=a.length;f>d;d++)e=d===f-1?0:d+1,c=d+","+e,b[c]={x:(a[d].x+a[e].y)/2,y:(a[d].x+a[e].y)/2};return b},getPanLine:function(a,b){for(var c,d={},e=null,f=0;a>f;f++){var g=null,h=null;c=(f+1)%a,e=c,g=b[f+","+c],f=c,c=(f+1)%a,h=b[f+","+c],d[e]={points:[{x:g.x,y:g.y},{x:h.x,y:h.y}],center:{x:(g.x+h.x)/2,y:(g.y+h.y)/2}},f=(e+a-1)%a}return d},getMovedPanLines:function(b,c,d){var e={};return a.each(b,function(b,f){var g=c[f],h=g.center,i={x:h.x-b.x,y:h.y-b.y},j=e[f]={points:[],center:{x:b.x,y:b.y}};a.each(g.points,function(a){var b={x:a.x-i.x,y:a.y-i.y},c=j.center,e=b.x-c.x,f=b.y-c.y;b.x=c.x+d*e,b.y=c.y+d*f,j.points.push(b)})}),e}};return _p.r(11).createClass("Curve",{base:_p.r(47),mixins:[_p.r(52)],constructor:function(a,b){this.callBase(),this.setPoints(a||[]),this.closeState=!!b,this.changeable=!0,this.smoothFactor=1,this.update()},onContainerChanged:function(){this.changeable&&this.update()},setSmoothFactor:function(a){return this.smoothFactor=0>a?0:a,this.update(),this},getSmoothFactor:function(){return this.smoothFactor},update:function(){var a=this.getPoints(),c=null,d=this.getDrawer(),e=null,f=null,g=null;if(d.clear(),0===a.length)return this;if(d.moveTo(a[0]),1===a.length)return this;if(2===a.length)return d.lineTo(a[1]),this;c=b.getCurvePanLines(a,this.getSmoothFactor());for(var h=1,i=a.length;i>h;h++)e=c[h].center,f=this.closeState||h!=i-1?c[h].points[0]:c[h].center,g=this.closeState||1!=h?c[h-1].points[1]:c[h-1].center,d.bezierTo(g.x,g.y,f.x,f.y,e.x,e.y);return this.closeState&&(e=c[0].center,f=c[0].points[0],g=c[a.length-1].points[1],d.bezierTo(g.x,g.y,f.x,f.y,e.x,e.y)),this},close:function(){return this.closeState=!0,this.update()},open:function(){return this.closeState=!1,this.update()},isClose:function(){return!!this.closeState}})}},_p[31]={value:function(){return _p.r(11).createClass("Data",{constructor:function(){this._data={}},setData:function(a,b){return this._data[a]=b,this},getData:function(a){return this._data[a]},removeData:function(a){return delete this._data[a],this}})}},_p[32]={value:function(){return _p.r(11).createClass("GradientBrush",{base:_p.r(59),constructor:function(a){this.callBase(a)}})}},_p[33]={value:function(){var a=(_p.r(12),_p.r(51));return _p.r(11).createClass("Ellipse",{base:_p.r(47),constructor:function(a,b,c,d){this.callBase(),this.rx=a||0,this.ry=b||0,this.cx=c||0,this.cy=d||0,this.update()},update:function(){var a=this.rx,b=this.ry,c=this.cx+a,d=this.cx-a,e=this.cy,f=this.getDrawer();return f.clear(),f.moveTo(c,e),f.arcTo(a,b,0,1,1,d,e),f.arcTo(a,b,0,1,1,c,e),this},getRadius:function(){return{x:this.rx,y:this.ry}},getRadiusX:function(){return this.rx},getRadiusY:function(){return this.ry},getCenter:function(){return new a(this.cx,this.cy)},getCenterX:function(){return this.cx},getCenterY:function(){return this.cy},setRadius:function(a,b){return this.rx=a,this.ry=b,this.update()},setRadiusX:function(a){return this.rx=a,this.update()},setRadiusY:function(a){return this.ry=a,this.update()},setCenter:function(b,c){if(1==arguments.length){var d=a.parse(arguments[0]);b=d.x,c=d.y}return this.cx=b,this.cy=c,this.update()},setCenterX:function(a){return this.cx=a,this.update()},setCenterY:function(a){return this.cy=a,this.update()}})}},_p[34]={value:function(){function a(a,b,d){return d=!!d,h.isString(a)&&(a=a.match(/\S+/g)),h.each(a,function(a){c.call(this,this.node,a,b,d)},this),this}function b(a,b){var c=null,d=this._EVNET_UID,f=void 0===b;try{c=k[d][a]}catch(g){return}return f||(f=!0,h.each(c,function(a,d){a===b?delete c[d]:f=!1})),f&&(e(this.node,a,j[d][a]),delete k[d][a],delete j[d][a]),this}function c(a,b,c,e){var f=this._EVNET_UID,g=this;j[f]||(j[f]={}),j[f][b]||(j[f][b]=function(a){a=new i(a||window.event),h.each(k[f][b],function(c){var d;return c&&(d=c.call(g,a),e&&g.off(b,c)),d},g)}),k[f]||(k[f]={}),k[f][b]?k[f][b].push(c):(k[f][b]=[c],a&&d(a,b,j[f][b]))}function d(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)}function e(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent(b,c)}function f(a,b,c){var d=new CustomEvent(b,{bubbles:!0,cancelable:!0});d._kityParam=c,a.dispatchEvent(d)}function g(a,b,c){var d=null,e=null;try{if(e=j[a._EVNET_UID][b],!e)return}catch(f){return}d=h.extend({type:b,target:a},c||{}),e.call(a,d)}!function(){function a(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");return c.initCustomEvent(a,b.bubbles,b.cancelable,b.detail),c}a.prototype=window.Event.prototype,window.CustomEvent=a}();var h=_p.r(12),i=_p.r(63),j={},k={},l=0;return _p.r(11).createClass("EventHandler",{constructor:function(){this._EVNET_UID=++l},addEventListener:function(b,c){return a.call(this,b,c,!1)},addOnceEventListener:function(b,c){return a.call(this,b,c,!0)},removeEventListener:function(a,c){return b.call(this,a,c)},on:function(){return this.addEventListener.apply(this,arguments)},once:function(){return this.addOnceEventListener.apply(this,arguments)},off:function(){return this.removeEventListener.apply(this,arguments)},fire:function(){return this.trigger.apply(this,arguments)},trigger:function(a,b){return this.node?f(this.node,a,b):g(this,a,b),this}})}},_p[35]={value:function(){function a(a){var b,c,d,e,f;for(b=[],c=0;c<a.length;c++)for(e=a[c],b.push(f=[]),d=0;d<e.length;d++)f.push(e[d]);return a.isUniform&&(b.isUniform=!0),a.isAbsolute&&(b.isAbsolute=!0),a.isCurve&&(b.isCurve=!0),b}function b(a,b,c){function d(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return a.push(a.splice(c,1)[0])}function e(){var f=Array.prototype.slice.call(arguments,0),g=f.join("␀"),h=e.cache=e.cache||{},i=e.count=e.count||[];return h.hasOwnProperty(g)?(d(i,g),c?c(h[g]):h[g]):(i.length>=1e3&&delete h[i.shift()],i.push(g),h[g]=a.apply(b,f),c?c(h[g]):h[g])}return e}function c(a,b,d,e,f,g,h,i,j,k){var l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q=Math,R=Q.PI,S=Math.abs,T=120*R/180,U=R/180*(+f||0),V=[],W=function(a,b,c){var d=a*Q.cos(c)-b*Q.sin(c),e=a*Q.sin(c)+b*Q.cos(c);return{x:d,y:e}};if(k?(w=k[0],x=k[1],u=k[2],v=k[3]):(l=W(a,b,-U),a=l.x,b=l.y,l=W(i,j,-U),i=l.x,j=l.y,m=Q.cos(R/180*f),n=Q.sin(R/180*f),p=(a-i)/2,q=(b-j)/2,o=p*p/(d*d)+q*q/(e*e),o>1&&(o=Q.sqrt(o),d=o*d,e=o*e),r=d*d,s=e*e,t=(g==h?-1:1)*Q.sqrt(S((r*s-r*q*q-s*p*p)/(r*q*q+s*p*p))),u=t*d*q/e+(a+i)/2,v=t*-e*p/d+(b+j)/2,w=Q.asin(((b-v)/e).toFixed(9)),x=Q.asin(((j-v)/e).toFixed(9)),w=u>a?R-w:w,x=u>i?R-x:x,0>w&&(w=2*R+w),0>x&&(x=2*R+x),h&&w>x&&(w-=2*R),!h&&x>w&&(x-=2*R)),y=x-w,S(y)>T&&(z=x,A=i,B=j,x=w+T*(h&&x>w?1:-1),i=u+d*Q.cos(x),j=v+e*Q.sin(x),V=c(i,j,d,e,f,0,h,A,B,[x,z,u,v])),y=x-w,C=Q.cos(w),D=Q.sin(w),E=Q.cos(x),F=Q.sin(x),G=Q.tan(y/4),H=4/3*d*G,I=4/3*e*G,J=[a,b],K=[a+H*D,b-I*C],L=[i+H*F,j-I*E],M=[i,j],K[0]=2*J[0]-K[0],K[1]=2*J[1]-K[1],k)return[K,L,M].concat(V);for(V=[K,L,M].concat(V).join().split(","),N=[],O=0,P=V.length;P>O;O++)N[O]=O%2?W(V[O-1],V[O],U).y:W(V[O],V[O+1],U).x;return N}function d(a,b,c,d,e,f){var g=1/3,h=2/3;return[g*a+h*c,g*b+h*d,g*e+h*c,g*f+h*d,e,f]}function e(a,b){function c(a){return function(b,c){return b+a*(c-b)}}var d=c(b||.5),e=a,f=e[0],g=e[1],h=e[2],i=e[3],j=e[4],k=e[5],l=e[6],m=e[7],n=d(f,h),o=d(g,i),p=d(h,j),q=d(i,k),r=d(j,l),s=d(k,m),t=d(n,p),u=d(o,q),v=d(p,r),w=d(q,s),x=d(t,v),y=d(u,w);return[[f,g,n,o,t,u,x,y],[x,y,v,w,r,s,l,m]]}var f=_p.r(12),g=_p.r(51),h=_p.r(74),i=_p.r(44),j={},k=/([achlmrqstvz])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\s]*,?\s*)+)/gi,l=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)\s*,?\s*/gi,m={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0};j.pathToString=function(a){return a=a||this,"string"==typeof a?a:a instanceof Array?(a=f.flatten(a),a.join(",").replace(/,?([achlmqrstvxz]),?/gi,"$1")):void 0},j.parsePathString=b(function(a){var b=[];return a.replace(k,function(a,c,d){var e=[],f=c.toLowerCase();if(d.replace(l,function(a,b){b&&e.push(+b)}),"m"==f&&e.length>2&&(b.push([c].concat(e.splice(0,2))),f="l",c="m"==c?"l":"L"),"r"==f)b.push([c].concat(e));else for(;e.length>=m[f]&&(b.push([c].concat(e.splice(0,m[f]))),m[f]););}),b.isUniform=!0,b.toString=j.pathToString,b}),j.pathToAbsolute=b(function(a){var b,c,d,e,f,g,h,i,k=a.isUniform?a:j.parsePathString(j.pathToString(a)),l=[],m=0,n=0,o=0,p=0,q=0;for("M"==k[0][0]&&(m=+k[0][1],n=+k[0][2],o=m,p=n,q++,l[0]=["M",m,n]),d=q,g=k.length;g>d;d++){if(l.push(b=[]),c=k[d],c[0]!=c[0].toUpperCase())switch(b[0]=c[0].toUpperCase(),b[0]){case"A":b[1]=c[1],b[2]=c[2],b[3]=c[3],b[4]=c[4],b[5]=c[5],b[6]=+(c[6]+m),b[7]=+(c[7]+n);break;case"V":b[1]=+c[1]+n;break;case"H":b[1]=+c[1]+m;break;case"M":o=+c[1]+m,p=+c[2]+n;break;default:for(e=1,h=c.length;h>e;e++)b[e]=+c[e]+(e%2?m:n)}else for(f=0,i=c.length;i>f;f++)b[f]=c[f];switch(b[0]){case"Z":m=o,n=p;break;case"H":m=b[1];break;case"V":n=b[1];break;case"M":o=b[b.length-2],p=b[b.length-1];break;default:m=b[b.length-2],n=b[b.length-1]}}return l.isUniform=!0,l.isAbsolute=!0,l.toString=j.pathToString,l}),j.pathToCurve=b(function(a){var b,e,f,g,h,i,k,l,m,n,o,p,q=[];for(a.isAbsolute||(a=j.pathToAbsolute(a)),b=0;b<a.length;b++)if(f=a[b][0],g=a[b].slice(1),"M"!=f){switch("Z"==f&&(l=!0,f="L",g=h),k=g.slice(g.length-2),"H"==f&&(k=[g[0],i[1]],f="L"),"V"==f&&(k=[i[0],g[0]],f="L"),("S"==f||"T"==f)&&(n=[i[0]+(i[0]-m[0]),i[1]+(i[1]-m[1])]),f){case"L":o=i,p=k;break;case"C":o=g.slice(0,2),p=g.slice(2,4);break;case"S":o=n.slice(),p=g.slice(0,2);break;case"Q":m=g.slice(0,2),g=d.apply(null,i.concat(g)),o=g.slice(0,2),p=g.slice(2,4);break;case"T":g=d.apply(null,i.concat(n).concat(g)),o=g.slice(0,2),p=g.slice(2,4);break;case"A":for(g=c.apply(null,i.concat(g)),e=0;e in g;)o=g.slice(e,e+2),p=g.slice(e+2,e+4),k=g.slice(e+4,e+6),q.push(["C"].concat(o).concat(p).concat(k)),e+=6}"A"!=f&&q.push(["C"].concat(o).concat(p).concat(k)),i=k,"Q"!=f&&(m=p),l&&(q.push(["Z"]),l=!1)}else h=m=i=g,q.push(a[b]);return q.isUniform=!0,q.isAbsolute=!0,q.isCurve=!0,q.toString=j.pathToString,q}),j.cutBezier=b(e),j.subBezier=function(a,b,c){var d=e(a,b)[0];return c?e(d,c/b)[1]:d},j.pointAtBezier=function(a,b){var c=e(a,b)[0],d=g.parse(c.slice(6)),f=g.parse(c.slice(4,2)),i=h.fromPoints(f,d);return d.tan=0===b?j.pointAtBezier(a,.01).tan:i.normalize(),d},j.bezierLength=b(function(a){function b(a){var b=i*Math.pow(a,4)+j*Math.pow(a,3)+k*Math.pow(a,2)+l*a+m;return 0>b&&(b=0),Math.pow(b,.5)}var c,d,e,f,g,h,i,j,k,l,m,n=a;return c=-3*n[0]+9*n[2]-9*n[4]+3*n[6],d=6*n[0]-12*n[2]+6*n[4],e=-3*n[0]+3*n[2],f=-3*n[1]+9*n[3]-9*n[5]+3*n[7],g=6*n[1]-12*n[3]+6*n[5],h=-3*n[1]+3*n[3],i=Math.pow(c,2)+Math.pow(f,2),j=2*(c*d+f*g),k=2*(c*e+f*h)+Math.pow(d,2)+Math.pow(g,2),l=2*(d*e+g*h),m=Math.pow(e,2)+Math.pow(h,2),(b(0)+b(1)+4*(b(.125)+b(.375)+b(.625)+b(.875))+2*(b(.25)+b(.5)+b(.75)))/24});var n=b(function(a){var b,c,d,e,f,g,h;for(g=[],h=0,b=0,c=a.length;c>b;b++)d=a[b],"M"!=d[0]?"Z"!=d[0]?(f=j.bezierLength(e.concat(d.slice(1))),g.push([h,h+f]),h+=f,e=d.slice(4)):g.push(null):(e=d.slice(1),g.push(null));return g.totalLength=h,g});j.subPath=function(a,b,c){var d;if(c=c||0,d=b-c,d-=0|d,c-=0|c,b=c+d,b>1)return j.subPath(a,1,c).concat(j.subPath(a,b-1));a.isCurve||(a=j.pathToCurve(a));var e,f,g,h,i,k,l,m,o,p=n(a),q=p.totalLength,r=q*b,s=q*(c||0),t=[];for(e=0,f=a.length;f>e;e++)if("M"!=a[e][0]){if("Z"!=a[e][0])if(g=p[e][0],h=p[e][1],i=h-g,l=k.concat(a[e].slice(1)),s>h)k=l.slice(l.length-2);else{if(s>=g)m=j.subBezier(l,Math.min((r-g)/i,1),(s-g)/i),o=!0,k=m.slice(0,2),t.push(["M"].concat(m.slice(0,2))),t.push(["C"].concat(m.slice(2)));else if(r>=h)t.push(a[e].slice());else{if(!(r>=g))break;m=j.subBezier(l,(r-g)/i),t.push(["C"].concat(m.slice(2))),o=!1}k=l.slice(l.length-2)}}else k=a[e].slice(1),o&&t.push(a[e].slice());return t.isAbsolute=!0,t.isCurve=!0,t.isUniform=!0,t.toString=j.pathToString,t},j.pointAtPath=function(a,b){a.isCurve||(a=j.pathToCurve(a));var c=j.subPath(a,b),d="Z"==c[c.length-1][0]?c[c.length-2]:c[c.length-1];d=d.slice(1);var e=g.parse(d.slice(4)),f=g.parse(d.slice(2,4));return e.tan=h.fromPoints(f,e).normalize(),e},j.pathLength=b(function(a){a.isCurve||(a=j.pathToCurve(a));var b=n(a);return b.totalLength}),j.pathKeyPoints=b(function(a){var b,c,d;for(a.isCurve||(a=j.pathToCurve(a)),d=[],b=0,c=a.length;c>b;b++)"z"!=a[b][0]&&d.push(a[b].slice(a[b].length-2));return d});var o=b(function(b,c){function d(a,b){return a[b||a.i]&&a[b||a.i][0]}function e(a,b){return a[b||a.i]&&a[b||a.i].slice(1)}function f(a,b){var c=e(a,b);return c&&c.slice(-2)}function g(a){return"Z"==d(a)?(a.splice(a.i,1),!0):!1}function h(a){return"M"==d(a)?(a.o.splice(a.o.i,0,["M"].concat(f(a.o,a.o.i-1))),a.i++,a.o.i++,!0):!1}function i(a){for(var b,c=1;!b;)b=f(a,a.length-c++);for(a.o.i=a.i;a.length<a.o.length;)g(a.o)||h(a.o)||(a.push(["C"].concat(b).concat(b).concat(b)),a.i++,a.o.i++)}b.isCurve||(b=j.pathToCurve(b)),c.isCurve||(c=j.pathToCurve(c));var k=a(b),l=a(c);for(k.i=0,l.i=0,k.o=l,l.o=k;k.i<k.length&&l.i<l.length;)g(k)||g(l)||(d(k)!=d(l)?h(k)||h(l)||(k.i++,l.i++):(k.i++,l.i++));return k.i==k.length&&i(k),l.i==l.length&&i(l),delete k.i,delete k.o,delete l.i,delete l.o,[k,l]});return j.alignCurve=o,j.pathTween=function(a,b,c){if(0===c)return a;if(1===c)return b;var d,e,f,g=o(a,b),h=[];for(a=g[0],b=g[1],e=0;e<a.length;e++)for(h.push(d=[]),d.push(a[e][0]),f=1;f<a[e].length;f++)d.push(a[e][f]+c*(b[e][f]-a[e][f]));return h.isUniform=h.isCurve=h.isAbsolute=!0,h},j.transformPath=b(function(a,b){var c,d,e,f,h,i;for(a.isCurve||(a=j.pathToCurve(a)),f=[],c=0,d=a.length;d>c;c++)for(f.push(h=[a[c][0]]),e=1;e<a[c].length;e+=2)i=a[c].slice(e,e+2),i=b.transformPoint(g.parse(i)),f.push(i);return f}),_p.r(11).extendClass(i,{transformPath:function(a){return j.transformPath(a,this)}}),j}},_p[36]={value:function(){var a=_p.r(68),b=_p.r(32),c=_p.r(28);return _p.r(11).createClass("GradientBrush",{base:b,constructor:function(a){this.callBase(a),this.stops=[]},addStop:function(b,d,e){var f=a.createNode("stop");return d instanceof c||(d=c.parse(d)),void 0===e&&(e=d.get("a")),f.setAttribute("offset",b),f.setAttribute("stop-color",d.toRGB()),1>e&&f.setAttribute("stop-opacity",e),this.node.appendChild(f),this}})}},_p[37]={value:function(){var a=_p.r(62);return _p.r(11).createClass("Group",{mixins:[a],base:_p.r(61),constructor:function(){this.callBase("g")}})}},_p[38]={value:function(){var a=_p.r(62);return _p.r(11).createClass("HyperLink",{mixins:[a],base:_p.r(61),constructor:function(a){this.callBase("a"),this.setHref(a)},setHref:function(a){return this.node.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a),this},getHref:function(){return this.node.getAttributeNS("xlink:href")},setTarget:function(a){return this.node.setAttribute("target",a),this},getTarget:function(){return this.node.getAttribute("target")}})}},_p[39]={value:function(){return _p.r(11).createClass("Image",{base:_p.r(61),constructor:function(a,b,c,d,e){this.callBase("image"),this.url=a,this.width=b||0,this.height=c||0,this.x=d||0,this.y=e||0,this.update()},update:function(){return this.node.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this.url),this.node.setAttribute("x",this.x),this.node.setAttribute("y",this.y),this.node.setAttribute("width",this.width),this.node.setAttribute("height",this.height),this},setUrl:function(a){return this.url=""===a?null:a,this.update()},getUrl:function(){return this.url},setWidth:function(a){return this.width=a,this.update()},getWidth:function(){return this.width},setHeight:function(a){return this.height=a,this.update()},getHeight:function(){return this.height},setX:function(a){return this.x=a,this.update()},getX:function(){return this.x},setY:function(a){return this.y=a,this.update()},getY:function(){return this.y}})}},_p[40]={value:function(){return _p.r(11).createClass("Line",{base:_p.r(47),constructor:function(a,b,c,d){this.callBase(),this.point1={x:a||0,y:b||0},this.point2={x:c||0,y:d||0},this.update()},setPoint1:function(a,b){return this.point1.x=a,this.point1.y=b,this.update()},setPoint2:function(a,b){return this.point2.x=a,this.point2.y=b,this.update()},getPoint1:function(){return{x:this.point1.x,y:this.point1.y}},getPoint2:function(){return{x:this.point2.x,y:this.point2.y}},update:function(){var a=this.getDrawer();return a.clear(),a.moveTo(this.point1.x,this.point1.y),a.lineTo(this.point2.x,this.point2.y),this}})}},_p[41]={value:function(){var a="LinearGradientBrush",b=(_p.r(68),_p.r(36));return _p.r(11).createClass(a,{base:b,constructor:function(a){this.callBase("linearGradient"),this.setStartPosition(0,0),this.setEndPosition(1,0),"function"==typeof a&&a.call(this,this)},setStartPosition:function(a,b){return this.node.setAttribute("x1",a),this.node.setAttribute("y1",b),this},setEndPosition:function(a,b){return this.node.setAttribute("x2",a),this.node.setAttribute("y2",b),this},getStartPosition:function(){return{x:+this.node.getAttribute("x1"),y:+this.node.getAttribute("y1")}},getEndPosition:function(){return{x:+this.node.getAttribute("x2"),y:+this.node.getAttribute("y2")}}})}},_p[42]={value:function(){var a=_p.r(51),b=_p.r(11).createClass("Marker",{base:_p.r(59),mixins:[_p.r(62),_p.r(76)],constructor:function(){this.callBase("marker"),this.setOrient("auto")},setRef:function(a,b){return 1===arguments.length&&(b=a.y,a=a.x),this.node.setAttribute("refX",a),this.node.setAttribute("refY",b),this},getRef:function(){return new a(+this.node.getAttribute("refX"),+this.node.getAttribute("refY"))},setWidth:function(a){return this.node.setAttribute("markerWidth",this.width=a),this},setOrient:function(a){return this.node.setAttribute("orient",this.orient=a),this},getOrient:function(){return this.orient},getWidth:function(){return+this.width},setHeight:function(a){return this.node.setAttribute("markerHeight",this.height=a),this},getHeight:function(){return+this.height}}),c=_p.r(47);return _p.r(11).extendClass(c,{setMarker:function(a,b){return b=b||"end",a?this.node.setAttribute("marker-"+b,a.toString()):this.node.removeAttribute("marker-"+b),this}}),b}},_p[43]={value:function(){var a=_p.r(11),b=_p.r(61),c=a.createClass("Mask",{base:b,mixins:[_p.r(62)],constructor:function(){this.callBase("mask")},mask:function(a){return a.getNode().setAttribute("mask","url(#"+this.getId()+")"),this}});return a.extendClass(b,{maskWith:function(a){return a.mask(this),this}}),c}},_p[44]={value:function(){function a(a,b){return{a:b.a*a.a+b.c*a.b,b:b.b*a.a+b.d*a.b,c:b.a*a.c+b.c*a.d,d:b.b*a.c+b.d*a.d,e:b.a*a.e+b.c*a.f+b.e,f:b.b*a.e+b.d*a.f+b.f}}function b(a){return a*Math.PI/180}var c=_p.r(12),d=_p.r(25),e=/matrix\((.+)\)/i,f=_p.r(51),g=_p.r(11).createClass("Matrix",{constructor:function(){arguments.length?this.setMatrix.apply(this,arguments):this.setMatrix(1,0,0,1,0,0)},translate:function(b,c){return this.m=a(this.m,{a:1,c:0,e:b,b:0,d:1,f:c}),this},rotate:function(c){var d=b(c),e=Math.sin(d),f=Math.cos(d);return this.m=a(this.m,{a:f,c:-e,e:0,b:e,d:f,f:0}),this},scale:function(b,c){return void 0===c&&(c=b),this.m=a(this.m,{a:b,c:0,e:0,b:0,d:c,f:0}),this},skew:function(c,d){void 0===d&&(d=c);var e=Math.tan(b(c)),f=Math.tan(b(d));return this.m=a(this.m,{a:1,c:e,e:0,b:f,d:1,f:0}),this},inverse:function(){var a,b,c,d,e,f,h,i=this.m,j=i.a,k=i.b,l=i.c,m=i.d,n=i.e,o=i.f;return a=j*m-k*l,b=m/a,c=-k/a,d=-l/a,e=j/a,f=(l*o-n*m)/a,h=(k*n-j*o)/a,new g(b,c,d,e,f,h)},setMatrix:function(a,b,d,e,f,g){return this.m=1===arguments.length?c.clone(arguments[0]):{a:a,b:b,c:d,d:e,e:f,f:g},this},getMatrix:function(){return c.clone(this.m)},getTranslate:function(){var a=this.m;return{x:a.e/a.a,y:a.f/a.d}},mergeMatrix:function(b){return new g(a(this.m,b.m))},merge:function(a){return this.mergeMatrix(a)},toString:function(){return this.valueOf().join(" ")},valueOf:function(){var a=this.m;return[a.a,a.b,a.c,a.d,a.e,a.f]},equals:function(a){var b=this.m,c=a.m;return b.a==c.a&&b.b==c.b&&b.c==c.c&&b.d==c.d&&b.e==c.e&&b.f==c.f},transformPoint:function(){return g.transformPoint.apply(null,[].slice.call(arguments).concat([this.m]))},transformBox:function(a){return g.transformBox(a,this.m)}});return g.parse=function(a){var b,c=parseFloat;if(a instanceof Array)return new g({a:a[0],b:a[1],c:a[2],d:a[3],e:a[4],f:a[5]});if(b=e.exec(a)){var d=b[1].split(",");return 6!=d.length&&(d=b[1].split(" ")),new g({a:c(d[0]),b:c(d[1]),c:c(d[2]),d:c(d[3]),e:c(d[4]),f:c(d[5])})}return new g},g.transformPoint=function(a,b,c){return 2===arguments.length&&(c=b,b=a.y,a=a.x),new f(c.a*a+c.c*b+c.e,c.b*a+c.d*b+c.f)},g.transformBox=function(a,b){for(var e,f,h=Number.MAX_VALUE,i=-Number.MAX_VALUE,j=Number.MAX_VALUE,k=-Number.MAX_VALUE,l=[[a.x,a.y],[a.x+a.width,a.y],[a.x,a.y+a.height],[a.x+a.width,a.y+a.height]],m=[];e=l.pop();)f=g.transformPoint(e[0],e[1],b),m.push(f),h=Math.min(h,f.x),i=Math.max(i,f.x),j=Math.min(j,f.y),k=Math.max(k,f.y);return a=new d({x:h,y:j,width:i-h,height:k-j}),c.extend(a,{closurePoints:m}),a},g.getCTM=function(a,b){var c={a:1,b:0,c:0,d:1,e:0,f:0},d=a.shapeNode||a.node;switch(b=b||"parent"){case"screen":c=d.getScreenCTM();break;case"doc":case"paper":c=d.getCTM();break;case"view":case"top":a.getPaper()&&(c=d.getTransformToElement(a.getPaper().shapeNode));break;case"parent":a.node.parentNode&&(c=d.getTransformToElement(a.node.parentNode));break;default:b.node&&(c=d.getTransformToElement(b.shapeNode||b.node))}return c?new g(c.a,c.b,c.c,c.d,c.e,c.f):new g},g}},_p[45]={value:function(){var a=_p.r(65),b=_p.r(28),c=_p.r(12),d=_p.r(11).createClass("Palette",{constructor:function(){this.color={}},get:function(c){var d=this.color[c]||a.EXTEND_STANDARD[c]||a.COLOR_STANDARD[c]||"";return d?new b(d):null},getColorValue:function(b){return this.color[b]||a.EXTEND_STANDARD[b]||a.COLOR_STANDARD[b]||""},add:function(a,c){return this.color[a]="string"==typeof c?new b(c).toRGBA():c.toRGBA(),c},remove:function(a){return this.color.hasOwnProperty(a)?(delete this.color[a],!0):!1}});return c.extend(d,{getColor:function(c){var d=a.EXTEND_STANDARD[c]||a.COLOR_STANDARD[c];return d?new b(d):null},getColorValue:function(b){return a.EXTEND_STANDARD[b]||a.COLOR_STANDARD[b]||""},addColor:function(c,d){return a.EXTEND_STANDARD[c]="string"==typeof d?new b(d).toRGBA():d.toRGBA(),d},removeColor:function(b){return a.EXTEND_STANDARD.hasOwnProperty(b)?(delete a.EXTEND_STANDARD[b],!0):!1}}),d}},_p[46]={value:function(){var a=_p.r(11),b=_p.r(12),c=_p.r(68),d=_p.r(29),e=_p.r(62),f=_p.r(76),g=_p.r(34),h=_p.r(67),i=_p.r(44),j=a.createClass("Paper",{mixins:[e,g,h,f],constructor:function(a){this.callBase(),this.node=this.createSVGNode(),this.node.paper=this,this.node.appendChild(this.resourceNode=c.createNode("defs")),this.node.appendChild(this.shapeNode=c.createNode("g")),this.resources=new d,this.setWidth("100%").setHeight("100%"),a&&this.renderTo(a),this.callMixin()},renderTo:function(a){b.isString(a)&&(a=document.getElementById(a)),this.container=a,a.appendChild(this.node)},createSVGNode:function(){var a=c.createNode("svg");return a.setAttribute("xmlns","http://www.w3.org/2000/svg"),a.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),a},getNode:function(){return this.node},getContainer:function(){return this.container},getWidth:function(){return this.node.clientWidth},setWidth:function(a){return this.node.setAttribute("width",a),this},getHeight:function(){return this.node.clientHeight},setHeight:function(a){return this.node.setAttribute("height",a),this},setViewPort:function(a,b,c){var d,e;1==arguments.length&&(d=arguments[0],a=d.center.x,b=d.center.y,c=d.zoom),c=c||1,e=this.getViewBox();var f=new i,g=e.x+e.width/2-a,h=e.y+e.height/2-b;return f.translate(-a,-b),f.scale(c),f.translate(a,b),f.translate(g,h),this.shapeNode.setAttribute("transform","matrix("+f+")"),this.viewport={center:{x:a,y:b},offset:{x:g,y:h},zoom:c},this},getViewPort:function(){if(!this.viewport){var a=this.getViewBox();return{zoom:1,center:{x:a.x+a.width/2,y:a.y+a.height/2},offset:{x:0,y:0}}}return this.viewport},getViewPortTransform:function(){var a=this.shapeNode.getCTM();return new i(a.a,a.b,a.c,a.d,a.e,a.f)},getTransform:function(){return this.getViewPortTransform().reverse()},addResource:function(a){return this.resources.appendItem(a),a.node&&this.resourceNode.appendChild(a.node),this},removeResource:function(a){return a.remove&&a.remove(),a.node&&this.resourceNode.removeChild(a.node),this},getPaper:function(){return this}}),k=_p.r(61);return a.extendClass(k,{getPaper:function(){for(var a=this.container;a&&a instanceof j==!1;)a=a.container;return a},isAttached:function(){return!!this.getPaper()},whenPaperReady:function(a){function b(){var b=c.getPaper();return b&&a&&a.call(c,b),b}var c=this;return b()||this.on("add treeadd",function d(){b()&&(c.off("add",d),c.off("treeadd",d))}),this}}),j}},_p[47]={value:function(){var a=_p.r(12),b=_p.r(11).createClass,c=_p.r(61),d=_p.r(68),e=_p.r(35),f=Array.prototype.slice,g=(a.flatten,b("PathDrawer",{constructor:function(a){this.segment=[],this.path=a,this.__clear=!1},getPath:function(){return this.path},redraw:function(){return this._transation=this._transation||[],this.clear()},done:function(){var a=this._transation;return this._transation=null,this.push(a),this},clear:function(){return this._transation?this._transation=[]:this.path.setPathData("M 0 0"),this._clear=!0,this},push:function(){var a,b=f.call(arguments);return this._transation?(this._transation.push(b),this):(this._clear?(a="",this._clear=!1):a=this.path.getPathData(),a=a||"",this.path.setPathData(a+e.pathToString(b)),this)},moveTo:function(){return this.push("M",f.call(arguments))},moveBy:function(){return this.push("m",f.call(arguments))},lineTo:function(){return this.push("L",f.call(arguments))},lineBy:function(){return this.push("l",f.call(arguments))},arcTo:function(){return this.push("A",f.call(arguments))},arcBy:function(){return this.push("a",arguments)},carcTo:function(a){return this.push("A",[a,a,0].concat(f.call(arguments,1)))},carcBy:function(a){return this.push("a",[a,a,0].concat(f.call(arguments,1)))},bezierTo:function(){return this.push("C",f.call(arguments))},bezierBy:function(){return this.push("c",f.call(arguments))},close:function(){return this.push("z")}}));return b("Path",{base:c,constructor:function(a){this.callBase("path"),a&&this.setPathData(a),this.node.setAttribute("fill",d.defaults.fill),this.node.setAttribute("stroke",d.defaults.stroke)},setPathData:function(a){return a=a||"M0,0",this.pathdata=e.pathToString(a),this.node.setAttribute("d",this.pathdata),this.trigger("shapeupdate",{type:"pathdata"}),this},getPathData:function(){return this.pathdata||""},getDrawer:function(){return new g(this)},isClosed:function(){var a=this.getPathData();return!!~a.indexOf("z")||!!~a.indexOf("Z")}})}},_p[48]={value:function(){{var a=_p.r(32),b=_p.r(62);_p.r(68)}return _p.r(11).createClass("PatternBrush",{base:a,mixins:[b],constructor:function(){this.callBase("pattern"),this.node.setAttribute("patternUnits","userSpaceOnUse")},setX:function(a){return this.x=a,this.node.setAttribute("x",a),this},setY:function(a){return this.y=a,this.node.setAttribute("y",a),this},setWidth:function(a){return this.width=a,this.node.setAttribute("width",a),this},setHeight:function(a){return this.height=a,this.node.setAttribute("height",a),this},getWidth:function(){return this.width},getHeight:function(){return this.height}})}},_p[49]={value:function(){var a=_p.r(28);return _p.r(11).createClass("Pen",{constructor:function(a,b){this.brush=a,this.width=b||1,this.linecap=null,this.linejoin=null,this.dashArray=null,this.opacity=1},getBrush:function(){return this.brush},setBrush:function(a){return this.brush=a,this},setColor:function(a){return this.setBrush(a)},getColor:function(){return this.brush instanceof a?this.brush:null},getWidth:function(){return this.width},setWidth:function(a){return this.width=a,this},getOpacity:function(){return this.opacity},setOpacity:function(a){this.opacity=a},getLineCap:function(){return this.linecap},setLineCap:function(a){return this.linecap=a,this},getLineJoin:function(){return this.linejoin},setLineJoin:function(a){return this.linejoin=a,this},getDashArray:function(){return this.dashArray},setDashArray:function(a){return this.dashArray=a,this},stroke:function(a){var b=a.node;b.setAttribute("stroke",this.brush.toString()),b.setAttribute("stroke-width",this.getWidth()),this.getOpacity()<1&&b.setAttribute("stroke-opacity",this.getOpacity()),this.getLineCap()&&b.setAttribute("stroke-linecap",this.getLineCap()),this.getLineJoin()&&b.setAttribute("stroke-linejoin",this.getLineJoin()),this.getDashArray()&&b.setAttribute("stroke-dasharray",this.getDashArray())}})}},_p[50]={value:function(){return _p.r(11).createClass({base:_p.r(69),constructor:function(a,b,c){this.callBase([0,a],b,c)},getRadius:function(){return this.getSectionArray()[1]},setRadius:function(a){this.setSectionArray([0,a])}})}},_p[51]={value:function(){var a=_p.r(11).createClass("Point",{constructor:function(a,b){this.x=a||0,this.y=b||0},offset:function(b,c){return 1==arguments.length&&(c=b.y,b=b.x),new a(this.x+b,this.y+c)},valueOf:function(){return[this.x,this.y]},toString:function(){return this.valueOf().join(" ")},spof:function(){return new a((0|this.x)+.5,(0|this.y)+.5)}});return a.fromPolar=function(b,c,d){return"rad"!=d&&(c=c/180*Math.PI),new a(b*Math.cos(c),b*Math.sin(c))},a.parse=function(b){return b instanceof a?b:"string"==typeof b?a.parse(b.split(/\s*[\s,]\s*/)):"0"in b&&"1"in b?new a(b[0],b[1]):void 0},a}},_p[52]={value:function(){return _p.r(11).createClass("PointContainer",{base:_p.r(29),constructor:function(){this.callBase()
},addPoint:function(){return this.addItem.apply(this,arguments)},prependPoint:function(){return this.prependItem.apply(this,arguments)},appendPoint:function(){return this.appendItem.apply(this,arguments)},removePoint:function(){return this.removeItem.apply(this,arguments)},addPoints:function(){return this.addItems.apply(this,arguments)},setPoints:function(){return this.setItems.apply(this,arguments)},getPoint:function(){return this.getItem.apply(this,arguments)},getPoints:function(){return this.getItems.apply(this,arguments)},getFirstPoint:function(){return this.getFirstItem.apply(this,arguments)},getLastPoint:function(){return this.getLastItem.apply(this,arguments)}})}},_p[53]={value:function(){_p.r(12);return _p.r(11).createClass("Poly",{base:_p.r(47),mixins:[_p.r(52)],constructor:function(a,b){this.callBase(),this.closeable=!!b,this.setPoints(a||[]),this.changeable=!0,this.update()},onContainerChanged:function(){this.changeable&&this.update()},update:function(){var a=this.getDrawer(),b=this.getPoints();if(a.clear(),!b.length)return this;a.moveTo(b[0]);for(var c,d=1,e=b.length;e>d;d++)c=b[d],a.lineTo(c);return this.closeable&&b.length>2&&a.close(),this}})}},_p[54]={value:function(){return _p.r(11).createClass("Polygon",{base:_p.r(53),constructor:function(a){this.callBase(a,!0)}})}},_p[55]={value:function(){return _p.r(11).createClass("Polyline",{base:_p.r(53),constructor:function(a){this.callBase(a)}})}},_p[56]={value:function(){var a=_p.r(36);return _p.r(11).createClass("RadialGradientBrush",{base:a,constructor:function(a){this.callBase("radialGradient"),this.setCenter(.5,.5),this.setFocal(.5,.5),this.setRadius(.5),"function"==typeof a&&a.call(this,this)},setCenter:function(a,b){return this.node.setAttribute("cx",a),this.node.setAttribute("cy",b),this},getCenter:function(){return{x:+this.node.getAttribute("cx"),y:+this.node.getAttribute("cy")}},setFocal:function(a,b){return this.node.setAttribute("fx",a),this.node.setAttribute("fy",b),this},getFocal:function(){return{x:+this.node.getAttribute("fx"),y:+this.node.getAttribute("fy")}},setRadius:function(a){return this.node.setAttribute("r",a),this},getRadius:function(){return+this.node.getAttribute("r")}})}},_p[57]={value:function(){var a={},b=_p.r(12),c=_p.r(51),d=_p.r(25);b.extend(a,{formatRadius:function(a,b,c){var d=Math.floor(Math.min(a/2,b/2));return Math.min(d,c)}});var e=_p.r(11).createClass("Rect",{base:_p.r(47),constructor:function(b,c,d,e,f){this.callBase(),this.x=d||0,this.y=e||0,this.width=b||0,this.height=c||0,this.radius=a.formatRadius(this.width,this.height,f||0),this.update()},update:function(){var a=this.x,b=this.y,c=this.width,d=this.height,e=this.radius,f=this.getDrawer().redraw();return e?(c-=2*e,d-=2*e,f.push("M",a+e,b),f.push("h",c),f.push("a",e,e,0,0,1,e,e),f.push("v",d),f.push("a",e,e,0,0,1,-e,e),f.push("h",-c),f.push("a",e,e,0,0,1,-e,-e),f.push("v",-d),f.push("a",e,e,0,0,1,e,-e),f.push("z")):(f.push("M",a,b),f.push("h",c),f.push("v",d),f.push("h",-c),f.push("z")),f.done(),this},setWidth:function(a){return this.width=a,this.update()},setHeight:function(a){return this.height=a,this.update()},setSize:function(a,b){return this.width=a,this.height=b,this.update()},setBox:function(a){return this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height,this.update()},getBox:function(){return new d(this.x,this.y,this.width,this.height)},getRadius:function(){return this.radius},setRadius:function(a){return this.radius=a,this.update()},getPosition:function(){return new c(this.x,this.y)},setPosition:function(a,b){if(1==arguments.length){var d=c.parse(arguments[0]);b=d.y,a=d.x}return this.x=a,this.y=b,this.update()},getWidth:function(){return this.width},getHeight:function(){return this.height},getPositionX:function(){return this.x},getPositionY:function(){return this.y},setPositionX:function(a){return this.x=a,this.update()},setPositionY:function(a){return this.y=a,this.update()}});return e}},_p[58]={value:function(){var a=_p.r(51);return _p.r(11).createClass("RegularPolygon",{base:_p.r(47),constructor:function(b,c,d,e){this.callBase(),this.radius=c||0,this.side=Math.max(b||3,3),arguments.length>2&&3==arguments.length&&(e=d.y,d=d.x),this.center=new a(d,e),this.draw()},getSide:function(){return this.side},setSide:function(a){return this.side=a,this.draw()},getRadius:function(){return this.radius},setRadius:function(a){return this.radius=a,this.draw()},draw:function(){var b,c=this.radius,d=this.side,e=2*Math.PI/d,f=this.getDrawer();for(f.clear(),f.moveTo(a.fromPolar(c,Math.PI/2,"rad").offset(this.center)),b=0;d>=b;b++)f.lineTo(a.fromPolar(c,e*b+Math.PI/2,"rad").offset(this.center));return f.close(),this}})}},_p[59]={value:function(){var a=_p.r(68);return _p.r(11).createClass("Resource",{constructor:function(b){this.callBase(),this.node=a.createNode(b)},toString:function(){return"url(#"+this.node.id+")"}})}},_p[60]={value:function(){return _p.r(11).createClass({base:_p.r(69),constructor:function(a,b){this.callBase([a,b],360,0)},getInnerRadius:function(){return this.getSectionArray()[0]},getOuterRadius:function(){return this.getSectionArray()[1]},setInnerRadius:function(a){this.setSectionArray([a,this.getOuterRadius()])},setOuterRadius:function(a){this.setSectionArray([this.getInnerRadius(),a])}})}},_p[61]={value:function(){var a=_p.r(68),b=_p.r(12),c=_p.r(34),d=_p.r(67),e=_p.r(31),f=_p.r(44),g=(_p.r(49),Array.prototype.slice),h=_p.r(25),i=_p.r(11).createClass("Shape",{mixins:[c,d,e],constructor:function(b){this.node=a.createNode(b),this.node.shape=this,this.transform={translate:null,rotate:null,scale:null,matrix:null},this.callMixin()},getId:function(){return this.node.id},setId:function(a){return this.node.id=a,this},getNode:function(){return this.node},getBoundaryBox:function(){var a;try{a=this.node.getBBox()}catch(b){a={x:this.node.clientLeft,y:this.node.clientTop,width:this.node.clientWidth,height:this.node.clientHeight}}return new h(a)},getRenderBox:function(a){var b=this.getBoundaryBox(),c=this.getTransform(a);return c.transformBox(b)},getWidth:function(){return this.getRenderBox().width},getHeight:function(){return this.getRenderBox().height},getSize:function(){var a=this.getRenderBox();return delete a.x,delete a.y,a},setOpacity:function(a){return this.node.setAttribute("opacity",a),this},getOpacity:function(){var a=this.node.getAttribute("opacity");return a?+a:1},setVisible:function(a){return a?this.node.removeAttribute("display"):this.node.setAttribute("display","none"),this},getVisible:function(){this.node.getAttribute("display")},hasAncestor:function(a){for(var b=this.container;b;){if(b===a)return!0;b=b.container}return!1},getTransform:function(a){return f.getCTM(this,a)},clearTransform:function(){return this.node.removeAttribute("transform"),this.transform={translate:null,rotate:null,scale:null,matrix:null},this.trigger("shapeupdate",{type:"transform"}),this},_applyTransform:function(){var a=this.transform,c=[];return a.translate&&c.push(["translate(",a.translate,")"]),a.rotate&&c.push(["rotate(",a.rotate,")"]),a.scale&&c.push(["scale(",a.scale,")"]),a.matrix&&c.push(["matrix(",a.matrix,")"]),this.node.setAttribute("transform",b.flatten(c).join(" ")),this},setMatrix:function(a){return this.transform.matrix=a,this._applyTransform()},setTranslate:function(a){return this.transform.translate=null!==a&&g.call(arguments)||null,this._applyTransform()},setRotate:function(a){return this.transform.rotate=null!==a&&g.call(arguments)||null,this._applyTransform()},setScale:function(a){return this.transform.scale=null!==a&&g.call(arguments)||null,this._applyTransform()},translate:function(a,b){var c=this.transform.matrix||new f;return void 0===b&&(b=0),this.transform.matrix=c.translate(a,b),this._applyTransform()},rotate:function(a){var b=this.transform.matrix||new f;return this.transform.matrix=b.rotate(a),this._applyTransform()},scale:function(a,b){var c=this.transform.matrix||new f;return void 0===b&&(b=a),this.transform.matrix=c.scale(a,b),this._applyTransform()},skew:function(a,b){var c=this.transform.matrix||new f;return void 0===b&&(b=a),this.transform.matrix=c.skew(a,b),this._applyTransform()},stroke:function(a,b){return a&&a.stroke?a.stroke(this):a?(this.node.setAttribute("stroke",a.toString()),b&&this.node.setAttribute("stroke-width",b)):null===a&&this.node.removeAttribute("stroe"),this},fill:function(a){return a&&this.node.setAttribute("fill",a.toString()),null===a&&this.node.removeAttribute("fill"),this},setAttr:function(a,c){var d=this;return b.isObject(a)&&b.each(a,function(a,b){d.setAttr(b,a)}),void 0===c||null===c||""===c?this.node.removeAttribute(a):this.node.setAttribute(a,c),this},getAttr:function(a){return this.node.getAttribute(a)}});return i}},_p[62]={value:function(){var a=_p.r(29),b=_p.r(12),c=_p.r(11).createClass("ShapeContainer",{base:a,isShapeContainer:!0,handleAdd:function(a,b){var c=this.getShapeNode();c.insertBefore(a.node,c.childNodes[b]||null),a.trigger("add",{container:this}),a.notifyTreeModification&&a.notifyTreeModification("treeadd",this)},handleRemove:function(a){var b=this.getShapeNode();b.removeChild(a.node),a.trigger("remove",{container:this}),a.notifyTreeModification&&a.notifyTreeModification("treeremove",this)},notifyTreeModification:function(a,b){this.eachItem(function(c,d){d.notifyTreeModification&&d.notifyTreeModification(a,b),d.trigger(a,{container:b})})},getShape:function(a){return this.getItem(a)},addShape:function(a,b){return this.addItem(a,b)},put:function(a){return this.addShape(a),a},appendShape:function(a){return this.addShape(a)},prependShape:function(a){return this.addShape(a,0)},replaceShape:function(a,b){var c=this.indexOf(b);if(-1!==c)return this.removeShape(c),this.addShape(a,c),this},addShapeBefore:function(a,b){var c=this.indexOf(b);return this.addShape(a,c)},addShapeAfter:function(a,b){var c=this.indexOf(b);return this.addShape(a,-1===c?void 0:c+1)},addShapes:function(a){return this.addItems(a)},removeShape:function(a){return this.removeItem(a)},getShapes:function(){return this.getItems()},getShapesByType:function(a){function c(e){a.toLowerCase()==e.getType().toLowerCase()&&d.push(e),e.isShapeContainer&&b.each(e.getShapes(),function(a){c(a)})}var d=[];return c(this),d},getShapeById:function(a){return this.getShapeNode().getElementById(a).shape},arrangeShape:function(a,b){return this.removeShape(a).addShape(a,b)},getShapeNode:function(){return this.shapeNode||this.node}}),d=_p.r(61);return _p.r(11).extendClass(d,{bringTo:function(a){return this.container.arrangeShape(this,a),this},bringFront:function(){return this.bringTo(this.container.indexOf(this)+1)},bringBack:function(){return this.bringTo(this.container.indexOf(this)-1)},bringTop:function(){return this.container.removeShape(this).addShape(this),this},bringRear:function(){return this.bringTo(0)},bringRefer:function(a,b){return a.container&&(this.remove&&this.remove(),a.container.addShape(this,a.container.indexOf(a)+(b||0))),this},bringAbove:function(a){return this.bringRefer(a)},bringBelow:function(a){return this.bringRefer(a,1)},replaceBy:function(a){return this.container&&(a.bringAbove(this),this.remove()),this}}),c}},_p[63]={value:function(){var a=_p.r(44),b=_p.r(12),c=_p.r(51);return _p.r(11).createClass("ShapeEvent",{constructor:function(a){var c=null;b.isObject(a.target)?b.extend(this,a):(this.type=a.type,c=a.target,c.correspondingUseElement&&(c=c.correspondingUseElement),this.originEvent=a,this.targetShape=c.shape||c.paper||a.currentTarget&&(a.currentTarget.shape||a.currentTarget.paper),a._kityParam&&b.extend(this,a._kityParam))},preventDefault:function(){var a=this.originEvent;return a?a.preventDefault?(a.preventDefault(),a.cancelable):(a.returnValue=!1,!0):!0},getPosition:function(b,d){if(!this.originEvent)return null;var e=this.originEvent.touches?this.originEvent.touches[d||0]:this.originEvent,f=this.targetShape,g=f.shapeNode||f.node,h=new c(e&&e.clientX||0,e&&e.clientY||0),i=a.transformPoint(h,g.getScreenCTM().inverse()),j=a.getCTM(f,b||"view").transformPoint(i);return j},stopPropagation:function(){var a=this.originEvent;return a?void(a.stopPropagation?a.stopPropagation():a.cancelBubble=!1):!0}})}},_p[64]={value:function(){return _p.r(11).createClass("ShapePoint",{base:_p.r(51),constructor:function(a,b){this.callBase(a,b)},setX:function(a){return this.setPoint(a,this.y)},setY:function(a){return this.setPoint(this.x,a)},setPoint:function(a,b){return this.x=a,this.y=b,this.update(),this},getPoint:function(){return this},update:function(){return this.container&&this.container.update&&this.container.update(),this}})}},_p[65]={value:{COLOR_STANDARD:{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00"},EXTEND_STANDARD:{}}},_p[66]={value:function(){var a={3:.2,5:.38196601125,6:.57735026919,8:.541196100146,10:.726542528005,12:.707106781187},b=_p.r(51);return _p.r(11).createClass("Star",{base:_p.r(47),constructor:function(a,c,d,e,f){this.callBase(),this.vertex=a||3,this.radius=c||0,this.shrink=d,this.offset=e||new b(0,0),this.angleOffset=f||0,this.draw()},getVertex:function(){return this.vertex},setVertex:function(a){return this.vertex=a,this.draw()},getRadius:function(){return this.radius},setRadius:function(a){return this.radius=a,this.draw()},getShrink:function(){return this.shrink},setShrink:function(a){return this.shrink=a,this.draw()},getOffset:function(){return this.offset},setOffset:function(a){return this.offset=a,this.draw()},getAngleOffset:function(){return this.angleOffset},setAngleOffset:function(a){return this.angleOffset=a,this.draw()},draw:function(){var c,d,e=this.radius,f=this.radius*(this.shrink||a[this.vertex]||.5),g=this.vertex,h=this.offset,i=90,j=180/g,k=this.angleOffset,l=this.getDrawer();for(l.clear(),l.moveTo(b.fromPolar(f,i)),c=1;2*g>=c;c++)d=i+j*c,l.lineTo(c%2?b.fromPolar(e,d+k).offset(h):b.fromPolar(f,d));l.close()}})}},_p[67]={value:function(){function a(a){return a.classList||(a.classList=new b(a)),a.classList}var b=_p.r(11).createClass("ClassList",{constructor:function(a){this._node=a,this._list=a.className.toString().split(" ")},_update:function(){this._node.className=this._list.join(" ")},add:function(a){this._list.push(a),this._update()},remove:function(a){var b=this._list.indexOf(a);~b&&this._list.splice(b,1),this._update()},contains:function(a){return!!~this._list.indexOf(a)}});return _p.r(11).createClass("Styled",{addClass:function(b){return a(this.node).add(b),this},removeClass:function(b){return a(this.node).remove(b),this},hasClass:function(b){return a(this.node).contains(b)},setStyle:function(a){if(2==arguments.length)return this.node.style[arguments[0]]=arguments[1],this;for(var b in a)a.hasOwnProperty(b)&&(this.node.style[b]=a[b]);return this}})}},_p[68]={value:function(){var a=document,b=0,c={createNode:function(d){var e=a.createElementNS(c.ns,d);return e.id="kity_"+d+"_"+b++,e},defaults:{stroke:"none",fill:"none"},xlink:"http://www.w3.org/1999/xlink",ns:"http://www.w3.org/2000/svg"};return c}},_p[69]={value:function(){var a=_p.r(51);return _p.r(11).createClass("Sweep",{base:_p.r(47),constructor:function(a,b,c){this.callBase(),this.sectionArray=a||[],this.angle=b||0,this.angleOffset=c||0,this.draw()},getSectionArray:function(){return this.sectionArray},setSectionArray:function(a){return this.sectionArray=a,this.draw()},getAngle:function(){return this.angle},setAngle:function(a){return this.angle=a,this.draw()},getAngleOffset:function(){return this.angleOffset},setAngleOffset:function(a){return this.angleOffset=a,this.draw()},draw:function(){var a,b=this.sectionArray;for(a=0;a<b.length;a+=2)this.drawSection(b[a],b[a+1]);return this},drawSection:function(b,c){var d=this.angle&&(this.angle%360?this.angle%360:360),e=this.angleOffset,f=e+d/2,g=e+d,h=this.getDrawer();return h.redraw(),0===d?void h.done():(h.moveTo(a.fromPolar(b,e)),h.lineTo(a.fromPolar(c,e)),c&&(h.carcTo(c,0,1,a.fromPolar(c,f)),h.carcTo(c,0,1,a.fromPolar(c,g))),h.lineTo(a.fromPolar(b,g)),b&&(h.carcTo(b,0,1,a.fromPolar(b,f)),h.carcTo(b,0,1,a.fromPolar(b,e))),h.close(),void h.done())}})}},_p[70]={value:function(){function a(a){var b=a._cachedFontHash;if(f[b])return f[b];var c=a.getContent();a.setContent("test");var d=a.getBoundaryBox(),e=a.getY()+ +a.node.getAttribute("dy"),g=e-d.y,h=g-d.height;return a.setContent(c),f[b]={top:g,bottom:h,middle:(g+h)/2}}var b=_p.r(71),c=_p.r(62),d=_p.r(68),e=_p.r(12),f={};return _p.r(11).createClass("Text",{base:b,mixins:[c],constructor:function(a){this.callBase("text"),void 0!==a&&this.setContent(a),this._buildFontHash()},_buildFontHash:function(){var a=window.getComputedStyle(this.node);this._cachedFontHash=[a.fontFamily,a.fontSize,a.fontStretch,a.fontStyle,a.fontVariant,a.fontWeight].join("-")},_fontChanged:function(a){var b=this._lastFont,c=e.extend({},b,a);if(!b)return b=a,!0;var d=b.family!=c.family||b.size!=c.size||b.style!=c.style||b.weight!=c.weight;return b=c,d},setX:function(a){return this.node.setAttribute("x",a),this},setPosition:function(a,b){return this.setX(a).setY(b)},setY:function(a){return this.node.setAttribute("y",a),this},getX:function(){return+this.node.getAttribute("x")||0},getY:function(){return+this.node.getAttribute("y")||0},setFont:function(a){return this.callBase(a),this._fontChanged(a)&&(this._buildFontHash(),this.setVerticalAlign(this.getVerticalAlign())),this},setTextAnchor:function(a){return this.node.setAttribute("text-anchor",a),this},getTextAnchor:function(){return this.node.getAttribute("text-anchor")||"start"},setVerticalAlign:function(b){return this.whenPaperReady(function(){var c;switch(b){case"top":c=a(this).top;break;case"bottom":c=a(this).bottom;break;case"middle":c=a(this).middle;break;default:c=0}this.node.setAttribute("dy",c)}),this.verticalAlign=b,this},getVerticalAlign:function(){return this.verticalAlign||"baseline"},setStartOffset:function(a){this.shapeNode!=this.node&&this.shapeNode.setAttribute("startOffset",100*a+"%")},addSpan:function(a){return this.addShape(a),this},setPath:function(a){var b=this.shapeNode;if(this.shapeNode==this.node){for(b=this.shapeNode=d.createNode("textPath");this.node.firstChild;)this.shapeNode.appendChild(this.node.firstChild);this.node.appendChild(b)}return b.setAttributeNS(d.xlink,"xlink:href","#"+a.node.id),this.setTextAnchor(this.getTextAnchor()),this}})}},_p[71]={value:function(){var a=_p.r(61);return _p.r(11).createClass("TextContent",{base:a,constructor:function(a){this.callBase(a),this.shapeNode=this.shapeNode||this.node,this.shapeNode.setAttribute("text-rendering","geometricPrecision")},clearContent:function(){for(;this.shapeNode.firstChild;)this.shapeNode.removeChild(this.shapeNode.firstChild);return this},setContent:function(a){return this.shapeNode.textContent=a,this},getContent:function(){return this.shapeNode.textContent},appendContent:function(a){return this.shapeNode.textContent+=a,this},setSize:function(a){return this.setFontSize(a)},setFontSize:function(a){return this.setFont({size:a})},setFontFamily:function(a){return this.setFont({family:a})},setFontBold:function(a){return this.setFont({weight:a?"bold":"normal"})},setFontItalic:function(a){return this.setFont({style:a?"italic":"normal"})},setFont:function(a){var b=this.node;return["family","size","weight","style"].forEach(function(c){null===a[c]?b.removeAttribute("font-"+c):a[c]&&b.setAttribute("font-"+c,a[c])}),this},getExtentOfChar:function(a){return this.node.getExtentOfChar(a)},getRotationOfChar:function(a){return this.node.getRotationOfChar(a)},getCharNumAtPosition:function(a,b){return this.node.getCharNumAtPosition(this.node.viewportElement.createSVGPoint(a,b))}})}},_p[72]={value:function(){var a=_p.r(71),b=_p.r(67);return _p.r(11).createClass("TextSpan",{base:a,mixins:[b],constructor:function(a){this.callBase("tspan"),this.setContent(a)}})}},_p[73]={value:function(){var a=_p.r(68),b=_p.r(11),c=b.createClass("Use",{base:_p.r(61),constructor:function(a){this.callBase("use"),this.ref(a)},ref:function(b){if(!b)return this.node.removeAttributeNS(a.xlink,"xlink:href"),this;var c=b.getId();return c&&this.node.setAttributeNS(a.xlink,"xlink:href","#"+c),"none"===b.node.getAttribute("fill")&&b.node.removeAttribute("fill"),"none"===b.node.getAttribute("stroke")&&b.node.removeAttribute("stroke"),this}}),d=_p.r(61);return b.extendClass(d,{use:function(){return new c(this)}}),c}},_p[74]={value:function(){var a=_p.r(51),b=_p.r(44),c=_p.r(11).createClass("Vector",{base:a,constructor:function(a,b){this.callBase(a,b)},square:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.square())},add:function(a){return new c(this.x+a.x,this.y+a.y)},minus:function(a){return new c(this.x-a.x,this.y-a.y)},dot:function(a){return this.x*a.x+this.y*a.y},project:function(a){return a.multipy(this.dot(a)/a.square())},normalize:function(a){return void 0===a&&(a=1),this.multipy(a/this.length())},multipy:function(a){return new c(this.x*a,this.y*a)},rotate:function(a,d){"rad"==d&&(a=a/Math.PI*180);var e=(new b).rotate(a).transformPoint(this);return new c(e.x,e.y)},vertical:function(){return new c(this.y,-this.x)},reverse:function(){return this.multipy(-1)},getAngle:function(){var a=this.length();if(0===a)return 0;var b=Math.acos(this.x/a),c=this.y>0?1:-1;return 180*c*b/Math.PI}});return c.fromPoints=function(a,b){return new c(b.x-a.x,b.y-a.y)},_p.r(11).extendClass(a,{asVector:function(){return new c(this.x,this.y)}}),c}},_p[75]={value:function(){var a=_p.r(62),b=_p.r(76);return _p.r(11).createClass("View",{mixins:[a,b],base:_p.r(75),constructor:function(){this.callBase("view")}})}},_p[76]={value:function(){return _p.r(11).createClass("ViewBox",{getViewBox:function(){var a=this.node.getAttribute("viewBox");return null===a?{x:0,y:0,width:this.node.clientWidth||this.node.parentNode.clientWidth,height:this.node.clientHeight||this.node.parentNode.clientHeight}:(a=a.split(" "),{x:+a[0],y:+a[1],width:+a[2],height:+a[3]})},setViewBox:function(a,b,c,d){return this.node.setAttribute("viewBox",[a,b,c,d].join(" ")),this}})}},_p[77]={value:function(){var a={},b=_p.r(12);return a.version="2.0.0",b.extend(a,{createClass:_p.r(11).createClass,extendClass:_p.r(11).extendClass,Utils:b,Browser:_p.r(10),Box:_p.r(25),Bezier:_p.r(23),BezierPoint:_p.r(24),Circle:_p.r(26),Clip:_p.r(27),Color:_p.r(28),Container:_p.r(29),Curve:_p.r(30),Ellipse:_p.r(33),GradientBrush:_p.r(36),Group:_p.r(37),HyperLink:_p.r(38),Image:_p.r(39),Line:_p.r(40),LinearGradientBrush:_p.r(41),Mask:_p.r(43),Matrix:_p.r(44),Marker:_p.r(42),Palette:_p.r(45),Paper:_p.r(46),Path:_p.r(47),PatternBrush:_p.r(48),Pen:_p.r(49),Point:_p.r(51),PointContainer:_p.r(52),Polygon:_p.r(54),Polyline:_p.r(55),Pie:_p.r(50),RadialGradientBrush:_p.r(56),Rect:_p.r(57),RegularPolygon:_p.r(58),Ring:_p.r(60),Shape:_p.r(61),ShapePoint:_p.r(64),ShapeContainer:_p.r(62),Sweep:_p.r(69),Star:_p.r(66),Text:_p.r(70),TextSpan:_p.r(72),Use:_p.r(73),Vector:_p.r(74),g:_p.r(35),Animator:_p.r(0),Easing:_p.r(1),OpacityAnimator:_p.r(4),RotateAnimator:_p.r(6),ScaleAnimator:_p.r(7),Timeline:_p.r(8),TranslateAnimator:_p.r(9),PathAnimator:_p.r(5),MotionAnimator:_p.r(3),requestFrame:_p.r(2).requestFrame,releaseFrame:_p.r(2).releaseFrame,Filter:_p.r(20),GaussianblurFilter:_p.r(21),ProjectionFilter:_p.r(22),ColorMatrixEffect:_p.r(13),CompositeEffect:_p.r(14),ConvolveMatrixEffect:_p.r(15),Effect:_p.r(16),GaussianblurEffect:_p.r(17),OffsetEffect:_p.r(18)}),window.kity=a}};var moduleMapping={kity:77};use("kity")}();var KityMinder=window.KM=window.KityMinder=function(){var a={},b=0,c={};return{version:"1.2.1",uuid:function(a){return a=a||"unknown",c[a]=c[a]||0,++c[a],a+"_"+c[a]},createMinder:function(a,b){b=b||{},b.renderTo=Utils.isString(a)?document.getElementById(a):a;var c=new Minder(b);return this.addMinder(b.renderTo,c),c},addMinder:function(c,d){var e;e="string"==typeof c?c:c.id||"KM_INSTANCE_"+b++,a[e]=d},getMinder:function(c,d){var e;return e="string"==typeof c?c:c.id||"KM_INSTANCE_"+b++,a[e]||this.createMinder(c,d)},LANG:{}}}(),utils=Utils=KityMinder.Utils={extend:kity.Utils.extend.bind(kity.Utils),listen:function(a,b,c){var d=utils.isArray(b)?b:utils.trim(b).split(/\s+/),e=d.length;if(e)for(;e--;)if(b=d[e],a.addEventListener)a.addEventListener(b,c,!1);else{c._d||(c._d={els:[]});var f=b+c.toString(),g=utils.indexOf(c._d.els,a);c._d[f]&&-1!=g||(-1==g&&c._d.els.push(a),c._d[f]||(c._d[f]=function(a){return c.call(a.srcElement,a||window.event)}),a.attachEvent("on"+b,c._d[f]))}a=null},trim:function(a){return a.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},each:function(a,b,c){if(null!=a)if(a.length===+a.length){for(var d=0,e=a.length;e>d;d++)if(b.call(c,d,a[d],a)===!1)return!1}else for(var f in a)if(a.hasOwnProperty(f)&&b.call(c,f,a[f],a)===!1)return!1},addCssRule:function(a,b,c){var d;return void 0===b||b&&b.nodeType&&9==b.nodeType?(c=b&&b.nodeType&&9==b.nodeType?b:c||document,d=c.getElementById(a),d?d.innerHTML:void 0):(c=c||document,d=c.getElementById(a),""===b?d?(d.parentNode.removeChild(d),!0):!1:void(d?d.innerHTML=b:(d=c.createElement("style"),d.id=a,d.innerHTML=b,c.getElementsByTagName("head")[0].appendChild(d))))},keys:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b},proxy:function(a,b){return function(){return a.apply(b,arguments)}},indexOf:function(a,b,c){var d=-1;return c=this.isNumber(c)?c:0,this.each(a,function(a,e){return e>=c&&a===b?(d=e,!1):void 0}),d},argsToArray:function(a,b){return Array.prototype.slice.call(a,b||0)},clonePlainObject:function(a,b){var c;b=b||{};for(var d in a)a.hasOwnProperty(d)&&(c=a[d],utils.isObject(c)||utils.isArray(c)?(b[d]=utils.isArray(c)?[]:{},utils.clonePlainObject(a[d],b[d])):b[d]=c);return b},compareObject:function(a,b){var c;if(this.isEmptyObject(a)!==this.isEmptyObject(b))return!1;if(this.getObjectLength(a)!=this.getObjectLength(b))return!1;for(var d in a)if(a.hasOwnProperty(d)){if(c=a[d],void 0===b[d])return!1;if(this.isObject(c)||this.isArray(c)){if(this.isObject(b[d])!==this.isObject(c))return!1;if(this.isArray(c)!==this.isArray(b[d]))return!1;if(this.compareObject(c,b[d])===!1)return!1}else if(c!=b[d])return!1}return!0},getObjectLength:function(a){if(this.isArray(a)||this.isString(a))return a.length;var b=0;for(var c in a)a.hasOwnProperty(c)&&b++;return b},isEmptyObject:function(a){if(null==a)return!0;if(this.isArray(a)||this.isString(a))return 0===a.length;for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},loadFile:function(){function a(a,c){try{for(var d,e=0;d=b[e++];)if(d.doc===a&&d.url==(c.src||c.href))return d}catch(f){return null}}var b=[];return function(c,d,e){var f=a(c,d);if(f)return void(f.ready?e&&e():f.funs.push(e));if(b.push({doc:c,url:d.src||d.href,funs:[e]}),!c.body){var g=[];for(var h in d)"tag"!=h&&g.push(h+'="'+d[h]+'"');return void c.write("<"+d.tag+" "+g.join(" ")+" ></"+d.tag+">")}if(!d.id||!c.getElementById(d.id)){var i=c.createElement(d.tag);delete d.tag;for(var h in d)i.setAttribute(h,d[h]);i.onload=i.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){if(f=a(c,d),f.funs.length>0){f.ready=1;for(var b;b=f.funs.pop();)b()}i.onload=i.onreadystatechange=null}},c.getElementsByTagName("head")[0].appendChild(i)}}}(),clone:function(a,b){var c;b=b||{};for(var d in a)a.hasOwnProperty(d)&&(c=a[d],"object"==typeof c?(b[d]=utils.isArray(c)?[]:{},utils.clone(a[d],b[d])):b[d]=c);return b},unhtml:function(a,b){return a?a.replace(b||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp);)?/g,function(a,b){return b?a:{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[a]}):""},cloneArr:function(a){return[].concat(a)}};Utils.each(["String","Function","Array","Number","RegExp","Object"],function(a,b){KityMinder.Utils["is"+b]=function(a){return Object.prototype.toString.apply(a)=="[object "+b+"]"}});var Command=kity.createClass("Command",{constructor:function(){this._isContentChange=!0,this._isSelectionChange=!1},execute:function(){},setContentChanged:function(a){this._isContentChange=!!a},isContentChanged:function(){return this._isContentChange},setSelectionChanged:function(a){this._isSelectionChange=!!a},isSelectionChanged:function(){return this._isContentChange},queryState:function(){return 0},queryValue:function(){return 0},isNeedUndo:function(){return!0}}),MinderNode=KityMinder.MinderNode=kity.createClass("MinderNode",{constructor:function(a){this.parent=null,this.root=this,this.children=[],this.data={},this.tmpData={},this.initContainers(),Utils.isString(a)?this.setText(a):this.setData(a)},initContainers:function(){this.rc=(new kity.Group).setId(KityMinder.uuid("minder_node")),this.rc.minderNode=this},isRoot:function(){return this.root===this},isLeaf:function(){return 0===this.children.length},getRoot:function(){return this.root||this},getParent:function(){return this.parent},getLevel:function(){for(var a=0,b=this.parent;b;)a++,b=b.parent;return a},getComplex:function(){var a=0;return this.traverse(function(){a++}),a},getType:function(){return this.type=["root","main","sub"][Math.min(this.getLevel(),2)],this.type},isAncestorOf:function(a){for(var b=a.parent;b;){if(b==this)return!0;b=b.parent}return!1},setText:function(a){return this.setData("text",a)},getText:function(){return this.getData("text")},preTraverse:function(a,b){var c=this.getChildren();b||a(this);for(var d=0;d<c.length;d++)c[d].preTraverse(a)
},postTraverse:function(a,b){for(var c=this.getChildren(),d=0;d<c.length;d++)c[d].postTraverse(a);b||a(this)},traverse:function(a,b){return this.postTraverse(a,b)},getChildren:function(){return this.children},getIndex:function(){return this.parent?this.parent.children.indexOf(this):-1},insertChild:function(a,b){void 0===b&&(b=this.children.length),a.parent&&a.parent.removeChild(a),a.parent=this,a.root=this.root,this.children.splice(b,0,a)},appendChild:function(a){return this.insertChild(a)},prependChild:function(a){return this.insertChild(a,0)},removeChild:function(a){var b,c=a;a instanceof MinderNode&&(c=this.children.indexOf(a)),c>=0&&(b=this.children.splice(c,1)[0],b.parent=null,b.root=b)},getChild:function(a){return this.children[a]},getFirstChild:function(){return this.children[0]},getLastChild:function(){return this.children[this.children.length-1]},getData:function(a){return void 0===a?this.data:this.data[a]},setData:function(a,b){return void 0===a?this.data={}:utils.isObject(a)?Utils.extend(this.data,a):void 0===b?(this.data[a]=null,delete this.data[a]):this.data[a]=b,this},getRenderContainer:function(){return this.rc},getCommonAncestor:function(a){return Utils.getNodeCommonAncestor(this,a)},contains:function(a){return this==a||this.isAncestorOf(a)},clone:function(){function a(b,c){var d=new KM.MinderNode;d.data=Utils.clonePlainObject(c.getData()),d.tmpData=Utils.clonePlainObject(c.getTmpData()),b&&b.appendChild(d);for(var e,f=0;e=c.children[f++];)a(d,e);return d}return a(null,this)},equals:function(a,b){function c(){e&&d.setSelectedFlag(),f&&a.setSelectedFlag()}var d=this;if(b){var e=!1,f=!1;d.isSelected()&&(e=!0,d.clearSelectedFlag()),a.isSelected()&&(f=!0,a.clearSelectedFlag())}if(a.children.length!=this.children.length)return c(),!1;if(utils.compareObject(a.getData(),d.getData())===!1)return c(),!1;if(utils.compareObject(a.getTmpData(),d.getTmpData())===!1)return c(),!1;for(var g,h=0;g=d.children[h];h++)if(g.equals(a.children[h],b)===!1)return c(),!1;return c(),!0},clearChildren:function(){this.children=[]},setTmpData:function(a,b){var c=this;utils.isObject(a)&&utils.each(a,function(a,b){c.setTmpData(a,b)}),void 0===b||null===b||""===b?delete this.tmpData[a]:this.tmpData[a]=b},getTmpData:function(a){return void 0===a?this.tmpData:this.tmpData[a]},setValue:function(a){return this.data={},this.setData(utils.clonePlainObject(a.getData())),this.tmpData={},this.setTmpData(utils.clonePlainObject(a.getTmpData())),this}});MinderNode.getCommonAncestor=function(a,b){if(a instanceof Array)return MinderNode.getCommonAncestor.apply(this,a);switch(arguments.length){case 1:return a.parent;case 2:if(a.isAncestorOf(b))return a;if(b.isAncestorOf(a))return b;for(var c=a.parent;c&&!c.isAncestorOf(b);)c=c.parent;return c;default:return Array.prototype.reduce.call(arguments,function(a,b){return MinderNode.getCommonAncestor(a,b)},a)}},function(){var a;KityMinder.registerModule=function(b,c){a||(a={}),a[b]=c},KityMinder.getModules=function(){return a}}();var MinderEvent=kity.createClass("MindEvent",{constructor:function(a,b,c){b=b||{},b.getType&&"ShapeEvent"==b.getType()?(this.kityEvent=b,this.originEvent=b.originEvent,this.getPosition=b.getPosition.bind(b)):b.target&&b.preventDefault?this.originEvent=b:kity.Utils.extend(this,b),this.type=a,this._canstop=c||!1},getTargetNode:function(){var a=this.kityEvent&&this.kityEvent.targetShape;if(!a)return null;for(;!a.minderNode&&a.container;)a=a.container;return a.minderNode||null},stopPropagation:function(){this._stoped=!0},stopPropagationImmediately:function(){this._immediatelyStoped=!0,this._stoped=!0},shouldStopPropagation:function(){return this._canstop&&this._stoped},shouldStopPropagationImmediately:function(){return this._canstop&&this._immediatelyStoped},preventDefault:function(){this.originEvent.preventDefault()},isRightMB:function(){var a=!1;return this.originEvent?("which"in this.originEvent?a=3==this.originEvent.which:"button"in this.originEvent&&(a=2==this.originEvent.button),a):!1}}),Minder=KityMinder.Minder=kity.createClass("KityMinder",{constructor:function(a){this._options=Utils.extend(window.KITYMINDER_CONFIG||{},a),this.setDefaultOptions(KM.defaultOptions),this._initEvents(),this._initMinder(),this._initSelection(),this._initStatus(),this._initShortcutKey(),this._initContextmenu(),this._initModules(),this.getOptions("readOnly")===!0&&this.setDisabled(),this.refresh(),this.setTheme(),this.fire("ready")},getOptions:function(a){var b;return a?(b=this.getPreferences(a),null===b||void 0===b?this._options[a]:b):(b=this.getPreferences(),b?utils.extend(b,this._options,!0):this._options)},setDefaultOptions:function(a,b,c){var d={};Utils.isString(a)?d[a]=b:d=a,utils.extend(this._options,d,!c)},setOptions:function(a,b){this.setPreferences(a,b)},_initMinder:function(){this._paper=new kity.Paper,this._paper.getNode().setAttribute("contenteditable",!0),this._paper.getNode().ondragstart=function(a){a.preventDefault()},this._paper.shapeNode.setAttribute("transform","translate(0.5, 0.5)"),this._addRenderContainer(),this.setRoot(this.createNode(this.getLang().maintopic)),this._options.renderTo&&this.renderTo(this._options.renderTo)},_addRenderContainer:function(){this._rc=(new kity.Group).setId(KityMinder.uuid("minder")),this._paper.addShape(this._rc)},renderTo:function(a){this._paper.renderTo(this._renderTarget=a),this._bindEvents()},getRenderContainer:function(){return this._rc},getPaper:function(){return this._paper},getRenderTarget:function(){return this._renderTarget},_initShortcutKey:function(){this._shortcutkeys={},this._bindshortcutKeys()},addShortcutKeys:function(a,b){var c={},d=this;b?c[a]=b:c=a,utils.each(c,function(a,b){d._shortcutkeys[a.toLowerCase()]=b})},getShortcutKey:function(a){return this._shortcutkeys[a]},_bindshortcutKeys:function(){function a(a,b,c){switch(a){case"ctrl":case"cmd":if(c.ctrlKey||c.metaKey)return!0;break;case"alt":if(c.altKey)return!0;break;case"shift":if(c.shiftKey)return!0}return b==keymap[a]?!0:!1}var b=this,c=this._shortcutkeys;b.on("keydown",function(d){var e=d.originEvent,f=e.keyCode||e.which;for(var g in c){var h=c[g].toLowerCase().split("+"),i=0;if(utils.each(h,function(b,c){a(c,f,e)&&i++}),i==h.length){-1!=b.queryCommandState(g)&&b.execCommand(g),e.preventDefault();break}}})},_initContextmenu:function(){this.contextmenus=[]},addContextmenu:function(a){return utils.isArray(a)?this.contextmenus=this.contextmenus.concat(a):this.contextmenus.push(a),this},getContextmenu:function(){return this.contextmenus},_initStatus:function(){this._status="normal",this._rollbackStatus="normal"},setStatus:function(){var a=~window.location.href.indexOf("status"),b=~window.location.href.indexOf("trace");return function(c){return c!=this._status&&(this._rollbackStatus=this._status,this._status=c,this.fire("statuschange",{lastStatus:this._rollbackStatus,currentStatus:this._status}),a&&(console.log(window.event.type,this._rollbackStatus,"->",this._status),b&&console.trace())),this}}(),rollbackStatus:function(){this.setStatus(this._rollbackStatus)},getStatus:function(){return this._status},setDisabled:function(){var a=this;a.bkqueryCommandState=a.queryCommandState,a.bkqueryCommandValue=a.queryCommandValue,a.queryCommandState=function(b){var c=this._getCommand(b);return c&&c.enableReadOnly===!1?a.bkqueryCommandState.apply(a,arguments):-1},a.queryCommandValue=function(b){var c=this._getCommand(b);return c&&c.enableReadOnly===!1?a.bkqueryCommandValue.apply(a,arguments):null},this.setStatus("readonly"),a.fire("interactchange")},setEnabled:function(){var a=this;a.bkqueryCommandState&&(a.queryCommandState=a.bkqueryCommandState,delete a.bkqueryCommandState),a.bkqueryCommandValue&&(a.queryCommandValue=a.bkqueryCommandValue,delete a.bkqueryCommandValue),this.rollbackStatus(),a.fire("interactchange")}});Utils.extend(KityMinder,{compatibility:function(a){function b(a,c){c(a),a.children&&a.children.forEach(function(a){b(a,c)})}function c(a){var c=a.data.currentstyle;delete a.data.currentstyle,"bottom"==c?(a.template="structure",a.theme="snow"):"default"==c&&(a.template="default",a.theme="classic"),b(a,function(a){var b=a.data;"PriorityIcon"in b&&(b.priority=b.PriorityIcon,delete b.PriorityIcon),"ProgressIcon"in b&&(b.progress=1+(b.ProgressIcon-1<<1),delete b.ProgressIcon),delete b.point,delete b.layout})}var d=a.version||"1.1.3";switch(d){case"1.1.3":c(a);case"1.2.0":}return a}}),Utils.extend(KityMinder,{_protocals:{},registerProtocal:function(a,b){KityMinder._protocals[a]=b()},findProtocal:function(a){return KityMinder._protocals[a]||null},getSupportedProtocals:function(){return Utils.keys(KityMinder._protocals).sort(function(a,b){return KityMinder._protocals[b].recognizePriority-KityMinder._protocals[a].recognizePriority})},getAllRegisteredProtocals:function(){return KityMinder._protocals}});var DEFAULT_TEXT={root:"maintopic",main:"topic",sub:"topic"};kity.extendClass(Minder,{exportData:function(a){function b(a){var c={};c.data=a.getData();var d=a.getChildren();if(d.length){c.children=[];for(var e=0;e<d.length;e++)c.children.push(b(d[e]))}return c}var c,d;return c=b(this.getRoot()),d=KityMinder.findProtocal(a),this._fire(new MinderEvent("beforeexport",{json:c,protocalName:a,protocal:d},!0))!==!0?(c.template=this.getTemplate(),c.theme=this.getTheme(),c.version=KityMinder.version,d?d.encode(c,this):c):void 0},importData:function(a,b){var c,d;if(b?d=KityMinder.findProtocal(b):KityMinder.getSupportedProtocals().every(function(b){var c=KityMinder.findProtocal(b);return c.recognize&&c.recognize(a)&&(d=c),!d}),!d)throw this.fire("unknownprotocal"),new Error("Unsupported protocal: "+b);var e={local:a,protocalName:b,protocal:d},f=this._fire(new MinderEvent("beforeimport",e,!0));if(f)return this;try{c=e.json||(e.json=d.decode(a))}catch(g){return this.fire("parseerror",{message:g.message})}if("object"==typeof c&&"then"in c){var h=this;c.then(function(a){e.json=a,h._doImport(a,e)}).error(function(){h.fire("parseerror")})}else this._doImport(c,e);return this},_doImport:function(a,b){function c(a,b,d){var e=b.data;a.data={};for(var f in e)a.setData(f,e[f]);a.setData("text",e.text||d.getLang(DEFAULT_TEXT[a.getType()]));for(var g=b.children||[],h=0;h<g.length;h++){var i=d.createNode(null,a);c(i,g[h],d)}return a}if(a){for(this._fire(new MinderEvent("preimport",b,!1));this._root.getChildren().length;)this.removeNode(this._root.getChildren()[0]);a=KityMinder.compatibility(a),c(this._root,a,this),this.setTemplate(a.template||null),this.setTheme(a.theme||null),this.refresh(),this.fire("import",b),this._firePharse({type:"contentchange"}),this._firePharse({type:"interactchange"})}}}),kity.extendClass(Minder,{_initEvents:function(){this._eventCallbacks={}},_bindEvents:function(){this._bindPaperEvents(),this._bindKeyboardEvents()},_resetEvents:function(){this._initEvents(),this._bindEvents()},_bindPaperEvents:function(){this._paper.on("click dblclick keydown keyup keypress paste mousedown contextmenu mouseup mousemove mousewheel DOMMouseScroll touchstart touchmove touchend dragenter dragleave drop",this._firePharse.bind(this)),window&&(window.addEventListener("resize",this._firePharse.bind(this)),window.addEventListener("blur",this._firePharse.bind(this))),this._renderTarget.onfocus=function(){console.log("focus")},this._renderTarget.onblur=function(){console.log("blur")}},_bindKeyboardEvents:function(){-1==navigator.userAgent.indexOf("iPhone")&&-1==navigator.userAgent.indexOf("iPod")&&-1==navigator.userAgent.indexOf("iPad")&&Utils.listen(document.body,"keydown keyup keypress paste",this._firePharse.bind(this))},_firePharse:function(a){var b,c,d;"DOMMouseScroll"==a.type&&(a.type="mousewheel",a.wheelDelta=a.originEvent.wheelDelta=-10*a.originEvent.detail,a.wheelDeltaX=a.originEvent.mozMovementX,a.wheelDeltaY=a.originEvent.mozMovementY),b=new MinderEvent("before"+a.type,a,!0),this._fire(b)||(c=new MinderEvent("pre"+a.type,a,!0),d=new MinderEvent(a.type,a,!0),this._fire(c)||this._fire(d)||this._fire(new MinderEvent("after"+a.type,a,!1)),~"mousedown mouseup keydown keyup".indexOf(a.type)&&this._interactChange(a))},_interactChange:function(){var a=this;clearTimeout(this._interactTimeout),this._interactTimeout=setTimeout(function(){var b=a._fire(new MinderEvent("beforeinteractchange"));b||(a._fire(new MinderEvent("preinteractchange")),a._fire(new MinderEvent("interactchange")))},20)},_listen:function(a,b){var c=this._eventCallbacks[a]||(this._eventCallbacks[a]=[]);c.push(b)},_fire:function(a){var b=this.getStatus(),c=this._eventCallbacks[a.type.toLowerCase()]||[];if(b&&(c=c.concat(this._eventCallbacks[b+"."+a.type.toLowerCase()]||[])),0!==c.length){for(var d=this.getStatus(),e=0;e<c.length&&(c[e].call(this,a),this.getStatus()==d&&!a.shouldStopPropagationImmediately());e++);return a.shouldStopPropagation()}},on:function(a,b){var c=this;return utils.each(a.split(/\s+/),function(a,d){c._listen(d.toLowerCase(),b)}),this},off:function(a,b){var c,d,e,f,g=a.split(/\s+/);for(c=0;c<g.length;c++)if(e=this._eventCallbacks[g[c].toLowerCase()]){for(f=null,d=0;d<e.length;d++)e[d]==b&&(f=d);null!==f&&e.splice(f,1)}},fire:function(a,b){var c=new MinderEvent(a,b);return this._fire(c),this}}),kity.extendClass(Minder,{_initModules:function(){var a=KityMinder.getModules(),b=this._options.modules||Utils.keys(a);this._commands={},this._query={},this._modules={},this._rendererClasses={};var c,d,e,f,g,h,i,j=this;for(c=0;c<b.length;c++)if(d=b[c],a[d]){f="function"==typeof a[d]?a[d].call(j):a[d],this._modules[d]=f,f.init&&f.init.call(j,this._options),g=f.commands;for(d in g)this._commands[d.toLowerCase()]=new g[d];if(h=f.events)for(e in h)j.on(e,h[e]);if(i=f.renderers)for(e in i)this._rendererClasses[e]=this._rendererClasses[e]||[],Utils.isArray(i[e])?this._rendererClasses[e]=this._rendererClasses[e].concat(i[e]):this._rendererClasses[e].push(i[e]);f.defaultOptions&&this.setDefaultOptions(f.defaultOptions),f.addShortcutKeys&&this.addShortcutKeys(f.addShortcutKeys),f.contextmenu&&this.addContextmenu(f.contextmenu)}},_garbage:function(){for(this.clearSelect();this._root.getChildren().length;)this._root.removeChild(0)},destroy:function(){var a=this._modules;this._resetEvents(),this._garbage();for(var b in a)a[b].destroy&&a[b].destroy.call(this)},reset:function(){var a=this._modules;this._garbage();for(var b in a)a[b].reset&&a[b].reset.call(this)}}),kity.extendClass(Minder,{_getCommand:function(a){return this._commands[a.toLowerCase()]},_queryCommand:function(a,b,c){var d=this._getCommand(a);if(d){var e=d["query"+b];if(e)return e.apply(d,[this].concat(c))}return 0},queryCommandState:function(a){return this._queryCommand(a,"State",Utils.argsToArray(1))},queryCommandValue:function(a){return this._queryCommand(a,"Value",Utils.argsToArray(1))},execCommand:function(a){a=a.toLowerCase();var b,c,d,e,f=Utils.argsToArray(arguments,1),g=this;return b=this._getCommand(a),e={command:b,commandName:a.toLowerCase(),commandArgs:f},b&&~this.queryCommandState(a)?(!this._hasEnterExecCommand&&b.isNeedUndo()?(this._hasEnterExecCommand=!0,c=this._fire(new MinderEvent("beforeExecCommand",e,!0)),c||(this._fire(new MinderEvent("saveScene")),this._fire(new MinderEvent("preExecCommand",e,!1)),d=b.execute.apply(b,[g].concat(f)),this._fire(new MinderEvent("execCommand",e,!1)),this._fire(new MinderEvent("saveScene")),b.isContentChanged()&&this._firePharse(new MinderEvent("contentchange")),b.isSelectionChanged()&&this._firePharse(new MinderEvent("selectionchange")),this._firePharse(new MinderEvent("interactchange"))),this._hasEnterExecCommand=!1):(d=b.execute.apply(b,[g].concat(f)),this._hasEnterExecCommand||(b.isSelectionChanged()&&this._firePharse(new MinderEvent("selectionchange")),this._firePharse(new MinderEvent("interactchange")))),void 0===d?null:d):!1}}),kity.extendClass(Minder,{getRoot:function(){return this._root},setRoot:function(a){this._root=a,a.minder=this},createNode:function(a,b,c){var d=new MinderNode(a);return this.fire("nodecreate",{node:d}),this.appendNode(d,b,c),d},appendNode:function(a,b,c){return b&&b.insertChild(a,c),this.attachNode(a),this},removeNode:function(a){a.parent&&(a.parent.removeChild(a),this.detachNode(a),this.fire("noderemove",{node:a}))},attachNode:function(a){var b=this._rc;a.traverse(function(a){a.attached=!0,b.addShape(a.getRenderContainer())}),b.addShape(a.getRenderContainer()),this.fire("nodeattach",{node:a})},detachNode:function(a){var b=this._rc;a.traverse(function(a){a.attached=!1,b.removeShape(a.getRenderContainer())}),this.fire("nodedetach",{node:a})},getMinderTitle:function(){return this.getRoot().getText()}}),kity.extendClass(MinderNode,{getMinder:function(){return this.getRoot().minder}}),kity.extendClass(Minder,{_initSelection:function(){this._selectedNodes=[]},renderChangedSelection:function(a){var b=this.getSelectedNodes(),c=[],d=0;for(b.forEach(function(b){-1==a.indexOf(b)&&(c.push(b),b.setTmpData("selected",!0))}),a.forEach(function(a){-1==b.indexOf(a)&&(c.push(a),a.setTmpData("selected",!1))}),c.length&&this.fire("interactchange");d<c.length;)c[d++].render()},getSelectedNodes:function(){return this._selectedNodes},getSelectedNode:function(){return this.getSelectedNodes()[0]||null},removeAllSelectedNodes:function(){var a=this._selectedNodes.splice(0);return this._selectedNodes=[],this.renderChangedSelection(a),this.fire("selectionclear")},removeSelectedNodes:function(a){var b=this,c=this._selectedNodes.slice(0);return a=Utils.isArray(a)?a:[a],Utils.each(a,function(a,c){var d;-1!==(d=b._selectedNodes.indexOf(c))&&b._selectedNodes.splice(d,1)}),this.renderChangedSelection(c),this},select:function(a,b){var c=this.getSelectedNodes().slice(0);b&&(this._selectedNodes=[]);var d=this;return a=Utils.isArray(a)?a:[a],Utils.each(a,function(a,b){-1===d._selectedNodes.indexOf(b)&&d._selectedNodes.push(b)}),this.renderChangedSelection(c),this},toggleSelect:function(a){return Utils.isArray(a)?a.forEach(this.toggleSelect.bind(this)):a.isSelected()?this.removeSelectedNodes(a):this.select(a),this},isSingleSelect:function(){return 1==this._selectedNodes.length},getSelectedAncestors:function(a){function b(a,b){for(var c=a.length-1;c>=0;--c)if(a[c].isAncestorOf(b))return!0;return!1}var c,d=this.getSelectedNodes().slice(0),e=[],f=d.indexOf(this.getRoot());for(~f&&!a&&d.splice(f,1),d.sort(function(a,b){return a.getLevel()-b.getLevel()});c=d.pop();)b(d,c)||e.push(c);return e}}),kity.extendClass(MinderNode,{isSelected:function(){return this.getTmpData("selected")},clearSelectedFlag:function(){this.setTmpData("selected")},setSelectedFlag:function(){this.setTmpData("selected",!0)}});var keymap=KityMinder.keymap=function(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c],b[c.toLowerCase()]=a[c]);return b}({Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Alt:18,CapsLock:20,Esc:27,Spacebar:32,PageUp:33,PageDown:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,direction:{37:1,38:1,39:1,40:1},Insert:45,Del:46,NumLock:144,Cmd:91,CmdFF:224,F2:113,F3:114,F4:115,"=":187,"-":189,b:66,i:73,z:90,y:89,v:86,x:88,c:67,s:83,n:78,"/":191,".":190,controlKeys:{16:1,17:1,18:1,20:1,91:1,224:1},notContentChange:{13:1,9:1,33:1,34:1,35:1,36:1,16:1,17:1,18:1,20:1,91:1,37:1,38:1,39:1,40:1,113:1,114:1,115:1,144:1,27:1},isSelectedNodeKey:{37:1,38:1,39:1,40:1,13:1,9:1},a:65});kity.extendClass(Minder,{getLang:function(a){var b=KM.LANG[this.getOptions("lang")];if(!b)throw Error("not import language file");a=(a||"").split(".");for(var c,d=0;(c=a[d++])&&(b=b[c],b););return b}}),KM.defaultOptions={zIndex:1e3,lang:"zh-cn",readyOnly:!1},kity.extendClass(Minder,function(){var a="kityminder_preference",b=function(){var a=window.localStorage;return{saveLocalData:function(b,c){return a&&c?(a.setItem(b,c),!0):!1},getLocalData:function(b){return a?a.getItem(b):null},removeItem:function(b){a&&a.removeItem(b)}}}();return{setPreferences:function(c,d){var e={};Utils.isString(c)?e[c]=d:e=c;var f=b.getLocalData(a);f?(f=JSON.parse(f),utils.extend(f,e)):f=e,b.saveLocalData(a,JSON.stringify(f))},getPreferences:function(c){var d=b.getLocalData(a);return d?(d=JSON.parse(d),c?d[c]:d):null},resetPreferences:function(a){var c=a?JSON.stringify(a):"";b.saveLocalData(c)}}}());var browser=KityMinder.browser=function(){var a=navigator.userAgent.toLowerCase(),b=window.opera,c={ie:/(msie\s|trident.*rv:)([\w.]+)/.test(a),opera:!!b&&b.version,webkit:a.indexOf(" applewebkit/")>-1,mac:a.indexOf("macintosh")>-1,quirks:"BackCompat"==document.compatMode,ipad:a.indexOf("ipad")>-1};c.gecko="Gecko"==navigator.product&&!c.webkit&&!c.opera&&!c.ie;var d=0;if(c.ie){var e=a.match(/(?:msie\s([\w.]+))/),f=a.match(/(?:trident.*rv:([\w.]+))/);d=e&&f&&e[1]&&f[1]?Math.max(1*e[1],1*f[1]):e&&e[1]?1*e[1]:f&&f[1]?1*f[1]:0,c.ie11Compat=11==document.documentMode,c.ie9Compat=9==document.documentMode,c.ie8=!!document.documentMode,c.ie8Compat=8==document.documentMode,c.ie7Compat=7==d&&!document.documentMode||7==document.documentMode,c.ie6Compat=7>d||c.quirks,c.ie9above=d>8,c.ie9below=9>d}if(c.gecko){var g=a.match(/rv:([\d\.]+)/);g&&(g=g[1].split("."),d=1e4*g[0]+100*(g[1]||0)+1*(g[2]||0))}return/chrome\/(\d+\.\d)/i.test(a)&&(c.chrome=+RegExp.$1),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(a)&&!/chrome/i.test(a)&&(c.safari=+(RegExp.$1||RegExp.$2)),c.opera&&(d=parseFloat(b.version())),c.webkit&&(d=parseFloat(a.match(/ applewebkit\/(\d+)/)[1])),c.version=d,c.isCompatible=!c.mobile&&(c.ie&&d>=6||c.gecko&&d>=10801||c.opera&&d>=9.5||c.air&&d>=1||c.webkit&&d>=522||!1),c}(),ie=browser.ie,webkit=browser.webkit,gecko=browser.gecko,opera=browser.opera;Utils.extend(KityMinder,{_layout:{},registerLayout:function(a,b){KityMinder._layout[a]=b,KityMinder._defaultLayout||(KityMinder._defaultLayout=a)},getLayoutList:function(){return this._layout}}),kity.extendClass(MinderNode,{getLayout:function(){var a=this.getData("layout");return a=a||(this.isRoot()?KityMinder._defaultLayout:this.parent.getLayout())},getOrder:function(){return this.getData("order")||this.getIndex()},setOrder:function(a){return this.setData("order",a)},getOrderHint:function(){return this.parent.getLayoutInstance().getOrderHint(this)},getExpandPosition:function(){return this.getLayoutInstance().getExpandPosition()},getLayoutInstance:function(){var a=KityMinder._layout[this.getLayout()],b=new a;return b},setLayoutTransform:function(a){this._layoutTransform=a},getLayoutTransform:function(){return this._layoutTransform||new kity.Matrix},setLayoutVector:function(a){return this._layoutVector=a,this},getLayoutVector:function(){return this._layoutVector||new kity.Vector},getGlobalLayoutTransform:function(){return this._lastLayoutTransform||new kity.Matrix},getLayoutBox:function(){var a=this.getGlobalLayoutTransform();return a.transformBox(this.getContentBox())},getLayoutPoint:function(){var a=this.getGlobalLayoutTransform();return a.transformPoint(new kity.Point)},getLayoutOffset:function(){var a=this.getData("layout_"+this.getLayout()+"_offset");return a?new kity.Point(a.x,a.y):new kity.Point},setLayoutOffset:function(a){return this.setData("layout_"+this.getLayout()+"_offset",a?{x:a.x,y:a.y}:null),this},setVertexIn:function(a){this._vertexIn=a},setVertexOut:function(a){this._vertexOut=a},getVertexIn:function(){return this._vertexIn||new kity.Point},getVertexOut:function(){return this._vertexOut||new kity.Point},getLayoutVertexIn:function(){return this.getGlobalLayoutTransform().transformPoint(this.getVertexIn())},getLayoutVertexOut:function(){return this.getGlobalLayoutTransform().transformPoint(this.getVertexOut())},getLayoutRoot:function(){return this.isLayoutRoot()?this:this.parent.getLayoutRoot()},isLayoutRoot:function(){return this.getData("layout")||this.isRoot()},layout:function(a,b){return a&&("inherit"==a?this.setData("layout"):this.setData("layout",a)),this.getMinder().layout(b),this}}),kity.extendClass(Minder,{layout:function(a){function b(a){a.isExpanded()&&a.children.forEach(function(a){b(a)});var c=a.getLayoutInstance();c.doLayout(a)}return this.getRoot().traverse(function(a){a.setLayoutTransform(null)}),b(this.getRoot()),this.applyLayoutResult(this.getRoot(),a),this.fire("layout")},refresh:function(a){return this.getRoot().renderTree(),this.layout(a).fire("contentchange").fire("interactchange"),this},applyLayoutResult:function(a,b){function c(){--g||f.fire("layoutallfinish")}function d(a,b){a.getRenderContainer().setMatrix(a._lastLayoutTransform=b),f.fire("layoutapply",{node:a,matrix:b})}function e(a,g){var h=a.getLayoutTransform().merge(g),i=a._lastLayoutTransform||new kity.Matrix,j=a.getLayoutOffset();h.translate(j.x,j.y),h.m.e=Math.round(h.m.e),h.m.f=Math.round(h.m.f),a._layoutTimeline&&(a._layoutTimeline.stop(),a._layoutTimeline=null),b?a._layoutTimeline=new kity.Animator(i,h,d).start(a,b+300,"ease").on("finish",function(){kity.Timeline.requestFrame(function(){d(a,h),f.fire("layoutfinish",{node:a,matrix:h}),c()})}):(d(a,h),f.fire("layoutfinish",{node:a,matrix:h}),c());for(var k=0;k<a.children.length;k++)e(a.children[k],h)}a=a||this.getRoot();var f=this,g=a.getComplex();return g>300&&(b=0),e(a,a.parent?a.parent.getGlobalLayoutTransform():new kity.Matrix),this}});var Layout=kity.createClass("Layout",{doLayout:function(){throw new Error("Not Implement: Layout.doLayout()")},getBranchBox:function(a){var b,c,d,e,f={x:0,y:0,height:0,width:0},g=KityMinder.Geometry;for(b=0;b<a.length;b++)c=a[b],d=c.getLayoutTransform(),e=c.getContentBox(),f=g.mergeBox(f,d.transformBox(e));return f},getTreeBox:function(a){var b,c,d,e,f=KityMinder.Geometry,g={x:0,y:0,height:0,width:0};for(a instanceof Array||(a=[a]),b=0;b<a.length;b++)c=a[b],d=c.getLayoutTransform(),e=c.getContentBox(),c.children.length&&(e=f.mergeBox(e,this.getTreeBox(c.children))),g=f.mergeBox(g,d.transformBox(e));return g},getOrderHint:function(){return[]}});utils.extend(KityMinder,{_connectProviders:{},_defaultConnectProvider:function(a,b,c){c.setPathData(["M",b.getLayoutPoint(),"L",a.getLayoutPoint()])},registerConnectProvider:function(a,b){KityMinder._connectProviders[a]=b},getConnectProvider:function(a){return KityMinder._connectProviders[a]||KityMinder._defaultConnectProvider}}),kity.extendClass(Minder,{createConnect:function(a){if(!a.isRoot()){var b=new kity.Path;a._connection=b,this._connectContainer||(this._connectContainer=(new kity.Group).setId(KityMinder.uuid("minder_connect_group")),this.getRenderContainer().prependShape(this._connectContainer)),this._connectContainer.addShape(b),this.updateConnect(a)}},removeConnect:function(a){var b=this;a.traverse(function(a){b._connectContainer.removeShape(a._connection)})},updateConnect:function(a){var b=a._connection,c=a.parent;if(c){if(c.isCollapsed())return void b.setVisible(!1);b.setVisible(!0);var d=KityMinder.getConnectProvider(c.getLayout()),e=a.getStyle("connect-color")||"white",f=a.getStyle("connect-width")||2;b.stroke(e,f),d(a,c,b,f,e)}}}),KityMinder.registerModule("Connect",{events:{nodeattach:function(a){this.createConnect(a.node)},nodedetach:function(a){this.removeConnect(a.node)},"layoutapply layoutfinish noderender":function(a){this.updateConnect(a.node)}}});var Renderer=KityMinder.Renderer=kity.createClass("Renderer",{constructor:function(a){this.node=a},create:function(){throw new Error("Not implement: Renderer.create()")},shouldRender:function(){return!0},update:function(){throw new Error("Not implement: Renderer.update()")},getRenderShape:function(){return this._renderShape||null},setRenderShape:function(a){this._renderShape=a}});kity.extendClass(Minder,function(){function a(a,b){var c=[];["center","left","right","top","bottom","outline","outside"].forEach(function(a){var d="before"+a,e="after"+a;b[d]&&(c=c.concat(b[d])),b[a]&&(c=c.concat(b[a])),b[e]&&(c=c.concat(b[e]))}),a._renderers=c.map(function(b){return new b(a)})}return{renderNodeBatch:function(b){var c,d,e,f,g=this._rendererClasses,h=[],i=0;if(b.length){for(d=0;d<b.length;d++)f=b[d],f._renderers||a(f,g),f._contentBox=new kity.Box,this.fire("beforerender",{node:f});for(i=b[0]._renderers.length,c=0;i>c;c++){for(d=0;d<b.length;d++)"function"==typeof h[d]&&(h[d]=h[d]()),h[d]instanceof kity.Box||(h[d]=new kity.Box(h[d]));for(d=0;d<b.length;d++)f=b[d],e=f._renderers[c],h[d]&&(f._contentBox=f._contentBox.merge(h[d])),e.shouldRender(f)?(e.getRenderShape()||(e.setRenderShape(e.create(f)),e.bringToBack?f.getRenderContainer().prependShape(e.getRenderShape()):f.getRenderContainer().appendShape(e.getRenderShape())),e.getRenderShape().setVisible(!0),h[d]=e.update(e.getRenderShape(),f,f._contentBox)):e.getRenderShape()&&(e.getRenderShape().setVisible(!1),h[d]=null)}for(d=0;d<b.length;d++)this.fire("noderender",{node:b[d]})}},renderNode:function(b){var c,d=this._rendererClasses,e=KityMinder.Geometry;b._renderers||a(b,d),this.fire("beforerender",{node:b}),b._contentBox=e.wrapBox({left:0,right:0,top:0,bottom:0}),b._renderers.forEach(function(a){a.shouldRender(b)?(a.getRenderShape()||(a.setRenderShape(a.create(b)),a.bringToBack?b.getRenderContainer().prependShape(a.getRenderShape()):b.getRenderContainer().appendShape(a.getRenderShape())),a.getRenderShape().setVisible(!0),c=a.update(a.getRenderShape(),b,b._contentBox),"function"==typeof c&&(c=c()),c&&(b._contentBox=e.mergeBox(b._contentBox,c))):a.getRenderShape()&&a.getRenderShape().setVisible(!1)}),this.fire("noderender",{node:b})}}}()),kity.extendClass(MinderNode,{render:function(){return this.attached?(this.getMinder().renderNode(this),this):void 0},renderTree:function(){if(this.attached){var a=[];return this.traverse(function(b){a.push(b)}),this.getMinder().renderNodeBatch(a),this}},getRenderer:function(a){for(var b=this._renderers,c=0;c<b.length;c++)if(b[c].getType()==a)return b[c];return null},getContentBox:function(){return this.parent&&this.parent.isCollapsed()?new kity.Box:this._contentBox||new kity.Box}});var cssLikeValueMatcher={left:function(a){return 3 in a&&a[3]||1 in a&&a[1]||a[0]},right:function(a){return 1 in a&&a[1]||a[0]},top:function(a){return a[0]},bottom:function(a){return 2 in a&&a[2]||a[0]}};Utils.extend(KityMinder,{_themes:{},registerTheme:function(a,b){KityMinder._themes[a]=b},getThemeList:function(){return KityMinder._themes}}),kity.extendClass(Minder,{useTheme:function(a){return this.setTheme(a),this.refresh(800),!0},setTheme:function(a){this._theme=a||null,this.getRenderTarget().style.background=this.getStyle("background")},getTheme:function(){return this._theme||this.getOptions("defaultTheme")},getThemeItems:function(a){this.getTheme(a);return KityMinder._themes[this.getTheme(a)]},getStyle:function(a,b){var c,d,e,f,g=this.getThemeItems(b);if(a in g)return g[a];if(c=a.split("-"),c.length<2)return null;if(d=c.pop(),a=c.join("-"),a in g){if(e=g[a],Utils.isArray(e)&&(f=cssLikeValueMatcher[d]))return f(e);if(!isNaN(e))return e}return null},getNodeStyle:function(a,b){var c=this.getStyle(a.getType()+"-"+b,a);return null!==c?c:this.getStyle(b,a)}}),kity.extendClass(MinderNode,{getStyle:function(a){return this.getMinder().getNodeStyle(this,a)}}),KityMinder.registerModule("Theme",{defaultOptions:{defaultTheme:"fresh-blue"},commands:{theme:kity.createClass("ThemeCommand",{base:Command,execute:function(a,b){return a.useTheme(b)},queryValue:function(a){return a.getTheme()||"default"}})}}),utils.extend(KityMinder,{_templates:{},registerTemplate:function(a,b){KityMinder._templates[a]=b},getTemplateList:function(){return KityMinder._templates}}),KityMinder.registerTemplate("default",{}),kity.extendClass(Minder,function(){var a=Minder.prototype.getTheme;return{useTemplate:function(a,b){this.setTemplate(a),this.refresh(b||800)},getTemplate:function(){return this._template||null},setTemplate:function(a){this._template=a||null},getTemplateSupports:function(){return KityMinder._templates[this._template]||null},getTheme:function(b){var c=this.getTemplateSupports();return c&&c.getTheme?c.getTheme(b):a.call(this,b)}}}()),kity.extendClass(MinderNode,function(){var a=MinderNode.prototype.getLayout;return{getLayout:function(){var b=this.getMinder().getTemplateSupports();return b&&b.getLayout?b.getLayout(this):a.call(this)}}}()),KityMinder.registerModule("TemplateModule",{commands:{template:kity.createClass("TemplateCommand",{base:Command,execute:function(a,b){a.useTemplate(b),a.execCommand("camera")
},queryValue:function(a){return a.getTemplate()||"default"}})}}),KityMinder.registerLayout("default",kity.createClass({base:Layout,doLayout:function(a){var b=this;a.isLayoutRoot()?this.doLayoutRoot(a):this.arrange(a,a.children,b.getSide(a))},getSide:function(a){for(;!a.parent.isLayoutRoot();)a=a.parent;var b=a.getIndex(),c=a.parent.children.length;return c/2>b?"right":"left"},doLayoutRoot:function(a){var b=a.getChildren(),c={left:[],right:[]},d=this;b.forEach(function(a){c[d.getSide(a)].push(a)}),this.arrange(a,c.left,"left"),this.arrange(a,c.right,"right")},arrange:function(a,b,c){if(b.length){var d,e,f,g,h,i,j,k=this,l=0,m=b.map(function(a,b,c){var d=k.getTreeBox([a]);return l+=d.height,b>0&&(l+=c[b-1].getStyle("margin-bottom"),l+=a.getStyle("margin-top")),d}),n=a.getContentBox();for(f=-l/2,"left"!=c?(a.setVertexOut(new kity.Point(n.right,n.cy)),a.setLayoutVector(new kity.Vector(1,0))):(a.setVertexOut(new kity.Point(n.left,n.cy)),a.setLayoutVector(new kity.Vector(-1,0))),d=0;d<b.length;d++)g=b[d],h=m[d],i=g.getContentBox(),i.height&&("right"==c?(e=n.right-i.left,e+=a.getStyle("margin-right")+g.getStyle("margin-left")):(e=n.left-i.right,e-=a.getStyle("margin-left")+g.getStyle("margin-right")),d>0&&(f+=b[d].getStyle("margin-top")),f-=h.top,j=(new kity.Matrix).translate(e,f),g.setLayoutTransform(j),f+=h.bottom+g.getStyle("margin-bottom"));if(a.isRoot()){var o=this.getBranchBox(b),p=o.cy-n.cy;b.forEach(function(a){a.getLayoutTransform().translate(0,-p)})}}},getOrderHint:function(a){var b=[],c=a.getLayoutBox(),d=5;return b.push({type:"up",node:a,area:{x:c.x,y:c.top-a.getStyle("margin-top")-d,width:c.width,height:a.getStyle("margin-top")},path:["M",c.x,c.top-d,"L",c.right,c.top-d]}),b.push({type:"down",node:a,area:{x:c.x,y:c.bottom+d,width:c.width,height:a.getStyle("margin-bottom")},path:["M",c.x,c.bottom+d,"L",c.right,c.bottom+d]}),b}}));var connectMarker=(new kity.Marker).pipe(function(){var a=7,b=new kity.Circle(a-1);this.addShape(b),this.setRef(a-1,0).setViewBox(-a,-a,a+a,a+a).setWidth(a).setHeight(a),this.dot=b,this.node.setAttribute("markerUnits","userSpaceOnUse")});KityMinder.registerConnectProvider("default",function(a,b,c,d,e){var f,g,h,i=a.getLayoutBox(),j=b.getLayoutBox(),k=Math.abs,l=[],m=i.x>j.x?"right":"left";switch(a.getMinder().getPaper().addResource(connectMarker),a.getType()){case"main":f=new kity.Point(j.cx,j.cy),g="left"==m?new kity.Point(i.right+2,i.cy):new kity.Point(i.left-2,i.cy),h=kity.Vector.fromPoints(f,g),l.push("M",f),l.push("A",k(h.x),k(h.y),0,0,h.x*h.y>0?0:1,g),c.setMarker(connectMarker),connectMarker.dot.fill(e);break;case"sub":var n,o,p,q,r=(a.getStyle("connect-radius"),i.bottom+3),s="sub"==b.getType()?j.bottom+3:j.cy;"right"==m?(n=new kity.Point(j.right+10,s),o=new kity.Point(i.left,r),p=new kity.Point(i.right+10,r)):(n=new kity.Point(j.left-10,s),o=new kity.Point(i.right,r),p=new kity.Point(i.left-10,r)),q=(n.x+o.x)/2,d%2===0&&(n.y+=.5,o.y+=.5,p.y+=.5),l.push("M",n),l.push("C",q,n.y,q,o.y,o),l.push("L",p),c.setMarker(null)}c.setPathData(l)}),window.layoutSwitch=!0,KityMinder.registerLayout("bottom",kity.createClass({base:Layout,doLayout:function(a){var b=a.getChildren();if(!b.length)return!1;var c,d,e,f,g,h,i,j,k=a.getContentBox();for(d=e=k.left,c=0;c<b.length;c++)g=b[c],i=g.getContentBox(),h=this.getTreeBox(g),j=new kity.Matrix,i.width&&(c>0&&(e+=g.getStyle("margin-left")),e-=h.left,j.translate(e,0),e+=h.right,c<b.length-1&&(e+=g.getStyle("margin-right")),f=k.bottom-h.top+a.getStyle("margin-bottom")+g.getStyle("margin-top"),j.translate(0,f),g.setLayoutTransform(j),g.setVertexIn(new kity.Point(i.cx,i.top)));a.setLayoutVector(new kity.Vector(0,1)),a.setVertexOut(new kity.Point(k.cx,k.bottom));var l=(e-d-k.width)/2;b.forEach(function(a){a.getLayoutTransform().translate(-l,0)})},getOrderHint:function(a){var b=[],c=a.getLayoutBox(),d=3;return b.push({type:"up",node:a,area:{x:c.left-a.getStyle("margin-left")-d,y:c.top,width:a.getStyle("margin-left"),height:c.height},path:["M",c.left-d,c.top,"L",c.left-d,c.bottom]}),b.push({type:"down",node:a,area:{x:c.right+d,y:c.top,width:a.getStyle("margin-right"),height:c.height},path:["M",c.right+d,c.top,"L",c.right+d,c.bottom]}),b}})),KityMinder.registerConnectProvider("bottom",function(a,b,c){var d=b.getLayoutVertexOut(),e=a.getLayoutVertexIn(),f=[],g=Math.round;f.push("M",new kity.Point(g(d.x),d.y)),f.push("L",new kity.Point(g(d.x),d.y+b.getStyle("margin-bottom"))),f.push("L",new kity.Point(g(e.x),d.y+b.getStyle("margin-bottom"))),f.push("L",new kity.Point(g(e.x),e.y)),c.setMarker(null),c.setPathData(f)}),window.layoutSwitch=!0,KityMinder.registerLayout("filetree",kity.createClass({base:Layout,doLayout:function(a){a.isLayoutRoot()?this.doLayoutRoot(a):this.arrange(a)},doLayoutRoot:function(a){this.arrange(a)},arrange:function(a){var b=a.getChildren(),c=this;if(!b.length)return!1;var d,e,f,g,h,i,j=b.map(function(a){var b=c.getTreeBox([a]);return b}),k=a.getContentBox(),l=new kity.Matrix;for(a.setVertexOut(new kity.Point(0,k.bottom)),a.setLayoutVector(new kity.Vector(0,1)),f=k.bottom+a.getStyle("margin-bottom"),d=0;d<b.length;d++)g=b[d],h=j[d],i=g.getContentBox(),e=g.getStyle("margin-left")-i.left,i.width&&(f+=g.getStyle("margin-top"),f-=h.top,l=(new kity.Matrix).translate(e,f),g.setLayoutTransform(l),f+=h.bottom+g.getStyle("margin-bottom"))},getOrderHint:function(a){var b=[],c=a.getLayoutBox(),d=a.getLevel()>1?3:5;return b.push({type:"up",node:a,area:{x:c.x,y:c.top-a.getStyle("margin-top")-d,width:c.width,height:a.getStyle("margin-top")},path:["M",c.x,c.top-d,"L",c.right,c.top-d]}),b.push({type:"down",node:a,area:{x:c.x,y:c.bottom+d,width:c.width,height:a.getStyle("margin-bottom")},path:["M",c.x,c.bottom+d,"L",c.right,c.bottom+d]}),b}})),KityMinder.registerConnectProvider("filetree",function(a,b,c){var d=a.getLayoutBox(),e=b.getLayoutBox(),f=[],g=b.getLayoutPoint().x,h=Math.round;f.push("M",new kity.Point(h(g),h(e.bottom))),f.push("L",new kity.Point(h(g),h(d.cy))),f.push("L",new kity.Point(h(d.left),h(d.cy))),c.setPathData(f)}),KityMinder.registerTheme("classic",{background:"#3A4144 url(ui/theme/default/images/grid.png) repeat","root-color":"#430","root-background":"#e9df98","root-stroke":"#e9df98","root-font-size":24,"root-padding":[15,25],"root-margin":[30,100],"root-radius":30,"root-space":10,"root-shadow":"rgba(0, 0, 0, .25)","main-color":"#333","main-background":"#a4c5c0","main-stroke":"#a4c5c0","main-font-size":16,"main-padding":[6,20],"main-margin":20,"main-radius":10,"main-space":5,"main-shadow":"rgba(0, 0, 0, .25)","sub-color":"white","sub-background":"none","sub-stroke":"none","sub-font-size":12,"sub-padding":[5,10],"sub-margin":[15,20],"sub-tree-margin":30,"sub-radius":5,"sub-space":5,"connect-color":"white","connect-width":2,"connect-radius":5,"selected-background":"rgb(254, 219, 0)","selected-stroke":"rgb(254, 219, 0)","selected-color":"black","marquee-background":"rgba(255,255,255,.3)","marquee-stroke":"white","drop-hint-color":"yellow","sub-drop-hint-width":2,"main-drop-hint-width":4,"root-drop-hint-width":4,"order-hint-area-color":"rgba(0, 255, 0, .5)","order-hint-path-color":"#0f0","order-hint-path-width":1,"text-selection-color":"rgb(27,171,255)"}),KityMinder.registerTheme("snow",{background:"#3A4144 url(ui/theme/default/images/grid.png) repeat","root-color":"#430","root-background":"#e9df98","root-stroke":"#e9df98","root-font-size":24,"root-padding":[15,25],"root-margin":30,"root-radius":5,"root-space":10,"root-shadow":"rgba(0, 0, 0, .25)","main-color":"#333","main-background":"#a4c5c0","main-stroke":"#a4c5c0","main-font-size":16,"main-padding":[6,20],"main-margin":[20,40],"main-radius":5,"main-space":5,"main-shadow":"rgba(0, 0, 0, .25)","sub-color":"black","sub-background":"white","sub-stroke":"white","sub-font-size":12,"sub-padding":[5,10],"sub-margin":[10,20],"sub-radius":5,"sub-space":5,"connect-color":"white","connect-width":2,"connect-radius":5,"selected-background":"rgb(254, 219, 0)","selected-stroke":"rgb(254, 219, 0)","marquee-background":"rgba(255,255,255,.3)","marquee-stroke":"white","drop-hint-color":"yellow","drop-hint-width":4,"order-hint-area-color":"rgba(0, 255, 0, .5)","order-hint-path-color":"#0f0","order-hint-path-width":1,"text-selection-color":"rgb(27,171,255)"}),function(){function a(a,b,c){return kity.Color.createHSL(a,b,c)}function b(b){return{background:"#fbfbfb","root-color":"white","root-background":a(b,37,60),"root-stroke":a(b,37,60),"root-font-size":16,"root-padding":[12,24],"root-margin":[30,100],"root-radius":5,"root-space":10,"main-color":"black","main-background":a(b,33,95),"main-stroke":a(b,37,60),"main-stroke-width":1,"main-font-size":14,"main-padding":[6,20],"main-margin":20,"main-radius":3,"main-space":5,"sub-color":"black","sub-background":"none","sub-stroke":"none","sub-font-size":12,"sub-padding":[5,10],"sub-margin":[15,20],"sub-tree-margin":30,"sub-radius":5,"sub-space":5,"connect-color":a(b,37,60),"connect-width":1,"connect-radius":5,"selected-stroke":a(b,26,30),"selected-stroke-width":"3","marquee-background":a(b,100,80).set("a",.1),"marquee-stroke":a(b,37,60),"drop-hint-color":a(b,26,35),"drop-hint-width":5,"order-hint-area-color":a(b,100,30).set("a",.5),"order-hint-path-color":a(b,100,25),"order-hint-path-width":1,"text-selection-color":a(b,100,20)}}var c={red:0,soil:25,green:122,blue:204,purple:246,pink:334};for(var d in c)KityMinder.registerTheme("fresh-"+d,b(c[d]))}(),KityMinder.registerTemplate("structure",{getLayout:function(){return"bottom"}}),KityMinder.registerTemplate("filetree",{getLayout:function(a){return a.getData("layout")?a.getData("layout"):a.isRoot()?"bottom":"filetree"}});var AppendChildCommand=kity.createClass("AppendChildCommand",{base:Command,execute:function(a,b){var c=a.getSelectedNode();if(!c)return null;c.expand();var d=a.createNode(b,c);a.select(d,!0),d.render(),d._lastLayoutTransform=c._lastLayoutTransform,a.layout(300)},queryState:function(a){var b=a.getSelectedNode();return b?0:-1}}),AppendSiblingCommand=kity.createClass("AppendSiblingCommand",{base:Command,execute:function(a,b){var c=a.getSelectedNode(),d=c.parent;if(!d)return a.execCommand("AppendChildNode",b);var e=a.createNode(b,d,c.getIndex()+1);a.select(e,!0),e.render(),e._lastLayoutTransform=c._lastLayoutTransform,a.layout(300)},queryState:function(a){var b=a.getSelectedNode();return b?0:-1}}),RemoveNodeCommand=kity.createClass("RemoverNodeCommand",{base:Command,execute:function(a){var b=a.getSelectedNodes(),c=MinderNode.getCommonAncestor.apply(null,b);b.forEach(function(b){b.isRoot()||a.removeNode(b)}),a.select(c||a.getRoot(),!0),a.layout(300)},queryState:function(a){var b=a.getSelectedNode();return b?0:-1}}),EditNodeCommand=kity.createClass("EditNodeCommand",{base:Command,execute:function(a){var b=a.getSelectedNode();return b?(a.select(b,!0),void a.textEditNode(b)):null},queryState:function(a){var b=a.getSelectedNode();return b?0:-1},isNeedUndo:function(){return!1}});KityMinder.registerModule("NodeModule",function(){return{commands:{AppendChildNode:AppendChildCommand,AppendSiblingNode:AppendSiblingCommand,RemoveNode:RemoveNodeCommand,EditNode:EditNodeCommand},contextmenu:[{label:this.getLang("node.appendsiblingnode"),exec:function(){this.execCommand("AppendSiblingNode",this.getLang("topic"))},cmdName:"appendsiblingnode"},{label:this.getLang("node.appendchildnode"),exec:function(){this.execCommand("AppendChildNode",this.getLang("topic"))},cmdName:"appendchildnode"},{label:this.getLang("node.editnode"),exec:function(){this.execCommand("EditNode")},cmdName:"editnode"},{label:this.getLang("node.removenode"),cmdName:"RemoveNode"},{divider:1}]}});var TextRenderer=KityMinder.TextRenderer=kity.createClass("TextRenderer",{base:Renderer,create:function(){return(new kity.Text).setId(KityMinder.uuid("node_text")).setVerticalAlign("middle").setAttr("text-rendering","inherit")},update:function(a,b){this.setTextStyle(b,a.setContent(b.getText()));var c=a.getBoundaryBox(),d=Math.round;return kity.Browser.ie&&(c.y+=1),function(){return new kity.Box(d(c.x),d(c.y),d(c.width),d(c.height))}},setTextStyle:function(a,b){var c=TextRenderer._styleHooks;c.forEach(function(c){c(a,b)})}});utils.extend(TextRenderer,{_styleHooks:[],registerStyleHook:function(a){TextRenderer._styleHooks.push(a)}}),kity.extendClass(MinderNode,{getTextShape:function(){return this.getRenderer("TextRenderer").getRenderShape()}}),KityMinder.registerModule("text",{renderers:{center:TextRenderer}}),KityMinder.registerModule("Expand",function(){function a(a,b){return function(d,e,f,g){var h,i,j;for(d.setData(c,e),g=g||1,h=d.getChildren(),j=0;j<h.length;j++)i=h[j],a>=g?f(i,e,f,g+1):b&&b(i,e,f,g+1)}}function b(a,b,c){c=c||f.KEEP_STATE,c(a,b,c),a.renderTree(),a.getMinder().layout(100)}var c="expandState",d="expand",e="collapse",f=MinderNode.EXPAND_POLICY={KEEP_STATE:function(a,b){a.setData(c,b)},generateDeepPolicy:a,DEEP_TO_CHILD:a(2),DEEP_TO_LEAF:a(Number.MAX_VALUE)};kity.extendClass(MinderNode,{expand:function(a){return b(this,d,a),this},collapse:function(a){return b(this,e,a),this},isExpanded:function(){var a=this.getData(c)!==e;return a&&(this.isRoot()||this.parent.isExpanded())},isCollapsed:function(){return!this.isExpanded()}});var g=kity.createClass("ExpandNodeCommand",{base:Command,execute:function(a){var b=a.getRoot().getChildren();b.forEach(function(a){a.expand(f.DEEP_TO_LEAF)})},queryState:function(){return 0}}),h=kity.createClass("CollapseNodeCommand",{base:Command,execute:function(a){var b=a.getRoot().getChildren();b.forEach(function(a){a.collapse()})},queryState:function(){return 0}}),i=kity.createClass("Expander",{base:kity.Group,constructor:function(a){this.callBase(),this.radius=5,this.outline=new kity.Circle(this.radius).stroke("gray").fill("white"),this.sign=(new kity.Path).stroke("black"),this.addShapes([this.outline,this.sign]),this.initEvent(a),this.setId(KityMinder.uuid("node_expander")),this.setStyle("cursor","pointer")},initEvent:function(a){this.on("mousedown",function(b){a.isExpanded()?a.collapse():a.expand(),b.stopPropagation(),b.preventDefault()}),this.on("dblclick click mouseup",function(a){a.stopPropagation(),a.preventDefault()})},setState:function(a){if("hide"==a)return void this.setVisible(!1);this.setVisible(!0);var b=["M",1.5-this.radius,0,"L",this.radius-1.5,0];a==e&&b.push(["M",0,1.5-this.radius,"L",0,this.radius-1.5]),this.sign.setPathData(b)}}),j=kity.createClass("ExpanderRenderer",{base:Renderer,create:function(a){return a.isRoot()?void 0:(this.expander=new i(a),a.getRenderContainer().prependShape(this.expander),a.expanderRenderer=this,this.node=a,this.expander)},shouldRender:function(a){return!a.isRoot()},update:function(a,b){if(b.parent){var d=b.parent.isExpanded();a.setState(d&&b.children.length?b.getData(c):"hide");var e=b.getLayoutVector().normalize(a.radius+b.getStyle("stroke-width")),f=b.getVertexOut().offset(e);this.expander.setTranslate(f)}}});return{commands:{ExpandNode:g,CollapseNode:h},events:{layoutapply:function(a){var b=a.node.getRenderer("ExpanderRenderer");b.getRenderShape()&&b.update(b.getRenderShape(),a.node)},beforerender:function(a){var b=a.node,c=!b.parent||b.parent.isExpanded();b.getRenderContainer().setVisible(c),c||a.stopPropagation()},"normal.keydown":function(a){if("textedit"!=this.getStatus()&&a.originEvent.keyCode==keymap["/"]){var b=this.getSelectedNode();if(!b||b==this.getRoot())return;var c=b.isExpanded();this.getSelectedNodes().forEach(function(a){c?a.collapse():a.expand()}),a.preventDefault(),a.stopPropagationImmediately()}}},renderers:{outside:j}}});var OutlineRenderer=kity.createClass("OutlineRenderer",{base:Renderer,create:function(){var a=(new kity.Rect).setId(KityMinder.uuid("node_outline"));return this.bringToBack=!0,a},update:function(a,b,c){var d=b.getStyle("padding-left"),e=b.getStyle("padding-right"),f=b.getStyle("padding-top"),g=b.getStyle("padding-bottom"),h={x:c.x-d,y:c.y-f,width:c.width+d+e,height:c.height+f+g},i=b.isSelected()?"selected-":"";return a.setPosition(h.x,h.y).setSize(h.width,h.height).setRadius(b.getStyle("radius")).fill(b.getData("background")||b.getStyle(i+"background")||b.getStyle("background")).stroke(b.getStyle(i+"stroke"||b.getStyle("stroke")),b.getStyle(i+"stroke-width")),h}}),ShadowRenderer=kity.createClass("ShadowRenderer",{base:Renderer,create:function(){return this.bringToBack=!0,new kity.Rect},shouldRender:function(a){return a.getStyle("shadow")},update:function(a,b,c){a.setPosition(c.x+4,c.y+5).setSize(c.width,c.height).fill(b.getStyle("shadow")).setRadius(b.getStyle("radius"))}}),wireframeOption=/wire/.test(window.location.href),WireframeRenderer=kity.createClass("WireframeRenderer",{base:Renderer,create:function(){var a=new kity.Group,b=this.oxy=(new kity.Path).stroke("#f6f").setPathData("M0,-50L0,50M-50,0L50,0"),c=this.wireframe=(new kity.Rect).stroke("lightgreen");return a.addShapes([b,c])},shouldRender:function(){return wireframeOption},update:function(a,b,c){this.wireframe.setPosition(c.x,c.y).setSize(c.width,c.height)}});KityMinder.registerModule("OutlineModule",function(){return{renderers:{outline:OutlineRenderer,outside:[ShadowRenderer,WireframeRenderer]}}}),KityMinder.Geometry=function(){function a(a){return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a.cx=a.x+a.width/2,a.cy=a.y+a.height/2,a}function b(a){"x"in a&&(a.left=a.x,a.right=a.x+a.width,a.top=a.y,a.bottom=a.y+a.height)}var c={},d=Math.min,e=Math.max,f=(Math.abs,Object.prototype.hasOwnProperty);return c.isNumberInRange=function(a,b){return a>b[0]&&a<b[1]},c.getDistance=function(a,b){return kity.Vector.fromPoints(a,b).length()},c.wrapBox=a,c.getBox=function(b,c){return a({left:d(b.x,c.x),right:e(b.x,c.x),top:d(b.y,c.y),bottom:e(b.y,c.y)})},c.mergeBox=function(c,f){return b(c),b(f),a({left:d(c.left,f.left),right:e(c.right,f.right),top:d(c.top,f.top),bottom:e(c.bottom,f.bottom)})},c.getBoxRange=function(a){return{x:[a.left,a.right],y:[a.top,a.bottom]}},c.getBoxVertex=function(a){return{leftTop:{x:a.left,y:a.top},rightTop:{x:a.right,y:a.top},leftBottom:{x:a.left,y:a.bottom},rightBottom:{x:a.right,y:a.bottom}}},c.isPointInsideBox=function(a,d){b(d);var e=c.getBoxRange(d);return c.isNumberInRange(a.x,e.x)&&c.isNumberInRange(a.y,e.y)},c.getIntersectBox=function(c,f){b(c),b(f);var g=e(c.left,f.left),h=e(c.top,f.top),i=d(c.right,f.right),j=d(c.bottom,f.bottom);return i>g&&j>h?a({left:g,right:i,top:h,bottom:j}):null},c.snapToSharp=function(a){return utils.isNumber(a)?(0|a)+.5:utils.isArray(a)?a.map(c.snapToSharp):(["x","y","left","top","right","bottom"].forEach(function(b){f.call(a,b)&&(a[b]=c.snapToSharp(a[b]))}),a)},c.expandBox=function(b,c,d){return void 0===d&&(d=c),a({left:b.left-c,top:b.top-d,right:b.right+c,bottom:b.bottom+d})},c}(),KityMinder.registerModule("HistoryModule",function(){var a=this,b=kity.createClass("Scene",{constructor:function(a,b){this.data=a.clone(),this.inputStatus=b},getData:function(){return this.data},cloneData:function(){return this.getData().clone()},equals:function(a){return this.getData().equals(a.getData())},isInputStatus:function(){return this.inputStatus},setInputStatus:function(a){this.inputStatus=a}}),c=kity.createClass("HistoryManager",{constructor:function(a){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.km=a},undo:function(){if(this.hasUndo){var a=this.list[this.index];if(a&&a.isInputStatus())return this.saveScene(),this.restore(--this.index),void a.setInputStatus(!1);if(1==this.list.length)return void this.restore(0);if(!this.list[this.index-1]&&1==this.list.length)return void this.reset();for(;this.list[this.index].equals(this.list[this.index-1]);)if(this.index--,0===this.index)return this.restore(0);this.restore(--this.index)}},redo:function(){if(this.hasRedo){for(;this.list[this.index].equals(this.list[this.index+1]);)if(this.index++,this.index==this.list.length-1)return this.restore(this.index);this.restore(++this.index)}},partialRenewal:function(b){function c(a,b){return a.getText()!=b.getText()?!1:utils.compareObject(a.getData(),b.getData())===!1?!1:utils.compareObject(a.getTmpData(),b.getTmpData())===!1?!1:!0}function d(b,c){c.isSelected()&&f.push(c),a.appendNode(c,b),c._lastLayoutTransform=b._lastLayoutTransform,c.render();for(var e,g=utils.cloneArr(c.children),h=0;e=g[h++];)d(c,e)}function e(b,g){c(b,g)===!1&&b.setValue(g),b.render(),b.isSelected()&&f.push(b);for(var h,i,j=0,k=0;h=b.children[j],i=g.children[k],h||i;j++,k++)h&&!i?(j--,a.removeNode(h)):!h&&i?(k--,d(b,i)):e(h,i)}var f=[];e(a.getRoot(),b),a.layout(200),a.select(f,!0),f=[]},restore:function(a){a=void 0===a?this.index:a;var b=this.list[a];this.partialRenewal(b.cloneData()),this.update(),this.km.fire("restoreScene"),this.km.fire("contentChange")},getScene:function(a){return new b(this.km.getRoot(),a)},saveScene:function(a){var b=this.getScene(a),c=this.list[this.index];return c&&c.equals(b)?void(a&&(c.setInputStatus(!0),this.update())):(this.list=this.list.slice(0,this.index+1),this.list.push(b),this.list.length>this.km.getOptions("maxUndoCount")&&this.list.shift(),this.index=this.list.length-1,void this.update())},update:function(){this.hasRedo=!!this.list[this.index+1],this.hasUndo=!!this.list[this.index-1];var a=this.list[this.index];a&&a.isInputStatus()&&(this.hasUndo=!0)},reset:function(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1}});return this.historyManager=new c(this),{defaultOptions:{maxUndoCount:20,maxInputCount:20},commands:{undo:kity.createClass("UndoCommand",{base:Command,execute:function(a){a.historyManager.undo()},queryState:function(a){return a.historyManager.hasUndo?0:-1},isNeedUndo:function(){return!1}}),redo:kity.createClass("RedoCommand",{base:Command,execute:function(a){a.historyManager.redo()},queryState:function(a){return a.historyManager.hasRedo?0:-1},isNeedUndo:function(){return!1}})},addShortcutKeys:{Undo:"ctrl+z",Redo:"ctrl+y"},events:{saveScene:function(a){this.historyManager.saveScene(a.inputStatus)},"import":function(){this.historyManager.reset()}}}}),KityMinder.registerModule("ProgressModule",function(){var a="progress",b=kity.createClass("ProgressIcon",{base:kity.Group,constructor:function(a){this.callBase(),this.setSize(20),this.create(),this.setValue(a),this.setId(KityMinder.uuid("node_progress"))},setSize:function(a){this.width=this.height=a},create:function(){var a=new kity.Circle(8).stroke("#29A6BD",2).fill("white"),b=new kity.Pie(6,0,-90).fill("#29A6BD"),c=(new kity.Path).getDrawer().moveTo(-3,-1).lineTo(-1,2).lineTo(3,-3).getPath().stroke("white",2).setVisible(!1);this.addShapes([a,b,c]),this.circle=a,this.pie=b,this.check=c},setValue:function(a){this.pie.setAngle(360*(a-1)/8),this.check.setVisible(9==a)}}),c=kity.createClass("ProgressCommand",{base:Command,execute:function(b,c){for(var d=b.getSelectedNodes(),e=0;e<d.length;e++)d[e].setData(a,c||null).render();b.layout()},queryValue:function(b){for(var c,d=b.getSelectedNodes(),e=0;e<d.length&&!(c=d[e].getData(a));e++);return c||null},queryState:function(a){return a.getSelectedNodes().length?0:-1}});return{commands:{progress:c},renderers:{left:kity.createClass("ProgressRenderer",{base:KityMinder.Renderer,create:function(){return new b},shouldRender:function(b){return b.getData(a)},update:function(b,c,d){var e,f,g=c.getData(a),h=c.getStyle("space-left");return b.setValue(g),e=d.left-b.width-h,f=-b.height/2,b.setTranslate(e+b.width/2,f+b.height/2),{x:e,y:f,width:b.width,height:b.height}}})}}}),KityMinder.registerModule("PriorityModule",function(){var a=["","#A92E24","#29A6BD","#1E8D54","#eb6100","#876DDA","#828282","#828282","#828282","#828282"],b="priority",c=kity.createClass("PriorityIcon",{base:kity.Group,constructor:function(){this.callBase(),this.setSize(20),this.create(),this.setId(KityMinder.uuid("node_priority"))},setSize:function(a){this.width=this.height=a},create:function(){var a,b;a=(new kity.Rect).setRadius(3).setPosition(.5,.5).setSize(this.width,this.height),b=(new kity.Text).setX(this.width/2+.5).setY(this.height/2-.5).setTextAnchor("middle").setVerticalAlign("middle").setFontSize(12).fill("white"),b.mark="hello",this.addShapes([a,b]),this.bg=a,this.number=b},setValue:function(b){var c=this.bg,d=this.number;a[b]&&(c.fill(a[b]),d.setContent(b))}}),d=kity.createClass("SetPriorityCommand",{base:Command,execute:function(a,c){for(var d=a.getSelectedNodes(),e=0;e<d.length;e++)d[e].setData(b,c||null).render();a.layout()},queryValue:function(a){for(var c,d=a.getSelectedNodes(),e=0;e<d.length&&!(c=d[e].getData(b));e++);return c||null},queryState:function(a){return a.getSelectedNodes().length?0:-1}});return{commands:{priority:d},renderers:{left:kity.createClass("PriorityRenderer",{base:KityMinder.Renderer,create:function(){return new c},shouldRender:function(a){return a.getData(b)},update:function(a,c,d){var e,f,g=c.getData(b),h=c.getStyle("space-left");return a.setValue(g),e=d.left-a.width-h,f=-a.height/2,a.setTranslate(e,f),{x:e,y:f,width:a.width,height:a.height}}})}}}),KityMinder.registerModule("image",function(){function a(a,b){var c=document.createElement("img");c.onload=function(){b(c.width,c.height)},c.onerror=function(){b(null)},c.src=a}function b(a,b,c,d){var e=a/b,f=c/d;return a>c&&e>f?(a=c,b=a/e):b>d&&(b=d,a=b*e),{width:0|a,height:0|b}}var c=kity.createClass("ImageCommand",{base:Command,execute:function(c,d){var e=c.getSelectedNodes();a(d,function(a,f){a&&(utils.each(e,function(e,g){var h=b(a,f,c.getOptions("maxImageWidth"),c.getOptions("maxImageHeight"));g.setData("image",d),g.setData("imageSize",h),g.render()}),c.fire("saveScene"),c.layout(300))})},queryState:function(a){var b=a.getSelectedNodes(),c=0;return 0===b.length?-1:(utils.each(b,function(a,b){return b&&b.getData("image")?(c=0,!1):void 0}),c)},queryValue:function(a){var b=a.getSelectedNode();return b.getData("image")}}),d=kity.createClass("RemoveImageCommand",{base:Command,execute:function(a){var b=a.getSelectedNodes();utils.each(b,function(a,b){b.setData("image").render()}),a.layout(300)},queryState:function(a){var b=a.getSelectedNodes();if(0===b.length)return-1;var c=!1;return utils.each(b,function(a,b){return b.getData("image")?(c=!0,!1):void 0}),c?0:-1}}),e=kity.createClass("ImageRenderer",{base:KityMinder.Renderer,create:function(a){return new kity.Image(a.getData("image"))},shouldRender:function(a){return a.getData("image")},update:function(a,b,c){var d=b.getData("image"),e=b.getData("imageSize"),f=b.getStyle("space-top");if(e){var g=c.cx-e.width/2,h=c.y-e.height-f;return a.setUrl(d).setX(0|g).setY(0|h).setWidth(0|e.width).setHeight(0|e.height),new kity.Box(0|g,0|h,0|e.width,0|e.height)}}});return{defaultOptions:{maxImageWidth:200,maxImageHeight:200},commands:{image:c,removeimage:d},renderers:{top:e}}}),KityMinder.registerModule("Resource",function(){var a=[51,303,75,200,157,0,26,254].map(function(a){return kity.Color.createHSL(a,100,85)}),b=kity.Color.createHSL(0,0,95);kity.extendClass(Minder,{getResourceColor:function(c){var d,e=this._getResourceColorIndexMapping();return e.hasOwnProperty(c)||(d=this._getNextResourceColorIndex(),e[c]=d),a[e[c]]||b},getUsedResource:function(){var a,b=this._getResourceColorIndexMapping(),c=[];for(a in b)b.hasOwnProperty(a)&&c.push(a);return c},_getNextResourceColorIndex:function(){var b,c,d,e=this._getResourceColorIndexMapping();c=[];for(b in e)e.hasOwnProperty(b)&&c.push(e[b]);for(d=0;d<a.length;d++)if(!~c.indexOf(d))return d;return-1},_getResourceColorIndexMapping:function(){return this._resourceColorMapping||(this._resourceColorMapping={})}});var c=kity.createClass("ResourceCommand",{base:Command,execute:function(a,b){var c=a.getSelectedNodes();"string"==typeof b&&(b=[b]),c.forEach(function(a){a.setData("resource",b).render()}),a.layout(200)},queryValue:function(a){var b=a.getSelectedNodes(),c=[];return b.forEach(function(a){var b=a.getData("resource");b&&b.forEach(function(a){~c.indexOf(a)||c.push(a)})}),c},queryState:function(a){return a.getSelectedNode()?0:-1}}),d=kity.createClass("ResourceOverlay",{base:kity.Group,constructor:function(){this.callBase();var a,b;b=this.rect=(new kity.Rect).setRadius(4),a=this.text=(new kity.Text).setFontSize(12).setVerticalAlign("middle"),this.addShapes([b,a])},setValue:function(a,b){var c,d,e,f=8,g=4;c=this.text,a==this.lastResourceName?d=this.lastBox:(c.setContent(a),d=c.getBoundaryBox(),this.lastResourceName=a,this.lastBox=d),c.setX(f).fill(b.dec("l",70)),e=this.rect,e.setPosition(0,d.y-g),this.width=Math.round(d.width+2*f),this.height=Math.round(d.height+2*g),e.setSize(this.width,this.height),e.fill(b)}}),e=kity.createClass("ResourceRenderer",{base:KityMinder.Renderer,create:function(){return this.overlays=[],new kity.Group},shouldRender:function(a){return a.getData("resource")&&a.getData("resource").length},update:function(a,b,c){var e,f,g,h=b.getStyle("space-right"),i=this.overlays,j=b.getData("resource"),k=b.getMinder();for(g=0,e=0;e<j.length;e++)g+=h,f=i[e],f||(f=new d,i.push(f),a.addShape(f)),f.setVisible(!0),f.setValue(j[e],k.getResourceColor(j[e])),f.setTranslate(g,-1),g+=f.width;for(;f=i[e++];)f.setVisible(!1);return a.setTranslate(c.right,0),{x:c.right,y:Math.round(-i[0].height/2),width:g,height:i[0].height}}});return{commands:{resource:c},renderers:{right:e}}});var ViewDragger=kity.createClass("ViewDragger",{constructor:function(a){this._minder=a,this._enabled=!1,this._bind()},isEnabled:function(){return this._enabled},setEnabled:function(a){var b=this._minder.getPaper();b.setStyle("cursor",a?"pointer":"default"),b.setStyle("cursor",a?"-webkit-grab":"default"),this._enabled=a},move:function(a,b){b?this._minder.getRenderContainer().fxTranslate(0|a.x,0|a.y,b,"easeOutCubic"):this._minder.getRenderContainer().translate(0|a.x,0|a.y)},_bind:function(){function a(a){d=null,a.stopPropagation(),c&&(b.setEnabled(!1),c=!1,"hand"==b._minder.getStatus()&&b._minder.rollbackStatus())}var b=this,c=!1,d=null,e=null;this._minder.on("normal.mousedown normal.touchstart inputready.mousedown inputready.touchstart readonly.mousedown readonly.touchstart",function(a){2==a.originEvent.button&&a.originEvent.preventDefault(),(a.getTargetNode()==this.getRoot()||2==a.originEvent.button)&&(d=a.getPosition(),c=!0)}).on("normal.mousemove normal.touchmove readonly.touchmove readonly.mousemove inputready.mousemove inputready.touchmove",function(a){if(c){var b=kity.Vector.fromPoints(d,a.getPosition());b.length()>3&&this.setStatus("hand")}}).on("hand.beforemousedown hand.beforetouchstart",function(a){b.isEnabled()&&(d=a.getPosition(),a.stopPropagation())}).on("hand.beforemousemove hand.beforetouchmove",function(a){if(d){e=a.getPosition();var c=kity.Vector.fromPoints(d,e);b.move(c),a.stopPropagation(),a.preventDefault(),a.originEvent.preventDefault(),d=e}}).on("mouseup touchend",a),window.addEventListener("mouseup",a),b._minder.getRenderTarget().addEventListener("contextmenu",function(a){a.preventDefault()})}});KityMinder.registerModule("View",function(){var a=kity.createClass("ToggleHandCommand",{base:Command,execute:function(a){"hand"!=a.getStatus()?a.setStatus("hand"):a.rollbackStatus(),this.setContentChanged(!1)},queryState:function(a){return"hand"==a.getStatus()?1:0},enableReadOnly:!1}),b=kity.createClass("CameraCommand",{base:Command,execute:function(a,b,c){b=b||a.getRoot();var d=a.getPaper().getViewPort(),e=b.getRenderContainer().getRenderBox("view"),f=d.center.x-e.x-e.width/2,g=d.center.y-e.y,h=a._viewDragger;h.move(new kity.Point(f,g),c),this.setContentChanged(!1)},enableReadOnly:!1}),c=kity.createClass("MoveCommand",{base:Command,execute:function(a,b){var c=this._viewDragger,d=a._lastClientSize;switch(b){case"up":c.move(new kity.Point(0,-d.height/2));break;case"down":c.move(new kity.Point(0,d.height/2));break;case"left":c.move(new kity.Point(-d.width/2,0));break;case"right":c.move(new kity.Point(d.width/2,0))}}});return{init:function(){this._viewDragger=new ViewDragger(this)},commands:{hand:a,camera:b,move:c},events:{keyup:function(a){a.originEvent.keyCode==keymap.Spacebar&&0===this.getSelectedNodes().length&&(this.execCommand("hand"),a.preventDefault())},statuschange:function(a){this._viewDragger.setEnabled("hand"==a.currentStatus)},mousewheel:function(a){var b,c;
a=a.originEvent,a.ctrlKey||a.shiftKey||("wheelDeltaX"in a?(b=a.wheelDeltaX||0,c=a.wheelDeltaY||0):(b=0,c=a.wheelDelta),this._viewDragger.move({x:b/2.5,y:c/2.5}),a.preventDefault())},"normal.dblclick readonly.dblclick":function(a){a.kityEvent.targetShape instanceof kity.Paper&&this.execCommand("camera",this.getRoot(),800)},ready:function(){this.execCommand("camera",null,0),this._lastClientSize={width:this.getRenderTarget().clientWidth,height:this.getRenderTarget().clientHeight}},resize:function(){var a={width:this.getRenderTarget().clientWidth,height:this.getRenderTarget().clientHeight},b=this._lastClientSize;this.getRenderContainer().translate((a.width-b.width)/2|0,(a.height-b.height)/2|0),this._lastClientSize=a}}}});var GM=KityMinder.Geometry,MoveToParentCommand=kity.createClass("MoveToParentCommand",{base:Command,execute:function(a,b,c){for(var d,e=b.length-1;e>=0;e--)d=b[e],d.parent&&(d.parent.removeChild(d),c.appendChild(d),d.render());c.expand(),a.select(b,!0)}}),DropHinter=kity.createClass("DropHinter",{base:kity.Group,constructor:function(){this.callBase(),this.rect=new kity.Rect,this.addShape(this.rect)},render:function(a){this.setVisible(!!a),a&&(this.rect.setBox(a.getLayoutBox()).setRadius(a.getStyle("radius")||0).stroke(a.getStyle("drop-hint-color")||"yellow",a.getStyle("drop-hint-width")||2),this.bringTop())}}),OrderHinter=kity.createClass("OrderHinter",{base:kity.Group,constructor:function(){this.callBase(),this.area=new kity.Rect,this.path=new kity.Path,this.addShapes([this.area,this.path])},render:function(a){this.setVisible(!!a),a&&(this.area.setBox(a.area),this.area.fill(a.node.getStyle("order-hint-area-color")||"rgba(0, 255, 0, .5)"),this.path.setPathData(a.path),this.path.stroke(a.node.getStyle("order-hint-path-color")||"#0f0",a.node.getStyle("order-hint-path-width")||1))}}),TreeDragger=kity.createClass("TreeDragger",{constructor:function(a){this._minder=a,this._dropHinter=new DropHinter,this._orderHinter=new OrderHinter,a.getRenderContainer().addShapes([this._dropHinter,this._orderHinter])},dragStart:function(a){this._startPosition=a},dragMove:function(a){var b=10;if(this._startPosition){if(this._dragPosition=a,!this._dragMode){if(GM.getDistance(this._dragPosition,this._startPosition)<b)return;if(!this._enterDragMode())return}for(var c=kity.Vector.fromPoints(this._startPosition,this._dragPosition),d=this._minder,e=0;e<this._dragSources.length;e++)this._dragSources[e].setLayoutOffset(this._dragSourceOffsets[e].offset(c)),d.applyLayoutResult(this._dragSources[e]);this._dropTest()?this._renderOrderHint(this._orderSucceedHint=null):this._orderTest()}},dragEnd:function(){if(this._startPosition=null,this._dragMode){if(this._fadeDragSources(1),this._dropSucceedTarget)this._dragSources.forEach(function(a){a.setLayoutOffset(null)}),this._minder.execCommand("movetoparent",this._dragSources,this._dropSucceedTarget);else if(this._orderSucceedHint){var a=this._orderSucceedHint,b=a.node.getIndex(),c=this._dragSources.map(function(a){return a.setLayoutOffset(null),a.getIndex()}),d=Math.max.apply(Math,c),e=Math.min.apply(Math,c);e>b&&"down"==a.type&&b++,b>d&&"up"==a.type&&b--,a.node.setLayoutOffset(null),this._minder.execCommand("arrange",this._dragSources,b),this._renderOrderHint(null)}else this._minder.fire("savescene");this._leaveDragMode(),this._minder.fire("contentchange")}},_enterDragMode:function(){return this._calcDragSources(),this._dragSources.length?(this._fadeDragSources(.5),this._calcDropTargets(),this._calcOrderHints(),this._dragMode=!0,this._minder.setStatus("dragtree"),!0):(this._startPosition=null,!1)},_calcDragSources:function(){this._dragSources=this._minder.getSelectedAncestors(),this._dragSourceOffsets=this._dragSources.map(function(a){return a.getLayoutOffset()})},_fadeDragSources:function(a){var b=this._minder;this._dragSources.forEach(function(c){c.getRenderContainer().fxOpacity(a,200),c.traverse(function(c){1>a?b.detachNode(c):b.attachNode(c)},!0)})},_calcDropTargets:function(){function a(b,c){var d,e=[];return e.push(c),c.getChildren().forEach(function(c){for(d=0;d<b.length;d++)if(b[d]==c)return;e=e.concat(a(b,c))}),e}this._dropTargets=a(this._dragSources,this._minder.getRoot()),this._dropTargetBoxes=this._dropTargets.map(function(a){return a.getLayoutBox()})},_calcOrderHints:function(){var a=this._dragSources,b=MinderNode.getCommonAncestor(a);if(b==a[0]&&(b=a[0].parent),0===a.length||b!=a[0].parent)return void(this._orderHints=[]);var c=b.children;this._orderHints=c.reduce(function(b,c){return-1==a.indexOf(c)&&(b=b.concat(c.getOrderHint())),b},[])},_leaveDragMode:function(){this._dragMode=!1,this._dropSucceedTarget=null,this._orderSucceedHint=null,this._renderDropHint(null),this._renderOrderHint(null),this._minder.rollbackStatus()},_drawForDragMode:function(){this._text.setContent(this._dragSources.length+" items"),this._text.setPosition(this._startPosition.x,this._startPosition.y+5),this._minder.getRenderContainer().addShape(this)},_boxTest:function(a,b,c){var d,e,f,g,h,i=this._dragSources.map(function(a){return a.getLayoutBox()});for(c=c||function(a){return a},d=0;d<a.length;d++)for(f=a[d],h=b.call(this,f,d),e=0;e<i.length;e++){g=i[e];var j=GM.getIntersectBox(g,h);if(c(j,g,h))return f}return null},_dropTest:function(){return this._dropSucceedTarget=this._boxTest(this._dropTargets,function(a,b){return this._dropTargetBoxes[b]},function(a,b,c){function d(a){return a.width*a.height}return a?d(a)>.5*Math.min(d(b),d(c))?!0:a.width+1>=Math.min(b.width,c.width)?!0:a.height+1>=Math.min(b.height,c.height)?!0:!1:!1}),this._renderDropHint(this._dropSucceedTarget),!!this._dropSucceedTarget},_orderTest:function(){return this._orderSucceedHint=this._boxTest(this._orderHints,function(a){return a.area}),this._renderOrderHint(this._orderSucceedHint),!!this._orderSucceedHint},_renderDropHint:function(a){this._dropHinter.render(a)},_renderOrderHint:function(a){this._orderHinter.render(a)},preventDragMove:function(){this._startPosition=null}});KityMinder.registerModule("DragTree",function(){var a;return{init:function(){a=new TreeDragger(this),window.addEventListener("mouseup",function(){a.dragEnd()})},events:{"normal.mousedown inputready.mousedown":function(b){b.originEvent.button||b.getTargetNode()&&b.getTargetNode()!=this.getRoot()&&a.dragStart(b.getPosition(this.getRenderContainer()))},"normal.mousemove dragtree.mousemove":function(b){a.dragMove(b.getPosition(this.getRenderContainer()))},"normal.mouseup dragtree.beforemouseup":function(b){a.dragEnd(),b.preventDefault(),this.fire("contentchange")},statuschange:function(b){"textedit"==b.lastStatus&&"normal"==b.currentStatus&&a.preventDragMove()}},commands:{movetoparent:MoveToParentCommand}}}),KityMinder.registerModule("DropFile",function(){function a(){var a=this.getPaper().getContainer();a.addEventListener("dragover",b),a.addEventListener("drop",c.bind(this))}function b(a){a.preventDefault(),a.stopPropagation(),a.dataTransfer.dropEffect="copy"}function c(a){a.preventDefault(),a.stopPropagation();var b=this;if(kity.Browser.ie&&Number(kity.Browser.version)<10)return void alert("文件导入对 IE 浏览器仅支持 10 以上版本");var c=a.dataTransfer.files;if(c){var e=c[0];d(b,e)}}function d(a,b,c){if(b){var d=/(.)\w+$/.exec(b.name);if(!d)return alert("不支持导入此类文件！");d=d[0],/xmind/g.test(d)?f(a,b,"xmind"):/mmap/g.test(d)?f(a,b,"mindmanager"):/mm/g.test(d)?g(a,b,"freemind",c):/km/.test(d)?g(a,b,"json",c):/txt/.test(d)?g(a,b,"plain",c):alert("不支持导入此类文件!")}}function e(){k&&(h(this),i.setRemotePath(null,!1),this.execCommand("camera",this.getRoot(),800),setTimeout(function(){i.watchChanges(!0)},10),k=!1)}function f(a,b,c){i=i||window.social,i.watchChanges(!1),k=!0,a.importData(b,c)}function g(a,b,c,d){var e=new FileReader;e.onload=function(b){f(a,b.target.result,c)},e.readAsText(b,d||"utf8")}function h(a){j=window.draftManager||(window.draftManager=new window.DraftManager(a)),j.create()}var i,j,k=!1;return kity.extendClass(Minder,{importFile:function(a,b){return d(this,a,b),this}}),{events:{ready:a,"import":e}}}),KityMinder.registerModule("KeyboardModule",function(){function a(a){var b,d=[];a.traverse(function(a){b=a.getLayoutBox(),b.width&&b.height&&d.push({left:b.x,top:b.y,right:b.x+b.width,bottom:b.y+b.height,width:b.width,height:b.height,node:a,text:a.getText()})});for(var e=0;e<d.length;e++)c(d,e)}function b(a,b){var c,d,e,i,j,k,l;return c=f(a.left,b.left),d=g(a.right,b.right),e=f(a.top,b.top),i=g(a.bottom,b.bottom),j=d-c-a.width-b.width,k=i-e-a.height-b.height,l=0>j?k:0>k?j:h(j*j+k*k),{cx:l,cy:l}}function c(a,c){for(var d,e,f=a[c],g={},h=0;h<a.length;h++)h!=c&&(d=a[h],e=b(d,f),d.right<f.left&&(!g.left||e.cx<g.left.dist)&&(g.left={dist:e.cx,node:d.node}),d.left>f.right&&(!g.right||e.cx<g.right.dist)&&(g.right={dist:e.cx,node:d.node}),d.bottom<f.top&&(!g.top||e.cy<g.top.dist)&&(g.top={dist:e.cy,node:d.node}),d.top>f.bottom&&(!g.down||e.cy<g.down.dist)&&(g.down={dist:e.cy,node:d.node}));f.node._nearestNodes={right:g.right&&g.right.node||null,top:g.top&&g.top.node||null,left:g.left&&g.left.node||null,down:g.down&&g.down.node||null}}function d(b,c){var d=b.getSelectedNode();if(!d)return b.select(b.getRoot()),void a(b.getRoot());var e=d._nearestNodes[c];e&&b.select(e,!0)}{var e,f=Math.min,g=Math.max,h=(Math.abs,Math.sqrt);Math.exp}return{events:{layoutallfinish:function(){function b(){a(c)}var c=this.getRoot();kity.Timeline.releaseFrame(e),e=kity.Timeline.requestFrame(b)},"inputready.beforekeydown":function(a){var b=a.originEvent;b.shiftKey&&b.keyCode==KityMinder.keymap.Tab&&a.preventDefault()},"normal.keydown":function(a){var b=KityMinder.keymap,c=a.getTargetNode(),e=this.getLang();this.receiver&&(this.receiver.keydownNode=c);var f=a.originEvent;if(f.altKey||f.ctrlKey||f.metaKey||f.shiftKey)return void([b.Tab].indexOf(f.keyCode)&&a.preventDefault);switch(f.keyCode){case b.Enter:this.execCommand("AppendSiblingNode",e.topic),a.preventDefault();break;case b.Tab:this.execCommand("AppendChildNode",e.topic),a.preventDefault();break;case b.Backspace:case b.Del:a.preventDefault(),this.execCommand("RemoveNode");break;case b.F2:a.preventDefault(),this.execCommand("EditNode");break;case b.Left:d(this,"left"),a.preventDefault();break;case b.Up:d(this,"top"),a.preventDefault();break;case b.Right:d(this,"right"),a.preventDefault();break;case b.Down:d(this,"down"),a.preventDefault()}},"normal.keyup":function(a){if(browser.ipad){var b=KityMinder.keymap,c=a.getTargetNode(),d=this.getLang();this.receiver&&(this.receiver.keydownNode=c);var e=a.originEvent;if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return;switch(e.keyCode){case b.Enter:this.execCommand("AppendSiblingNode",d.topic),a.preventDefault();break;case b.Backspace:case b.Del:a.preventDefault(),this.execCommand("RemoveNode")}}}}}}),KityMinder.registerModule("Select",function(){var a=this,b=a.getRenderContainer(),c=KityMinder.Geometry,d=function(){var d=null,e=new kity.Path,f=!1,g=10;return{selectStart:function(a){return a.originEvent.button?void 0:d?this.selectEnd():void(d=c.snapToSharp(a.getPosition(b)))},selectMove:function(h){if("textedit"!=a.getStatus()&&d){var i=d,j=h.getPosition(b);if(!f){if(c.getDistance(i,j)<g)return;f=!0,b.addShape(e),e.fill(a.getStyle("marquee-background")).stroke(a.getStyle("marquee-stroke")).setOpacity(.8).getDrawer().clear()}var k=c.getBox(i,j),l=[];k.left=Math.round(k.left),k.top=Math.round(k.top),k.right=Math.round(k.right),k.bottom=Math.round(k.bottom),e.getDrawer().pipe(function(){this.clear(),this.moveTo(k.left,k.top),this.lineTo(k.right,k.top),this.lineTo(k.right,k.bottom),this.lineTo(k.left,k.bottom),this.close()}),a.getRoot().traverse(function(a){var b=a.getLayoutBox();c.getIntersectBox(b,k)&&l.push(a)}),a.select(l,!0),window.getSelection().removeAllRanges()}},selectEnd:function(){d&&(d=null),f&&(e.fadeOut(200,"ease",0,function(){e.remove&&e.remove()}),f=!1)}}}(),e=null,f=null;return{init:function(){window.addEventListener("mouseup",function(){d.selectEnd()})},events:{"normal.mousedown textedit.mousedown inputready.mousedown":function(a){var b=a.getTargetNode();b?a.originEvent.shiftKey?this.toggleSelect(b):b.isSelected()?this.isSingleSelect()||(e=b,f=a.getPosition(this.getRenderContainer())):this.select(b,!0):(this.removeAllSelectedNodes(),d.selectStart(a),this.setStatus("normal"))},"normal.mousemove textedit.mousemove inputready.mousemove":d.selectMove,"normal.mouseup textedit.mouseup inputready.mouseup":function(a){var b=a.getTargetNode();if(b&&b==e){var c=a.getPosition(this.getRenderContainer()),g=kity.Vector.fromPoints(f,c);g.length()<1&&this.select(e,!0),e=null}d.selectEnd(a)},"normal.keydown inputready.keydown":function(a){var b=a.originEvent;if((b.ctrlKey||b.metaKey)&&keymap.a==b.keyCode){var c=[];this.getRoot().traverse(function(a){c.push(a)}),this.select(c,!0),a.preventDefault()}}}}}),KityMinder.registerModule("TextEditModule",function(){function a(a){if(a&&b.isSingleSelect()&&a.isSelected()){var f=a.getStyle("text-selection-color"),g=a.getTextShape();if(c.setHide().setStartOffset(0).setEndOffset(g.getContent().length).setColor(f),e.setMinderNode(a).updateContainerRangeBySel(),browser.ie)var h=setInterval(function(){var a=d.nativeSel.getRangeAt(0);!a||a.collapsed?d.select():clearInterval(h)});e.minderNode.setTmpData("_lastTextContent",e.textShape.getContent()),b.setStatus("inputready")}}var b=this,c=new Minder.Selection,d=new Minder.Range,e=new Minder.Receiver(this,c,d);this.receiver=e;var f,g=!1,h=1,i=!1;return b.textEditNode=function(c){a(c),b.setStatus("textedit"),e.updateSelectionShow()},{events:{ready:function(){document.body.appendChild(e.container)},"normal.beforemousedown textedit.beforemousedown inputready.beforemousedown":function(a){if(!a.isRightMB()){if(e.minderNode){var h=e.minderNode.getTextShape();h&&0===h.getOpacity()&&(e.minderNode.setText(e.minderNode.getTmpData("_lastTextContent")),e.minderNode.render(),e.minderNode.getTextShape().setOpacity(1),b.layout(300))}g=!0,i=c.isShow(),c.setHide();var j=a.getTargetNode();if(!j){var k=a.kityEvent.targetShape;k&&"Selection"==k.getType()&&(j=e.getMinderNode(),a.stopPropagationImmediately())}if(j){var h=j.getTextShape();if(h.setStyle("cursor","default"),this.isSingleSelect()&&j.isSelected())return c.collapse(!0),c.setColor(j.getStyle("text-selection-color")),e.setMinderNode(j).setCurrentIndex(a.getPosition(this.getRenderContainer())).setRange(d).setReady(),f=a.getPosition(this.getRenderContainer()),void(i&&(h.setStyle("cursor","text"),e.updateSelection(),setTimeout(function(){c.setShow()},200),b.setStatus("textedit")))}e.clearReady(),e.clear()}},"inputready.keyup":function(){c.isHide()&&a(this.getSelectedNode())},"normal.keyup":function(b){var d=this.getSelectedNode();if(d&&this.isSingleSelect()&&d.isSelected()&&!c.isShow()){var e=b.originEvent,f=e.keyCode;!keymap.isSelectedNodeKey[f]||e.ctrlKey||e.metaKey||e.shiftKey||e.altKey||a(d)}},"normal.mouseup textedit.mouseup inputready.mouseup":function(d){g=!1;var h=d.getTargetNode();return h&&!i&&e.isReady()?(c.collapse(!0),c.setColor(h.getStyle("text-selection-color")),h.getTextShape().setStyle("cursor","text"),e.updateSelection(),browser.ipad&&e.focus(),setTimeout(function(){c.setShow()},200),f=d.getPosition(this.getRenderContainer()),void b.setStatus("textedit")):void(c.isHide()?a(d.getTargetNode()):c.collapsed||e.updateContainerRangeBySel())},"textedit.beforemousemove inputready.beforemousemove":function(a){if(!browser.ipad)if(g&&e.isReady()&&i){a.stopPropagationImmediately();var c=a.getPosition(this.getRenderContainer());h=c.x>f.x?1:c.x<f.x?-1:h,e.updateSelectionByMousePosition(c,h).updateSelectionShow(h).updateContainerRangeBySel(),f=a.getPosition(this.getRenderContainer())}else g&&!i&&(b.setStatus("normal"),e.clearReady())},"normal.dblclick textedit.dblclick inputready.dblclick":function(c){var d=c.getTargetNode();d&&(a(c.getTargetNode()),b.setStatus("textedit"),e.updateSelectionShow())},restoreScene:function(){e.clear(),a(this.getSelectedNode())},stopTextEdit:function(){e.clear(),b.setStatus("normal")},resize:function(){c.setHide()},execCommand:function(d){var f={appendchildnode:1,appendsiblingnode:1,editnode:1};return f[d.commandName]?(a(b.getSelectedNode()),void e.updateSelectionShow()):void(c.isShow()&&e.updateTextOffsetData().updateSelection())},layoutfinish:function(a){a.node!==e.minderNode||"textedit"!=this.getStatus()&&"inputready"!=this.getStatus()||e.setBaseOffset().setContainerStyle()},selectionclear:function(){var c=b.getSelectedNode();c?a(c):(b.setStatus("normal"),e.clear())},blur:function(){e.clear()},"textedit.import":function(){b.setStatus("normal"),e.clear()},"textedit.mousewheel":function(){e.setContainerStyle()}}}}),Minder.Range=kity.createClass("Range",{constructor:function(){this.nativeRange=document.createRange(),this.nativeSel=window.getSelection()},hasNativeRange:function(){return 0!==this.nativeSel.rangeCount},select:function(){var a=this.nativeRange.startContainer;if(1==a.nodeType&&0===a.childNodes.length){var b=document.createTextNode("​");a.appendChild(b),this.nativeRange.setStart(b,1),this.nativeRange.collapse(!0)}try{this.nativeSel.removeAllRanges()}catch(c){}return this.nativeSel.addRange(this.nativeRange),this},setStart:function(a,b){try{this.nativeRange.setStart(a,b)}catch(c){console.log(c)}return this},setEnd:function(a,b){return this.nativeRange.setEnd(a,b),this},getStart:function(){var a=this.nativeSel.getRangeAt(0);return{startContainer:a.startContainer,startOffset:a.startOffset}},getStartOffset:function(){return this.nativeRange.startOffset},getEndOffset:function(){return this.nativeRange.endOffset},collapse:function(a){return this.nativeRange.collapse(a===!0),this},isCollapsed:function(){return this.nativeRange.collapsed},insertNode:function(a){return this.nativeRange.insertNode(a),this},updateNativeRange:function(){return this.nativeRange=this.nativeSel.getRangeAt(0),this}}),Minder.Receiver=kity.createClass("Receiver",{clear:function(){return this.container.innerHTML="",this.selection&&this.selection.setHide(),this.range&&this.range.nativeSel.removeAllRanges(),this.index=0,this.isTypeText=!1,this.lastMinderNode=null,this},constructor:function(a,b,c){var d=this;this.setKityMinder(a);var e=document.createElement("div");e.setAttribute("contenteditable",!0),e.className="km_receiver",this.container=e,browser.ipad&&utils.listen(this.container,"keydown keypress keyup input",function(a){d.keyboardEvents.call(d,new MinderEvent("keyup"==a.type?"beforekeyup":a.type,a)),"keyup"==a.type&&"normal"==d.km.getStatus()&&d.km.fire("keyup",a)}),utils.addCssRule("km_receiver_css"," .km_receiver{white-space:nowrap;position:absolute;padding:0;margin:0;word-wrap:break-word;"+(/\?debug#?/.test(location.href)?"":"clip:rect(1em 1em 1em 1em);")),this.km.on("inputready.beforekeyup inputready.beforekeydown textedit.beforekeyup normal.keydown normal.keyup textedit.beforekeydown textedit.keypress textedit.paste",utils.proxy(this.keyboardEvents,this)),this.timer=null,this.index=0,this.selection=b,this.range=c},setRange:function(a,b){this.index=b||this.index;var c=this.container.firstChild;this.range=a,a.setStart(c||this.container,this.index),a.collapse(!0);var d=this;return setTimeout(function(){d.container.focus(),a.select()}),this},setTextShape:function(a){return a||(a=new kity.Text),this.textShape=a,a._lastContent!=a.getContent()&&(this.container.innerHTML=utils.unhtml(a.getContent()),a._lastContent=a.getContent()),this},setTextShapeSize:function(a){return this.textShape.setSize(a),this},getTextShapeHeight:function(){return this.textShape.getRenderBox().height},setKityMinder:function(a){return this.km=a,this},setMinderNode:function(a){return this.minderNode=a,this._addSelection(),this.setTextShape(a.getTextShape()),this.setBaseOffset(),this.setContainerStyle(),this.updateTextOffsetData(),this.setSelectionHeight(),this.setContainerTxt(),this},_addSelection:function(){this.selection.container&&this.selection.remove(),this.minderNode.getRenderContainer().addShape(this.selection)},getMinderNode:function(){return this.minderNode},keyboardEvents:function(a){function b(){if(clearTimeout(d.timer),d.range.hasNativeRange()&&!keymap.controlKeys[f]){d.lastMinderNode===d.minderNode||keymap.notContentChange[f]||(d.km.fire("saveScene",{inputStatus:!0}),d.lastMinderNode=d.minderNode);var a=d.container.textContent.replace(/[\u200b\t\r\n]/g,"");browser.gecko&&/\s$/.test(a)&&(a+="​"),(0!==a.length||0!==d.textShape.getOpacity())&&(0===a.length?(d.minderNode.setTmpData("_lastTextContent",d.textShape.getContent()),d.minderNode.setText("a")):(d.minderNode.setText(a),0===d.textShape.getOpacity()&&d.textShape.setOpacity(1)),d.setContainerStyle(),d.minderNode.getRenderContainer().bringTop(),d.minderNode.render(),keymap.notContentChange[f]||(clearTimeout(d.inputTextTimer),d.inputTextTimer=setTimeout(function(){d.km.layout(300)},250)),d.textShape=d.minderNode.getRenderer("TextRenderer").getRenderShape(),0===a.length&&d.textShape.setOpacity(0),d.setBaseOffset(),d.updateTextOffsetData(),d.updateRange(),d.updateSelectionByRange(),d.updateSelectionShow(),d.timer=setTimeout(function(){d.selection.isShow()&&d.selection.setShow()},200),d.km.setStatus("textedit"))}}function c(){if(d.minderNode){var a=d.minderNode.getTextShape();a&&0===a.getOpacity()&&(d.minderNode.setText(d.minderNode.getTmpData("_lastTextContent")),d.minderNode.render(),d.minderNode.getTextShape().setOpacity(1),d.km.layout(300))}}var d=this,e=a.originEvent,f=e.keyCode;switch(a.type){case"input":browser.ipad&&setTimeout(function(){b()});break;case"beforekeydown":switch(this.isTypeText=229==f||0===f,f){case keymap.Enter:case keymap.Tab:return this.selection.isShow()?(this.clear(),this.km.setStatus("inputready"),clearTimeout(d.inputTextTimer),a.preventDefault()):(this.km.setStatus("normal"),this.km.fire("contentchange")),void c();case keymap.left:case keymap.right:case keymap.up:case keymap.down:case keymap.Backspace:case keymap.Del:case keymap["/"]:if(this.selection.isHide())return c(),void this.km.setStatus("normal");break;case keymap.Control:case keymap.Alt:case keymap.Cmd:case keymap.F2:if(this.selection.isHide()&&"textedit"!=this.km.getStatus())return void this.km.setStatus("normal")}if(a.originEvent.ctrlKey||a.originEvent.metaKey){if(this.selection.isHide()&&{86:1,88:1,67:1}[f])return c(),void this.km.setStatus("normal");if(f==keymap.v)return void setTimeout(function(){d.range.updateNativeRange().insertNode($("<span>$$_kityminder_bookmark_$$</span>")[0]),d.container.innerHTML=utils.unhtml(d.container.textContent.replace(/[\u200b\t\r\n]/g,""));var a=d.container.textContent.indexOf("$$_kityminder_bookmark_$$");d.container.textContent=d.container.textContent.replace("$$_kityminder_bookmark_$$",""),d.range.setStart(d.container.firstChild,a).collapse(!0).select(),b(f)},100);if(f==keymap.x)return void setTimeout(function(){b(f)},100)}(keymap.Del==f||keymap.Backspace==f)&&b(f);break;case"beforekeyup":switch(f){case keymap.Enter:case keymap.Tab:case keymap.F2:return browser.ipad?(this.selection.isShow()?(this.clear(),this.km.setStatus("inputready"),clearTimeout(d.inputTextTimer),a.preventDefault()):(this.km.setStatus("normal"),this.km.fire("contentchange")),void c()):(keymap.Enter==f&&(this.isTypeText||browser.mac&&browser.gecko)&&b(f),this.keydownNode===this.minderNode&&(this.rollbackStatus(),this.clear()),void a.preventDefault());case keymap.Del:case keymap.Backspace:case keymap.Spacebar:return browser.ipad&&this.selection.isHide()?void this.km.setStatus("normal"):void b(f)}return this.isTypeText?void b(f):browser.mac&&browser.gecko?void b(f):(b(f),!0);case"keyup":var g=this.km.getSelectedNode();if("normal"==this.km.getStatus()&&g&&this.selection.isHide()&&g&&this.km.isSingleSelect()&&g.isSelected()){var h=g.getStyle("text-selection-color"),i=g.getTextShape();if(this.selection.setHide().setStartOffset(0).setEndOffset(i.getContent().length).setColor(h),this.setMinderNode(g).updateContainerRangeBySel(),browser.ie)var j=setInterval(function(){var a=this.range.nativeSel.getRangeAt(0);!a||a.collapsed?this.range.select():clearInterval(j)});this.minderNode.setTmpData("_lastTextContent",this.textShape.getContent()),this.km.setStatus("inputready")}}},updateIndex:function(){return this.index=this.range.getStart().startOffset,this},updateTextOffsetData:function(){return this.textShape.textData=this.getTextOffsetData(),this},setSelection:function(a){return this.selection=a,this},updateSelection:function(){return this.selection.setShowHold(),this.selection.bringTop(),this.selection.setStartOffset(this.index).collapse(!0),this.selection.setPosition(this.index==this.textData.length?0===this.index?this.getBaseOffset():{x:this.textData[this.index-1].x+this.textData[this.index-1].width,y:this.textData[this.index-1].y}:this.textData[this.index]),this},getBaseOffset:function(a){return this.textShape.getRenderBox(a||this.km.getRenderContainer())},setBaseOffset:function(){return this.offset=this.textShape.getRenderBox(this.km.getRenderContainer()),this},setContainerStyle:function(){var a=this.getBaseOffset("screen");return this.container.style.cssText=";left:"+(browser.ipad?"-":"")+a.x+"px;top:"+(a.y+(/\?debug#?/.test(location.href)?30:0))+"px;width:"+a.width+"px;height:"+a.height+"px;",this},getTextOffsetData:function(){var a,b=this.textShape.getContent();this.textData=[];for(var c=0,d=b.length;d>c;c++){try{a=this.textShape.getExtentOfChar(c)}catch(e){console.log(e)}this.textData.push({x:a.x,y:a.y,width:a.width,height:a.height})}return this},setCurrentIndex:function(a){var b=this;this.getTextOffsetData();var c=!1;return this._getRelativeValue(a),utils.each(this.textData,function(d,e){return 0===d&&a.x<=e.x?(b.index=0,!1):a.x>=e.x&&a.x<=e.x+e.width?(b.index=a.x-e.x>e.width/2?d+1:d,c=!0,!1):d==b.textData.length-1&&a.x>=e.x?(b.index=b.textData.length,!1):void 0}),this},setSelectionHeight:function(){return this.selection.setHeight(this.getTextShapeHeight()),this},_getRelativeValue:function(a){a.x=a.x-this.offset.x,a.y=a.y-this.offset.y},updateSelectionByMousePosition:function(a,b){this._getRelativeValue(a);var c=this;return utils.each(this.textData,function(d,e){return 0===d&&a.x<=e.x?(c.selection.setStartOffset(0),!1):d==c.textData.length-1&&a.x>=e.x?(c.selection.setEndOffset(c.textData.length),!1):a.x>=e.x&&a.x<=e.x+e.width?(c.index==d?(0===d&&c.selection.setStartOffset(d),a.x<=e.x+e.width/2?c.selection.collapse(!0):c.selection.setEndOffset(d+((c.selection.endOffset>d||1==b)&&d!=c.textData.length-1?1:0))):d>c.index?(c.selection.setStartOffset(c.index),c.selection.setEndOffset(d+1)):(c.selection.setStartOffset(1==b?d+(a.x>=e.x+e.width/2&&d!=c.textData.length-1?1:0):d),c.selection.setEndOffset(c.index)),!1):void 0}),this},updateSelectionShow:function(){var a=this.textData[this.selection.startOffset],b=this.textData[this.selection.endOffset],c=0;if(this.selection.collapsed){if(void 0===a){var d=this.textData[this.textData.length-1];d=utils.clone(d),d.x=d.x+d.width,a=d}return this.selection.updateShow(a,2),this}if(b)c=b.x-a.x;else try{var e=this.textData[this.textData.length-1];c=e.x-a.x+e.width}catch(f){console.log(f)}return this.selection.updateShow(a,c),this},updateRange:function(){return this.range.updateNativeRange(),this},updateContainerRangeBySel:function(){var a=this,b=this.container.firstChild;return this.range.setStart(b,this.selection.startOffset),this.range.setEnd(b,this.selection.endOffset),browser.gecko?(this.container.focus(),setTimeout(function(){a.range.select()})):this.range.select(),this},updateSelectionByRange:function(){return this.selection.setStartOffset(this.range.getStartOffset()),this.selection.setEndOffset(this.range.getEndOffset()),this},setIndex:function(a){return this.index=a,this},setContainerTxt:function(a){return this.container.textContent=a||this.textShape.getContent(),this},setReady:function(){this._ready=!0},clearReady:function(){this._ready=!1},isReady:function(){return this._ready},focus:function(){this.container.focus()}}),Minder.Selection=kity.createClass("Selection",{base:kity.Rect,constructor:function(a){this.callBase(),this.height=a||20,this.setAttr("id","_kity_selection"),this.width=2,this.fill("rgb(27,171,255)"),this.setHide(),this.timer=null,this.collapsed=!0,this.startOffset=this.endOffset=0,this.setOpacity(.5),this.setStyle("cursor","text"),this._show=!1},setColor:function(a){this.fill(a)},collapse:function(a){return this.setOpacity(1),this.width=2,this.collapsed=!0,a?this.endOffset=this.startOffset:this.startOffset=this.endOffset,this},setStartOffset:function(a){return this.startOffset=a,this.startOffset>=this.endOffset?(this.collapse(!0),this):(this.collapsed=!1,this.setOpacity(.5),this)},setEndOffset:function(a){return this.endOffset=a,this.endOffset<=this.startOffset?(this.startOffset=a,this.collapse(!0),this):(this.collapsed=!1,this.setOpacity(.5),this)},updateShow:function(a,b){return b&&this.setShowHold(),this.setPosition(a).setWidth(b),this.bringTop(),this},setPosition:function(a){try{this.x=Math.round(a.x)-.5,this.y=Math.round(a.y)-1.5}catch(b){console.log(b)}return this.update(),this},setHeight:function(a){return this.height=Math.round(a)+2,this},setHide:function(){return clearInterval(this.timer),this.setStyle("display","none"),this._show=!1,this},setShowHold:function(){return clearInterval(this.timer),this.setStyle("display",""),this._show=!0,this},setShow:function(){clearInterval(this.timer);var a=this,b="";return a.setStyle("display",""),a._show=!0,this.collapsed&&(a.setOpacity(1),this.timer=setInterval(function(){a.setStyle("display",b),b=b?"":"none"},400)),this},isShow:function(){return this._show},isHide:function(){return!this._show}}),KityMinder.registerModule("basestylemodule",function(){function a(a,b){return a.getData(b)||a.getStyle(b)}var b=this;return KityMinder.TextRenderer.registerStyleHook(function(b,c){c.setFont({weight:a(b,"font-weight"),style:a(b,"font-style")})}),{commands:{bold:kity.createClass("boldCommand",{base:Command,execute:function(a){var b=a.getSelectedNodes();1==this.queryState("bold")?utils.each(b,function(a,b){b.setData("font-weight").render()}):utils.each(b,function(a,b){b.setData("font-weight","bold").render()}),a.layout()},queryState:function(){var a=b.getSelectedNodes(),c=0;return 0===a.length?-1:(utils.each(a,function(a,b){return b&&b.getData("font-weight")?(c=1,!1):void 0}),c)}}),italic:kity.createClass("italicCommand",{base:Command,execute:function(a){var b=a.getSelectedNodes();1==this.queryState("italic")?utils.each(b,function(a,b){b.setData("font-style").render()}):utils.each(b,function(a,b){b.setData("font-style","italic").render()}),a.layout()},queryState:function(){var a=b.getSelectedNodes(),c=0;return 0===a.length?-1:(utils.each(a,function(a,b){return b&&b.getData("font-style")?(c=1,!1):void 0}),c)}})},addShortcutKeys:{bold:"ctrl+b",italic:"ctrl+i"}}}),KityMinder.registerModule("fontmodule",function(){function a(a,b){return a.getData(b)||a.getStyle(b)}return KityMinder.TextRenderer.registerStyleHook(function(b,c){var d=b.getData("color"),e=b.getStyle("selected-color"),f=b.getStyle("color");c.fill(d||(b.isSelected()&&e?e:f)),c.setFont({family:a(b,"font-family"),size:a(b,"font-size")})}),{defaultOptions:{fontfamily:[{name:"宋体",val:"宋体,SimSun"},{name:"微软雅黑",val:"微软雅黑,Microsoft YaHei"},{name:"楷体",val:"楷体,楷体_GB2312,SimKai"},{name:"黑体",val:"黑体, SimHei"},{name:"隶书",val:"隶书, SimLi"},{name:"Andale Mono",val:"andale mono"},{name:"Arial",val:"arial,helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"Comic Sans Ms",val:"comic sans ms"},{name:"Impact",val:"impact,chicago"},{name:"Times New Roman",val:"times new roman"},{name:"Sans-Serif",val:"sans-serif"}],fontsize:[10,12,16,18,24,32,48]},commands:{forecolor:kity.createClass("fontcolorCommand",{base:Command,execute:function(a,b){var c=a.getSelectedNodes();utils.each(c,function(a,c){c.setData("color",b),c.render()})},queryState:function(a){return 0==a.getSelectedNodes().length?-1:0},queryValue:function(a){return 1==a.getSelectedNodes().length?a.getSelectedNodes()[0].getData("color"):"mixed"}}),background:kity.createClass("backgroudCommand",{base:Command,execute:function(a,b){var c=a.getSelectedNodes();
utils.each(c,function(a,c){c.setData("background",b),c.render()})},queryState:function(a){return 0==a.getSelectedNodes().length?-1:0},queryValue:function(a){return 1==a.getSelectedNodes().length?a.getSelectedNodes()[0].getData("background"):"mixed"}}),fontfamily:kity.createClass("fontfamilyCommand",{base:Command,execute:function(a,b){var c=a.getSelectedNodes();utils.each(c,function(c,d){d.setData("font-family",b),d.render(),a.layout()})},queryState:function(a){return 0===a.getSelectedNodes().length?-1:0},queryValue:function(a){var b=a.getSelectedNode();return b?b.getData("font-family"):null}}),fontsize:kity.createClass("fontsizeCommand",{base:Command,execute:function(a,b){var c=a.getSelectedNodes();utils.each(c,function(c,d){d.setData("font-size",b),d.render(),a.layout(300)})},queryState:function(a){return 0==a.getSelectedNodes().length?-1:0},queryValue:function(a){var b=a.getSelectedNode();return b?b.getData("font-size"):null}})}}}),KityMinder.registerModule("Zoom",function(){function a(){var a=e._zoomValue>=100?"optimize-speed":"geometricPrecision";e.getRenderContainer().setAttr("text-rendering",a)}function b(a){var b=a.shapeNode,c=b.getCTM(),d=new kity.Matrix(c.a,c.b,c.c,c.d,(0|c.e)+.5,(0|c.f)+.5);b.setAttribute("transform","matrix("+d.toString()+")")}function c(b,c){{var e=b.getPaper();e.getViewPort()}if(c){if(a(),b.getRoot().getComplex()>200)return b._zoomValue=c,b.zoom(c);var f=new kity.Animator({beginValue:b._zoomValue,finishValue:c,setter:function(a,b){a.zoom(b)}});b._zoomValue=c,d&&d.pause(),d=f.start(b,300,"easeInOutSine",function(){})}}var d,e=this;e.setDefaultOptions("zoom",[10,20,30,50,80,100,120,150,200]),kity.extendClass(Minder,{zoom:function(a){var c=this.getPaper(),d=c.getViewPort();d.zoom=a/100,d.center={x:d.center.x,y:d.center.y},c.setViewPort(d),100==a&&b(c)},getZoomValue:function(){return this._zoomValue}});var f=kity.createClass("Zoom",{base:Command,execute:c,queryValue:function(a){return a._zoomValue}}),g=kity.createClass("ZoomInCommand",{base:Command,execute:function(a){c(a,this.nextValue(a))},queryState:function(a){return~this.nextValue(a)},nextValue:function(a){var b,c=a.getOptions("zoom");for(b=0;b<c.length;b++)if(c[b]>a._zoomValue)return c[b];return 0},enableReadOnly:!1}),h=kity.createClass("ZoomOutCommand",{base:Command,execute:function(a){c(a,this.nextValue(a))},queryState:function(a){return~this.nextValue(a)},nextValue:function(a){var b,c=a.getOptions("zoom");for(b=c.length-1;b>=0;b--)if(c[b]<a._zoomValue)return c[b];return 0},enableReadOnly:!1});return{init:function(){this._zoomValue=100,a()},commands:{"zoom-in":g,"zoom-out":h,zoom:f},events:{"normal.keydown":function(a){var b=this,c=a.originEvent,d=c.keyCode||c.which;keymap["="]==d&&(b.execCommand("zoom-in"),a.stopPropagation(),a.preventDefault()),keymap["-"]==d&&(b.execCommand("zoom-out"),a.stopPropagation(),a.preventDefault())},"normal.mousewheel readonly.mousewheel":function(a){if(a.originEvent.ctrlKey){var b=a.originEvent.wheelDelta,c=this;kity.Browser.mac||(b=-b),Math.abs(b)>100&&(clearTimeout(this._wheelZoomTimeout),this._wheelZoomTimeout=setTimeout(function(){c.getPaper()._zoom||1;0>b?c.execCommand("zoom-in"):b>0&&c.execCommand("zoom-out")},100),a.originEvent.preventDefault())}}}}}),KityMinder.registerModule("hyperlink",function(){var a="M16.614,10.224h-1.278c-1.668,0-3.07-1.07-3.599-2.556h4.877c0.707,0,1.278-0.571,1.278-1.278V3.834 c0-0.707-0.571-1.278-1.278-1.278h-4.877C12.266,1.071,13.668,0,15.336,0h1.278c2.116,0,3.834,1.716,3.834,3.834V6.39 C20.448,8.508,18.73,10.224,16.614,10.224z M5.112,5.112c0-0.707,0.573-1.278,1.278-1.278h7.668c0.707,0,1.278,0.571,1.278,1.278 S14.765,6.39,14.058,6.39H6.39C5.685,6.39,5.112,5.819,5.112,5.112z M2.556,3.834V6.39c0,0.707,0.573,1.278,1.278,1.278h4.877 c-0.528,1.486-1.932,2.556-3.599,2.556H3.834C1.716,10.224,0,8.508,0,6.39V3.834C0,1.716,1.716,0,3.834,0h1.278 c1.667,0,3.071,1.071,3.599,2.556H3.834C3.129,2.556,2.556,3.127,2.556,3.834z";return{commands:{hyperlink:kity.createClass("hyperlink",{base:Command,execute:function(a,b){var c=a.getSelectedNodes();utils.each(c,function(a,c){c.setData("hyperlink",b),c.render()}),a.layout()},queryState:function(a){var b=a.getSelectedNodes(),c=0;return 0===b.length?-1:(utils.each(b,function(a,b){return b&&b.getData("hyperlink")?(c=0,!1):void 0}),c)},queryValue:function(a){var b=a.getSelectedNode();return b.getData("hyperlink")}}),unhyperlink:kity.createClass("hyperlink",{base:Command,execute:function(a){var b=a.getSelectedNodes();utils.each(b,function(a,b){b.setData("hyperlink"),b.render()}),a.layout()},queryState:function(a){var b=a.getSelectedNodes();if(0===b.length)return-1;var c=!1;return utils.each(b,function(a,b){return b.getData("hyperlink")?(c=!0,!1):void 0}),c?0:-1}})},renderers:{right:kity.createClass("hyperlinkrender",{base:KityMinder.Renderer,create:function(){var b=new kity.HyperLink,c=new kity.Path,d=new kity.Rect(24,22,-2,-6,4).fill("rgba(255, 255, 255, 0)");return c.setPathData(a).fill("#666"),b.addShape(d),b.addShape(c),b.setTarget("_blank"),b.setStyle("cursor","pointer"),b.on("mouseover",function(){d.fill("rgba(255, 255, 200, .8)")}).on("mouseout",function(){d.fill("rgba(255, 255, 255, 0)")}),b},shouldRender:function(a){return a.getData("hyperlink")},update:function(a,b,c){var d=b.getData("hyperlink");a.setHref(d),a.setAttr("xlink:title",d);var e=b.getStyle("space-right");return a.setTranslate(c.right+e+2,-5),{x:c.right+e,y:-11,width:24,height:22}}})}}}),kity.extendClass(MinderNode,{arrange:function(a){var b=this.parent;if(b){var c=b.children;if(!(0>a||a>=c.length))return c.splice(this.getIndex(),1),c.splice(a,0,this),this}}});var ArrangeUpCommand=kity.createClass("ArrangeUpCommand",{base:Command,execute:function(a){var b=a.getSelectedNodes();b.sort(asc);var c=b.map(function(a){return a.getIndex()});b.forEach(function(a,b){a.arrange(c[b]-1)}),a.layout(300)},queryState:function(a){var b=a.getSelectedNode();return b?0:-1}}),ArrangeDownCommand=kity.createClass("ArrangeUpCommand",{base:Command,execute:function(a){var b=a.getSelectedNodes();b.sort(desc);var c=b.map(function(a){return a.getIndex()});b.forEach(function(a,b){a.arrange(c[b]+1)}),a.layout(300)},queryState:function(a){var b=a.getSelectedNode();return b?0:-1}}),ArrangeCommand=kity.createClass("ArrangeCommand",{base:Command,execute:function(a,b,c){if(b=b&&b.slice()||a.getSelectedNodes().slice(),b.length){var d=MinderNode.getCommonAncestor(b);if(d==b[0].parent){var e=b.map(function(a){return{index:a.getIndex(),node:a}}),f=Math.min.apply(Math,e.map(function(a){return a.index}))>=c;e.sort(function(a,b){return f?b.index-a.index:a.index-b.index}),e.forEach(function(a){a.node.arrange(c)}),a.layout(300)}}},queryState:function(a){var b=a.getSelectedNode();return b?0:-1}});KityMinder.registerModule("ArrangeModule",{commands:{arrangeup:ArrangeUpCommand,arrangedown:ArrangeDownCommand,arrange:ArrangeCommand},addShortcutKeys:{arrangeup:"alt+Up",arrangedown:"alt+Down"}}),KityMinder.registerModule("pasteModule",function(){function a(b,d){e.push(d),c.appendNode(d,b),d.render(),d.setLayoutOffset(null);for(var f,g=utils.cloneArr(d.children),h=0;f=g[h++];)a(d,f)}function b(a,b){d=[];for(var e,f=0;e=a[f++];)d.push(e.clone()),b&&!e.isRoot()&&c.removeNode(e)}var c=this,d=[],e=[],f=!1,g=!1;return{events:{"normal.keydown":function(h){var i=KityMinder.keymap,j=h.originEvent;if(j.ctrlKey||j.metaKey)switch(j.keyCode){case i.c:b(c.getSelectedAncestors(!0)),f=!0;break;case i.x:b(c.getSelectedAncestors(),!0),c.layout(300),g=!0;break;case i.v:if(d.length){var k=c.getSelectedNode();if(k){c.fire("saveScene");for(var l,m=0;l=d[m++];)a(k,l.clone());c.layout(300),c.select(e,!0),e=[],c.fire("saveScene")}}}}}}}),KityMinder.registerModule("StyleModule",function(){function a(a){for(var c=a.getData(),d=0;d<b.length;d++)if(b[d]in c)return!0}var b=["font-size","font-family","font-weight","font-style","background","color"],c=null;return{commands:{copystyle:kity.createClass("CopyStyleCommand",{base:Command,execute:function(a){var d=a.getSelectedNode(),e=d.getData();return c={},b.forEach(function(a){a in e?c[a]=e[a]:(c[a]=null,delete c[a])}),c},queryState:function(b){var c=b.getSelectedNodes();return 1!==c.length?-1:a(c[0])?0:-1}}),pastestyle:kity.createClass("PastStyleCommand",{base:Command,execute:function(a){return a.getSelectedNodes().forEach(function(a){for(var b in c)c.hasOwnProperty(b)&&a.setData(b,c[b])}),a.renderNodeBatch(a.getSelectedNodes()),a.layout(300),c},queryState:function(a){return c&&a.getSelectedNodes().length?0:-1}}),clearstyle:kity.createClass("ClearStyleCommand",{base:Command,execute:function(a){return a.getSelectedNodes().forEach(function(a){b.forEach(function(b){a.setData(b)})}),a.renderNodeBatch(a.getSelectedNodes()),a.layout(300),c},queryState:function(b){var c=b.getSelectedNodes();if(!c.length)return-1;for(var d=0;d<c.length;d++)if(a(c[d]))return 0;return-1}})}}}),KityMinder.registerProtocal("xmind",function(){var a={"priority-1":["priority",1],"priority-2":["priority",2],"priority-3":["priority",3],"priority-4":["priority",4],"priority-5":["priority",5],"priority-6":["priority",6],"priority-7":["priority",7],"priority-8":["priority",8],"task-start":["progress",1],"task-oct":["progress",2],"task-quarter":["progress",3],"task-3oct":["progress",4],"task-half":["progress",5],"task-5oct":["progress",6],"task-3quar":["progress",7],"task-7oct":["progress",8],"task-done":["progress",9]};return{fileDescription:"xmind格式文件",fileExtension:".xmind",decode:function(b){function c(b,d){if(d.data={text:b.title},b.marker_refs&&b.marker_refs.marker_ref){var e=b.marker_refs.marker_ref;if(e.length&&e.length>0)for(var f in e){var g=a[e[f].marker_id];g&&(d.data[g[0]]=g[1])}else{var g=a[e.marker_id];g&&(d.data[g[0]]=g[1])}}b["xlink:href"]&&(d.data.hyperlink=b["xlink:href"]);var h=b.children&&b.children.topics,i=h&&(h.topic||h[0]&&h[0].topic);if(i){var j=i;if(j.length&&j.length>0){d.children=[];for(var f in j)d.children.push({}),c(j[f],d.children[f])}else d.children=[{}],c(j,d.children[0])}}function d(a){var b=$.xml2json(a),d={},e=b.sheet,f=utils.isArray(e)?e[0].topic:e.topic;return c(f,d),d}function e(){g("ziperror")}function f(a,b){zip.createReader(new zip.BlobReader(a),function(a){a.getEntries(b)},e)}var g;return{then:function(a){return f(b,function(b){var c=!1;b.forEach(function(b){"content.xml"==b.filename&&(c=!0,b.getData(new zip.TextWriter,function(b){try{var c=d($.parseXML(b));a&&a(c)}catch(e){g&&g("parseerror")}}))}),!c&&g&&g("parseerror")}),this},error:function(a){g=a}}},recognizePriority:-1}}),KityMinder.registerProtocal("freemind",function(){function a(b,d){d.data={text:b.TEXT};var e;if(b.icon){var f,g=b.icon;if(g.length&&g.length>0)for(e in g)f=c[g[e].BUILTIN],f&&(d.data[f[0]]=f[1]);else f=c[g.BUILTIN],f&&(d.data[f[0]]=f[1])}if(b.LINK&&(d.data.hyperlink=b.LINK),b.node){var h=b.node;if(h.length&&h.length>0){d.children=[];for(e in h)d.children.push({}),a(h[e],d.children[e])}else d.children=[{}],a(h,d.children[0])}}function b(b){var c=$.xml2json(b),d={};return a(c.node,d),d}var c={"full-1":["priority",1],"full-2":["priority",2],"full-3":["priority",3],"full-4":["priority",4],"full-5":["priority",5],"full-6":["priority",6],"full-7":["priority",7],"full-8":["priority",8]};return{fileDescription:"freemind格式文件",fileExtension:".mm",decode:function(a){return b(a)},recognizePriority:-1}}),KityMinder.registerProtocal("mindmanager",function(){function a(b,c){if(c.data={text:b.Text&&b.Text.PlainText||""},b.Task){var d;b.Task.TaskPriority&&(d=g[b.Task.TaskPriority],d&&(c.data[d[0]]=d[1])),b.Task.TaskPercentage&&(d=g[b.Task.TaskPercentage],d&&(c.data[d[0]]=d[1]))}if(b.Hyperlink&&(c.data.hyperlink=b.Hyperlink.Url),b.SubTopics&&b.SubTopics.Topic){var e=b.SubTopics.Topic;if(e.length&&e.length>0){c.children=[];for(var f in e)c.children.push({}),a(e[f],c.children[f])}else c.children=[{}],a(e,c.children[0])}}function b(b){var c=$.xml2json(b),d={};return a(c.OneTopic.Topic,d),d}function c(){f("ziperror")}function d(a,b){zip.createReader(new zip.BlobReader(a),function(a){a.getEntries(b)},c)}var e,f,g={"urn:mindjet:Prio1":["PriorityIcon",1],"urn:mindjet:Prio2":["PriorityIcon",2],"urn:mindjet:Prio3":["PriorityIcon",3],"urn:mindjet:Prio4":["PriorityIcon",4],"urn:mindjet:Prio5":["PriorityIcon",5],0:["ProgressIcon",1],25:["ProgressIcon",2],50:["ProgressIcon",3],75:["ProgressIcon",4],100:["ProgressIcon",5]};return{fileDescription:"mindmanager格式文件",fileExtension:".mmap",decode:function(a){return{then:function(c){return e=c,d(a,function(a){var c=!1;a.forEach(function(a){"Document.xml"==a.filename&&(c=!0,a.getData(new zip.TextWriter,function(a){try{var c=b($.parseXML(a));e&&e(c)}catch(d){f&&f("parseerror")}}))}),!c&&f&&f("parseerror")}),this},error:function(a){f=a}}},recognizePriority:-1}}),KityMinder.registerProtocal("plain",function(){function a(a,b){for(var c="";b--;)c+=a;return c}function b(c,d){var e="";return d=d||0,e+=a(l,d),e+=c.data.text+j,c.children&&c.children.forEach(function(a){e+=b(a,d+1)}),e}function c(a){return!/\S/.test(a)}function d(a){for(var b=0;a.charAt(b)===l;)b++;return b}function e(a){return{data:{text:a.replace(new RegExp("^"+l+"*"),"")}}}function f(a){function b(a,b){var c=a.children||(a.children=[]);c.push(b)}for(var f,g,h,i,j={},l=a.split(k),m=0;m<l.length;m++)if(g=l[m],!c(g)){if(h=d(g),i=e(g),0===h){if(f)throw new Error("Invalid local format");f=i}else{if(!j[h-1])throw new Error("Invalid local format");b(j[h-1],i)}j[h]=i}return f}function g(a){if(!Utils.isString(a))return!1;h=a;try{i=f(a)}catch(b){i=null}return!!i}var h,i,j="\r",k=/\r\n|\r|\n/,l="	";return{fileDescription:"大纲文本",fileExtension:".txt",mineType:"text/plain",encode:function(a){return b(a,0)},decode:function(a){return h==a&&i?i:f(a)},recognize:g,recognizePriority:-1}}),KityMinder.registerProtocal("json",function(){function a(a,b){return"layout"==a||"shicon"==a?void 0:b}return{fileDescription:"KityMinder",fileExtension:".km",mineType:"application/json",encode:function(b){return JSON.stringify(b,a)},decode:function(a){return JSON.parse(a)},recognize:function(a){return Utils.isString(a)&&"{"==a.charAt(0)&&"}"==a.charAt(a.length-1)},recognizePriority:0}}),kity.Browser.ie||KityMinder.registerProtocal("png",function(){function a(a,b){var c=document.createElement("img");c.onload=b,c.src=a}return{fileDescription:"PNG 图片",fileExtension:".png",encode:function(b,c){function d(a,b){a.save(),a.fillStyle=b,a.fillRect(0,0,x.width,x.height),a.restore()}function e(a,b,c,d){a.drawImage(b,c,d)}function f(a){var b=a.toDataURL("png");return b}function g(){a(l,function(){var a,b=this;e(y,b,w,w),k.revokeObjectURL(l),a=f(x),m&&m(a)})}var h,i,j,k,l,m,n=(c._zoomValue,c.getPaper()),o=n.shapeNode.getAttribute("transform"),p=(n.container,c.getStyle("background").toString()),q=/url\((.+)\)/.exec(p),r=kity.Color.parse(p),s=c.getRenderContainer(),t=s.getRenderBox(),u=t.width+1,v=t.height+1,w=20,x=document.createElement("canvas"),y=x.getContext("2d");return n.shapeNode.setAttribute("transform","translate(0.5, 0.5)"),s.translate(-t.x,-t.y),h=n.container.innerHTML,s.translate(t.x,t.y),n.shapeNode.setAttribute("transform",o),i=$(h).filter("svg"),i.attr({width:t.width+1,height:t.height+1,style:'font-family: Arial, "Microsoft Yahei","Heiti SC";'}),h=$("<div></div>").append(i).html(),h=h.replace(/&nbsp;/g,"&#xa0;"),j=new Blob([h],{type:"image/svg+xml;charset=utf-8"}),k=window.URL||window.webkitURL||window,l=k.createObjectURL(j),x.width=u+2*w,x.height=v+2*w,q?a(q[1],function(){d(y,y.createPattern(this,"repeat")),g()}):(d(y,r.toString()),g()),{then:function(a){m=a}}},recognizePriority:-1}}),kity.Browser.ie||KityMinder.registerProtocal("svg",function(){return{fileDescription:"SVG 矢量图",fileExtension:".svg",mineType:"image/svg+xml",encode:function(a,b){var c,d,e=b.getPaper(),f=e.shapeNode.getAttribute("transform"),g=b.getRenderContainer(),h=g.getRenderBox(),i=(g.getTransform(),h.width),j=h.height,k=20;return e.shapeNode.setAttribute("transform","translate(0.5, 0.5)"),c=b.getPaper().container.innerHTML,e.shapeNode.setAttribute("transform",f),d=$(c).filter("svg"),d.attr({width:i+2*k|0,height:j+2*k|0,style:'font-family: Arial, "Microsoft Yahei",  "Heiti SC"; background: '+b.getStyle("background")}),d[0].setAttribute("viewBox",[h.x-k|0,h.y-k|0,i+2*k|0,j+2*k|0].join(" ")),c=$("<div></div>").append(d).html(),c=$("<div></div>").append(d).html(),c=c.replace(/&nbsp;/g,"&#xa0;")},recognizePriority:-1}}),!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){function c(a){var b=a.length,c=ab.type(a);return"function"===c||ab.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}function d(a,b,c){if(ab.isFunction(b))return ab.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return ab.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(hb.test(b))return ab.filter(b,a,c);b=ab.filter(b,a)}return ab.grep(a,function(a){return U.call(b,a)>=0!==c})}function e(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}function f(a){var b=ob[a]={};return ab.each(a.match(nb)||[],function(a,c){b[c]=!0}),b}function g(){$.removeEventListener("DOMContentLoaded",g,!1),a.removeEventListener("load",g,!1),ab.ready()}function h(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=ab.expando+Math.random()}function i(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(ub,"-$1").toLowerCase(),c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:tb.test(c)?ab.parseJSON(c):c}catch(e){}sb.set(a,b,c)}else c=void 0;return c}function j(){return!0}function k(){return!1}function l(){try{return $.activeElement}catch(a){}}function m(a,b){return ab.nodeName(a,"table")&&ab.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function n(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function o(a){var b=Kb.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function p(a,b){for(var c=0,d=a.length;d>c;c++)rb.set(a[c],"globalEval",!b||rb.get(b[c],"globalEval"))}function q(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(rb.hasData(a)&&(f=rb.access(a),g=rb.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;d>c;c++)ab.event.add(b,e,j[e][c])}sb.hasData(a)&&(h=sb.access(a),i=ab.extend({},h),sb.set(b,i))}}function r(a,b){var c=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&ab.nodeName(a,b)?ab.merge([a],c):c}function s(a,b){var c=b.nodeName.toLowerCase();"input"===c&&yb.test(a.type)?b.checked=a.checked:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}function t(b,c){var d=ab(c.createElement(b)).appendTo(c.body),e=a.getDefaultComputedStyle?a.getDefaultComputedStyle(d[0]).display:ab.css(d[0],"display");return d.detach(),e}function u(a){var b=$,c=Ob[a];return c||(c=t(a,b),"none"!==c&&c||(Nb=(Nb||ab("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=Nb[0].contentDocument,b.write(),b.close(),c=t(a,b),Nb.detach()),Ob[a]=c),c}function v(a,b,c){var d,e,f,g,h=a.style;return c=c||Rb(a),c&&(g=c.getPropertyValue(b)||c[b]),c&&(""!==g||ab.contains(a.ownerDocument,a)||(g=ab.style(a,b)),Qb.test(g)&&Pb.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g}function w(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}function x(a,b){if(b in a)return b;for(var c=b[0].toUpperCase()+b.slice(1),d=b,e=Xb.length;e--;)if(b=Xb[e]+c,b in a)return b;return d}function y(a,b,c){var d=Tb.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function z(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=ab.css(a,c+wb[f],!0,e)),d?("content"===c&&(g-=ab.css(a,"padding"+wb[f],!0,e)),"margin"!==c&&(g-=ab.css(a,"border"+wb[f]+"Width",!0,e))):(g+=ab.css(a,"padding"+wb[f],!0,e),"padding"!==c&&(g+=ab.css(a,"border"+wb[f]+"Width",!0,e)));return g}function A(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Rb(a),g="border-box"===ab.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=v(a,b,f),(0>e||null==e)&&(e=a.style[b]),Qb.test(e))return e;d=g&&(Z.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+z(a,b,c||(g?"border":"content"),d,f)+"px"}function B(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=rb.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&xb(d)&&(f[g]=rb.access(d,"olddisplay",u(d.nodeName)))):f[g]||(e=xb(d),(c&&"none"!==c||!e)&&rb.set(d,"olddisplay",e?c:ab.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function C(a,b,c,d,e){return new C.prototype.init(a,b,c,d,e)}function D(){return setTimeout(function(){Yb=void 0}),Yb=ab.now()}function E(a,b){var c,d=0,e={height:a};for(b=b?1:0;4>d;d+=2-b)c=wb[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function F(a,b,c){for(var d,e=(cc[b]||[]).concat(cc["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function G(a,b,c){var d,e,f,g,h,i,j,k=this,l={},m=a.style,n=a.nodeType&&xb(a),o=rb.get(a,"fxshow");c.queue||(h=ab._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,k.always(function(){k.always(function(){h.unqueued--,ab.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[m.overflow,m.overflowX,m.overflowY],j=ab.css(a,"display"),"none"===j&&(j=u(a.nodeName)),"inline"===j&&"none"===ab.css(a,"float")&&(m.display="inline-block")),c.overflow&&(m.overflow="hidden",k.always(function(){m.overflow=c.overflow[0],m.overflowX=c.overflow[1],m.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],$b.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(n?"hide":"show")){if("show"!==e||!o||void 0===o[d])continue;n=!0}l[d]=o&&o[d]||ab.style(a,d)}if(!ab.isEmptyObject(l)){o?"hidden"in o&&(n=o.hidden):o=rb.access(a,"fxshow",{}),f&&(o.hidden=!n),n?ab(a).show():k.done(function(){ab(a).hide()}),k.done(function(){var b;rb.remove(a,"fxshow");for(b in l)ab.style(a,b,l[b])});for(d in l)g=F(n?o[d]:0,d,k),d in o||(o[d]=g.start,n&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function H(a,b){var c,d,e,f,g;for(c in a)if(d=ab.camelCase(c),e=b[d],f=a[c],ab.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=ab.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function I(a,b,c){var d,e,f=0,g=bc.length,h=ab.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Yb||D(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:ab.extend({},b),opts:ab.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Yb||D(),duration:c.duration,tweens:[],createTween:function(b,c){var d=ab.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(H(k,j.opts.specialEasing);g>f;f++)if(d=bc[f].call(j,a,k,j.opts))return d;return ab.map(k,F,j),ab.isFunction(j.opts.start)&&j.opts.start.call(a,j),ab.fx.timer(ab.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function J(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(nb)||[];if(ab.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function K(a,b,c,d){function e(h){var i;return f[h]=!0,ab.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||g||f[j]?g?!(i=j):void 0:(b.dataTypes.unshift(j),e(j),!1)}),i}var f={},g=a===vc;return e(b.dataTypes[0])||!f["*"]&&e("*")}function L(a,b){var c,d,e=ab.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&ab.extend(!0,a,d),a}function M(a,b,c){for(var d,e,f,g,h=a.contents,i=a.dataTypes;"*"===i[0];)i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function N(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}function O(a,b,c,d){var e;if(ab.isArray(b))ab.each(b,function(b,e){c||zc.test(a)?d(a,e):O(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==ab.type(b))d(a,b);else for(e in b)O(a+"["+e+"]",b[e],c,d)}function P(a){return ab.isWindow(a)?a:9===a.nodeType&&a.defaultView}var Q=[],R=Q.slice,S=Q.concat,T=Q.push,U=Q.indexOf,V={},W=V.toString,X=V.hasOwnProperty,Y="".trim,Z={},$=a.document,_="2.1.0",ab=function(a,b){return new ab.fn.init(a,b)},bb=/^-ms-/,cb=/-([\da-z])/gi,db=function(a,b){return b.toUpperCase()};ab.fn=ab.prototype={jquery:_,constructor:ab,selector:"",length:0,toArray:function(){return R.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:R.call(this)},pushStack:function(a){var b=ab.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return ab.each(this,a,b)},map:function(a){return this.pushStack(ab.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(R.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:T,sort:Q.sort,splice:Q.splice},ab.extend=ab.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||ab.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(ab.isPlainObject(d)||(e=ab.isArray(d)))?(e?(e=!1,f=c&&ab.isArray(c)?c:[]):f=c&&ab.isPlainObject(c)?c:{},g[b]=ab.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},ab.extend({expando:"jQuery"+(_+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===ab.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return a-parseFloat(a)>=0},isPlainObject:function(a){if("object"!==ab.type(a)||a.nodeType||ab.isWindow(a))return!1;try{if(a.constructor&&!X.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(b){return!1}return!0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?V[W.call(a)]||"object":typeof a},globalEval:function(a){var b,c=eval;a=ab.trim(a),a&&(1===a.indexOf("use strict")?(b=$.createElement("script"),b.text=a,$.head.appendChild(b).parentNode.removeChild(b)):c(a))},camelCase:function(a){return a.replace(bb,"ms-").replace(cb,db)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,d){var e,f=0,g=a.length,h=c(a);if(d){if(h)for(;g>f&&(e=b.apply(a[f],d),e!==!1);f++);else for(f in a)if(e=b.apply(a[f],d),e===!1)break}else if(h)for(;g>f&&(e=b.call(a[f],f,a[f]),e!==!1);f++);else for(f in a)if(e=b.call(a[f],f,a[f]),e===!1)break;return a},trim:function(a){return null==a?"":Y.call(a)},makeArray:function(a,b){var d=b||[];return null!=a&&(c(Object(a))?ab.merge(d,"string"==typeof a?[a]:a):T.call(d,a)),d},inArray:function(a,b,c){return null==b?-1:U.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,d){var e,f=0,g=a.length,h=c(a),i=[];if(h)for(;g>f;f++)e=b(a[f],f,d),null!=e&&i.push(e);else for(f in a)e=b(a[f],f,d),null!=e&&i.push(e);return S.apply([],i)},guid:1,proxy:function(a,b){var c,d,e;return"string"==typeof b&&(c=a[b],b=a,a=c),ab.isFunction(a)?(d=R.call(arguments,2),e=function(){return a.apply(b||this,d.concat(R.call(arguments)))},e.guid=a.guid=a.guid||ab.guid++,e):void 0},now:Date.now,support:Z}),ab.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){V["[object "+b+"]"]=b.toLowerCase()});var eb=function(a){function b(a,b,c,d){var e,f,g,h,i,j,l,o,p,q;if((b?b.ownerDocument||b:O)!==G&&F(b),b=b||G,c=c||[],!a||"string"!=typeof a)return c;if(1!==(h=b.nodeType)&&9!==h)return[];if(I&&!d){if(e=sb.exec(a))if(g=e[1]){if(9===h){if(f=b.getElementById(g),!f||!f.parentNode)return c;if(f.id===g)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(g))&&M(b,f)&&f.id===g)return c.push(f),c}else{if(e[2])return _.apply(c,b.getElementsByTagName(a)),c;if((g=e[3])&&x.getElementsByClassName&&b.getElementsByClassName)return _.apply(c,b.getElementsByClassName(g)),c}if(x.qsa&&(!J||!J.test(a))){if(o=l=N,p=b,q=9===h&&a,1===h&&"object"!==b.nodeName.toLowerCase()){for(j=m(a),(l=b.getAttribute("id"))?o=l.replace(ub,"\\$&"):b.setAttribute("id",o),o="[id='"+o+"'] ",i=j.length;i--;)j[i]=o+n(j[i]);p=tb.test(a)&&k(b.parentNode)||b,q=j.join(",")}if(q)try{return _.apply(c,p.querySelectorAll(q)),c}catch(r){}finally{l||b.removeAttribute("id")}}}return v(a.replace(ib,"$1"),b,c,d)}function c(){function a(c,d){return b.push(c+" ")>y.cacheLength&&delete a[b.shift()],a[c+" "]=d}var b=[];return a}function d(a){return a[N]=!0,a}function e(a){var b=G.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function f(a,b){for(var c=a.split("|"),d=a.length;d--;)y.attrHandle[c[d]]=b}function g(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||W)-(~a.sourceIndex||W);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function h(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function i(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function j(a){return d(function(b){return b=+b,d(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function k(a){return a&&typeof a.getElementsByTagName!==V&&a}function l(){}function m(a,c){var d,e,f,g,h,i,j,k=S[a+" "];if(k)return c?0:k.slice(0);for(h=a,i=[],j=y.preFilter;h;){(!d||(e=jb.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),d=!1,(e=kb.exec(h))&&(d=e.shift(),f.push({value:d,type:e[0].replace(ib," ")}),h=h.slice(d.length));for(g in y.filter)!(e=ob[g].exec(h))||j[g]&&!(e=j[g](e))||(d=e.shift(),f.push({value:d,type:g,matches:e}),h=h.slice(d.length));if(!d)break}return c?h.length:h?b.error(a):S(a,i).slice(0)}function n(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function o(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=Q++;
return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[P,f];if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e){if(i=b[N]||(b[N]={}),(h=i[d])&&h[0]===P&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function p(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function q(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function r(a,b,c,e,f,g){return e&&!e[N]&&(e=r(e)),f&&!f[N]&&(f=r(f,g)),d(function(d,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=d||u(b||"*",h.nodeType?[h]:h,[]),r=!a||!d&&b?p:q(p,m,a,h,i),s=c?f||(d?a:o||e)?[]:g:r;if(c&&c(r,s,h,i),e)for(j=q(s,n),e(j,[],h,i),k=j.length;k--;)(l=j[k])&&(s[n[k]]=!(r[n[k]]=l));if(d){if(f||a){if(f){for(j=[],k=s.length;k--;)(l=s[k])&&j.push(r[k]=l);f(null,s=[],j,i)}for(k=s.length;k--;)(l=s[k])&&(j=f?bb.call(d,l):m[k])>-1&&(d[j]=!(g[j]=l))}}else s=q(s===g?s.splice(o,s.length):s),f?f(null,g,s,i):_.apply(g,s)})}function s(a){for(var b,c,d,e=a.length,f=y.relative[a[0].type],g=f||y.relative[" "],h=f?1:0,i=o(function(a){return a===b},g,!0),j=o(function(a){return bb.call(b,a)>-1},g,!0),k=[function(a,c,d){return!f&&(d||c!==C)||((b=c).nodeType?i(a,c,d):j(a,c,d))}];e>h;h++)if(c=y.relative[a[h].type])k=[o(p(k),c)];else{if(c=y.filter[a[h].type].apply(null,a[h].matches),c[N]){for(d=++h;e>d&&!y.relative[a[d].type];d++);return r(h>1&&p(k),h>1&&n(a.slice(0,h-1).concat({value:" "===a[h-2].type?"*":""})).replace(ib,"$1"),c,d>h&&s(a.slice(h,d)),e>d&&s(a=a.slice(d)),e>d&&n(a))}k.push(c)}return p(k)}function t(a,c){var e=c.length>0,f=a.length>0,g=function(d,g,h,i,j){var k,l,m,n=0,o="0",p=d&&[],r=[],s=C,t=d||f&&y.find.TAG("*",j),u=P+=null==s?1:Math.random()||.1,v=t.length;for(j&&(C=g!==G&&g);o!==v&&null!=(k=t[o]);o++){if(f&&k){for(l=0;m=a[l++];)if(m(k,g,h)){i.push(k);break}j&&(P=u)}e&&((k=!m&&k)&&n--,d&&p.push(k))}if(n+=o,e&&o!==n){for(l=0;m=c[l++];)m(p,r,g,h);if(d){if(n>0)for(;o--;)p[o]||r[o]||(r[o]=Z.call(i));r=q(r)}_.apply(i,r),j&&!d&&r.length>0&&n+c.length>1&&b.uniqueSort(i)}return j&&(P=u,C=s),p};return e?d(g):g}function u(a,c,d){for(var e=0,f=c.length;f>e;e++)b(a,c[e],d);return d}function v(a,b,c,d){var e,f,g,h,i,j=m(a);if(!d&&1===j.length){if(f=j[0]=j[0].slice(0),f.length>2&&"ID"===(g=f[0]).type&&x.getById&&9===b.nodeType&&I&&y.relative[f[1].type]){if(b=(y.find.ID(g.matches[0].replace(vb,wb),b)||[])[0],!b)return c;a=a.slice(f.shift().value.length)}for(e=ob.needsContext.test(a)?0:f.length;e--&&(g=f[e],!y.relative[h=g.type]);)if((i=y.find[h])&&(d=i(g.matches[0].replace(vb,wb),tb.test(f[0].type)&&k(b.parentNode)||b))){if(f.splice(e,1),a=d.length&&n(f),!a)return _.apply(c,d),c;break}}return B(a,j)(d,b,!I,c,tb.test(a)&&k(b.parentNode)||b),c}var w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N="sizzle"+-new Date,O=a.document,P=0,Q=0,R=c(),S=c(),T=c(),U=function(a,b){return a===b&&(E=!0),0},V="undefined",W=1<<31,X={}.hasOwnProperty,Y=[],Z=Y.pop,$=Y.push,_=Y.push,ab=Y.slice,bb=Y.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},cb="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",db="[\\x20\\t\\r\\n\\f]",eb="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",fb=eb.replace("w","w#"),gb="\\["+db+"*("+eb+")"+db+"*(?:([*^$|!~]?=)"+db+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+fb+")|)|)"+db+"*\\]",hb=":("+eb+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+gb.replace(3,8)+")*)|.*)\\)|)",ib=new RegExp("^"+db+"+|((?:^|[^\\\\])(?:\\\\.)*)"+db+"+$","g"),jb=new RegExp("^"+db+"*,"+db+"*"),kb=new RegExp("^"+db+"*([>+~]|"+db+")"+db+"*"),lb=new RegExp("="+db+"*([^\\]'\"]*?)"+db+"*\\]","g"),mb=new RegExp(hb),nb=new RegExp("^"+fb+"$"),ob={ID:new RegExp("^#("+eb+")"),CLASS:new RegExp("^\\.("+eb+")"),TAG:new RegExp("^("+eb.replace("w","w*")+")"),ATTR:new RegExp("^"+gb),PSEUDO:new RegExp("^"+hb),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+db+"*(even|odd|(([+-]|)(\\d*)n|)"+db+"*(?:([+-]|)"+db+"*(\\d+)|))"+db+"*\\)|)","i"),bool:new RegExp("^(?:"+cb+")$","i"),needsContext:new RegExp("^"+db+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+db+"*((?:-\\d)?\\d*)"+db+"*\\)|)(?=[^-]|$)","i")},pb=/^(?:input|select|textarea|button)$/i,qb=/^h\d$/i,rb=/^[^{]+\{\s*\[native \w/,sb=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tb=/[+~]/,ub=/'|\\/g,vb=new RegExp("\\\\([\\da-f]{1,6}"+db+"?|("+db+")|.)","ig"),wb=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)};try{_.apply(Y=ab.call(O.childNodes),O.childNodes),Y[O.childNodes.length].nodeType}catch(xb){_={apply:Y.length?function(a,b){$.apply(a,ab.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}x=b.support={},A=b.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},F=b.setDocument=function(a){var b,c=a?a.ownerDocument||a:O,d=c.defaultView;return c!==G&&9===c.nodeType&&c.documentElement?(G=c,H=c.documentElement,I=!A(c),d&&d!==d.top&&(d.addEventListener?d.addEventListener("unload",function(){F()},!1):d.attachEvent&&d.attachEvent("onunload",function(){F()})),x.attributes=e(function(a){return a.className="i",!a.getAttribute("className")}),x.getElementsByTagName=e(function(a){return a.appendChild(c.createComment("")),!a.getElementsByTagName("*").length}),x.getElementsByClassName=rb.test(c.getElementsByClassName)&&e(function(a){return a.innerHTML="<div class='a'></div><div class='a i'></div>",a.firstChild.className="i",2===a.getElementsByClassName("i").length}),x.getById=e(function(a){return H.appendChild(a).id=N,!c.getElementsByName||!c.getElementsByName(N).length}),x.getById?(y.find.ID=function(a,b){if(typeof b.getElementById!==V&&I){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},y.filter.ID=function(a){var b=a.replace(vb,wb);return function(a){return a.getAttribute("id")===b}}):(delete y.find.ID,y.filter.ID=function(a){var b=a.replace(vb,wb);return function(a){var c=typeof a.getAttributeNode!==V&&a.getAttributeNode("id");return c&&c.value===b}}),y.find.TAG=x.getElementsByTagName?function(a,b){return typeof b.getElementsByTagName!==V?b.getElementsByTagName(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},y.find.CLASS=x.getElementsByClassName&&function(a,b){return typeof b.getElementsByClassName!==V&&I?b.getElementsByClassName(a):void 0},K=[],J=[],(x.qsa=rb.test(c.querySelectorAll))&&(e(function(a){a.innerHTML="<select t=''><option selected=''></option></select>",a.querySelectorAll("[t^='']").length&&J.push("[*^$]="+db+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||J.push("\\["+db+"*(?:value|"+cb+")"),a.querySelectorAll(":checked").length||J.push(":checked")}),e(function(a){var b=c.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&J.push("name"+db+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||J.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),J.push(",.*:")})),(x.matchesSelector=rb.test(L=H.webkitMatchesSelector||H.mozMatchesSelector||H.oMatchesSelector||H.msMatchesSelector))&&e(function(a){x.disconnectedMatch=L.call(a,"div"),L.call(a,"[s!='']:x"),K.push("!=",hb)}),J=J.length&&new RegExp(J.join("|")),K=K.length&&new RegExp(K.join("|")),b=rb.test(H.compareDocumentPosition),M=b||rb.test(H.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},U=b?function(a,b){if(a===b)return E=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!x.sortDetached&&b.compareDocumentPosition(a)===d?a===c||a.ownerDocument===O&&M(O,a)?-1:b===c||b.ownerDocument===O&&M(O,b)?1:D?bb.call(D,a)-bb.call(D,b):0:4&d?-1:1)}:function(a,b){if(a===b)return E=!0,0;var d,e=0,f=a.parentNode,h=b.parentNode,i=[a],j=[b];if(!f||!h)return a===c?-1:b===c?1:f?-1:h?1:D?bb.call(D,a)-bb.call(D,b):0;if(f===h)return g(a,b);for(d=a;d=d.parentNode;)i.unshift(d);for(d=b;d=d.parentNode;)j.unshift(d);for(;i[e]===j[e];)e++;return e?g(i[e],j[e]):i[e]===O?-1:j[e]===O?1:0},c):G},b.matches=function(a,c){return b(a,null,null,c)},b.matchesSelector=function(a,c){if((a.ownerDocument||a)!==G&&F(a),c=c.replace(lb,"='$1']"),!(!x.matchesSelector||!I||K&&K.test(c)||J&&J.test(c)))try{var d=L.call(a,c);if(d||x.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return b(c,G,null,[a]).length>0},b.contains=function(a,b){return(a.ownerDocument||a)!==G&&F(a),M(a,b)},b.attr=function(a,b){(a.ownerDocument||a)!==G&&F(a);var c=y.attrHandle[b.toLowerCase()],d=c&&X.call(y.attrHandle,b.toLowerCase())?c(a,b,!I):void 0;return void 0!==d?d:x.attributes||!I?a.getAttribute(b):(d=a.getAttributeNode(b))&&d.specified?d.value:null},b.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},b.uniqueSort=function(a){var b,c=[],d=0,e=0;if(E=!x.detectDuplicates,D=!x.sortStable&&a.slice(0),a.sort(U),E){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}return D=null,a},z=b.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(1===e||9===e||11===e){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=z(a)}else if(3===e||4===e)return a.nodeValue}else for(;b=a[d++];)c+=z(b);return c},y=b.selectors={cacheLength:50,createPseudo:d,match:ob,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(vb,wb),a[3]=(a[4]||a[5]||"").replace(vb,wb),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||b.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&b.error(a[0]),a},PSEUDO:function(a){var b,c=!a[5]&&a[2];return ob.CHILD.test(a[0])?null:(a[3]&&void 0!==a[4]?a[2]=a[4]:c&&mb.test(c)&&(b=m(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(vb,wb).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=R[a+" "];return b||(b=new RegExp("(^|"+db+")"+a+"("+db+"|$)"))&&R(a,function(a){return b.test("string"==typeof a.className&&a.className||typeof a.getAttribute!==V&&a.getAttribute("class")||"")})},ATTR:function(a,c,d){return function(e){var f=b.attr(e,a);return null==f?"!="===c:c?(f+="","="===c?f===d:"!="===c?f!==d:"^="===c?d&&0===f.indexOf(d):"*="===c?d&&f.indexOf(d)>-1:"$="===c?d&&f.slice(-d.length)===d:"~="===c?(" "+f+" ").indexOf(d)>-1:"|="===c?f===d||f.slice(0,d.length+1)===d+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){for(;p;){for(l=b;l=l[p];)if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(k=q[N]||(q[N]={}),j=k[a]||[],n=j[0]===P&&j[1],m=j[0]===P&&j[2],l=n&&q.childNodes[n];l=++n&&l&&l[p]||(m=n=0)||o.pop();)if(1===l.nodeType&&++m&&l===b){k[a]=[P,n,m];break}}else if(s&&(j=(b[N]||(b[N]={}))[a])&&j[0]===P)m=j[1];else for(;(l=++n&&l&&l[p]||(m=n=0)||o.pop())&&((h?l.nodeName.toLowerCase()!==r:1!==l.nodeType)||!++m||(s&&((l[N]||(l[N]={}))[a]=[P,m]),l!==b)););return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,c){var e,f=y.pseudos[a]||y.setFilters[a.toLowerCase()]||b.error("unsupported pseudo: "+a);return f[N]?f(c):f.length>1?(e=[a,a,"",c],y.setFilters.hasOwnProperty(a.toLowerCase())?d(function(a,b){for(var d,e=f(a,c),g=e.length;g--;)d=bb.call(a,e[g]),a[d]=!(b[d]=e[g])}):function(a){return f(a,0,e)}):f}},pseudos:{not:d(function(a){var b=[],c=[],e=B(a.replace(ib,"$1"));return e[N]?d(function(a,b,c,d){for(var f,g=e(a,null,d,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,d,f){return b[0]=a,e(b,null,f,c),!c.pop()}}),has:d(function(a){return function(c){return b(a,c).length>0}}),contains:d(function(a){return function(b){return(b.textContent||b.innerText||z(b)).indexOf(a)>-1}}),lang:d(function(a){return nb.test(a||"")||b.error("unsupported lang: "+a),a=a.replace(vb,wb).toLowerCase(),function(b){var c;do if(c=I?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===H},focus:function(a){return a===G.activeElement&&(!G.hasFocus||G.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!y.pseudos.empty(a)},header:function(a){return qb.test(a.nodeName)},input:function(a){return pb.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:j(function(){return[0]}),last:j(function(a,b){return[b-1]}),eq:j(function(a,b,c){return[0>c?c+b:c]}),even:j(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:j(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:j(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:j(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},y.pseudos.nth=y.pseudos.eq;for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})y.pseudos[w]=h(w);for(w in{submit:!0,reset:!0})y.pseudos[w]=i(w);return l.prototype=y.filters=y.pseudos,y.setFilters=new l,B=b.compile=function(a,b){var c,d=[],e=[],f=T[a+" "];if(!f){for(b||(b=m(a)),c=b.length;c--;)f=s(b[c]),f[N]?d.push(f):e.push(f);f=T(a,t(e,d))}return f},x.sortStable=N.split("").sort(U).join("")===N,x.detectDuplicates=!!E,F(),x.sortDetached=e(function(a){return 1&a.compareDocumentPosition(G.createElement("div"))}),e(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||f("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),x.attributes&&e(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||f("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),e(function(a){return null==a.getAttribute("disabled")})||f(cb,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),b}(a);ab.find=eb,ab.expr=eb.selectors,ab.expr[":"]=ab.expr.pseudos,ab.unique=eb.uniqueSort,ab.text=eb.getText,ab.isXMLDoc=eb.isXML,ab.contains=eb.contains;var fb=ab.expr.match.needsContext,gb=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,hb=/^.[^:#\[\.,]*$/;ab.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?ab.find.matchesSelector(d,a)?[d]:[]:ab.find.matches(a,ab.grep(b,function(a){return 1===a.nodeType}))},ab.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!=typeof a)return this.pushStack(ab(a).filter(function(){for(b=0;c>b;b++)if(ab.contains(e[b],this))return!0}));for(b=0;c>b;b++)ab.find(a,e[b],d);return d=this.pushStack(c>1?ab.unique(d):d),d.selector=this.selector?this.selector+" "+a:a,d},filter:function(a){return this.pushStack(d(this,a||[],!1))},not:function(a){return this.pushStack(d(this,a||[],!0))},is:function(a){return!!d(this,"string"==typeof a&&fb.test(a)?ab(a):a||[],!1).length}});var ib,jb=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,kb=ab.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:jb.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||ib).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof ab?b[0]:b,ab.merge(this,ab.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:$,!0)),gb.test(c[1])&&ab.isPlainObject(b))for(c in b)ab.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}return d=$.getElementById(c[2]),d&&d.parentNode&&(this.length=1,this[0]=d),this.context=$,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):ab.isFunction(a)?"undefined"!=typeof ib.ready?ib.ready(a):a(ab):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),ab.makeArray(a,this))};kb.prototype=ab.fn,ib=ab($);var lb=/^(?:parents|prev(?:Until|All))/,mb={children:!0,contents:!0,next:!0,prev:!0};ab.extend({dir:function(a,b,c){for(var d=[],e=void 0!==c;(a=a[b])&&9!==a.nodeType;)if(1===a.nodeType){if(e&&ab(a).is(c))break;d.push(a)}return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),ab.fn.extend({has:function(a){var b=ab(a,this),c=b.length;return this.filter(function(){for(var a=0;c>a;a++)if(ab.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=fb.test(a)||"string"!=typeof a?ab(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&ab.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?ab.unique(f):f)},index:function(a){return a?"string"==typeof a?U.call(ab(a),this[0]):U.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(ab.unique(ab.merge(this.get(),ab(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),ab.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return ab.dir(a,"parentNode")},parentsUntil:function(a,b,c){return ab.dir(a,"parentNode",c)},next:function(a){return e(a,"nextSibling")},prev:function(a){return e(a,"previousSibling")},nextAll:function(a){return ab.dir(a,"nextSibling")},prevAll:function(a){return ab.dir(a,"previousSibling")},nextUntil:function(a,b,c){return ab.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return ab.dir(a,"previousSibling",c)},siblings:function(a){return ab.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return ab.sibling(a.firstChild)},contents:function(a){return a.contentDocument||ab.merge([],a.childNodes)}},function(a,b){ab.fn[a]=function(c,d){var e=ab.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=ab.filter(d,e)),this.length>1&&(mb[a]||ab.unique(e),lb.test(a)&&e.reverse()),this.pushStack(e)}});var nb=/\S+/g,ob={};ab.Callbacks=function(a){a="string"==typeof a?ob[a]||f(a):ab.extend({},a);var b,c,d,e,g,h,i=[],j=!a.once&&[],k=function(f){for(b=a.memory&&f,c=!0,h=e||0,e=0,g=i.length,d=!0;i&&g>h;h++)if(i[h].apply(f[0],f[1])===!1&&a.stopOnFalse){b=!1;break}d=!1,i&&(j?j.length&&k(j.shift()):b?i=[]:l.disable())},l={add:function(){if(i){var c=i.length;!function f(b){ab.each(b,function(b,c){var d=ab.type(c);"function"===d?a.unique&&l.has(c)||i.push(c):c&&c.length&&"string"!==d&&f(c)})}(arguments),d?g=i.length:b&&(e=c,k(b))}return this},remove:function(){return i&&ab.each(arguments,function(a,b){for(var c;(c=ab.inArray(b,i,c))>-1;)i.splice(c,1),d&&(g>=c&&g--,h>=c&&h--)}),this},has:function(a){return a?ab.inArray(a,i)>-1:!(!i||!i.length)},empty:function(){return i=[],g=0,this},disable:function(){return i=j=b=void 0,this},disabled:function(){return!i},lock:function(){return j=void 0,b||l.disable(),this},locked:function(){return!j},fireWith:function(a,b){return!i||c&&!j||(b=b||[],b=[a,b.slice?b.slice():b],d?j.push(b):k(b)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!c}};return l},ab.extend({Deferred:function(a){var b=[["resolve","done",ab.Callbacks("once memory"),"resolved"],["reject","fail",ab.Callbacks("once memory"),"rejected"],["notify","progress",ab.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return ab.Deferred(function(c){ab.each(b,function(b,f){var g=ab.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&ab.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?ab.extend(a,d):d}},e={};return d.pipe=d.then,ab.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b,c,d,e=0,f=R.call(arguments),g=f.length,h=1!==g||a&&ab.isFunction(a.promise)?g:0,i=1===h?a:ab.Deferred(),j=function(a,c,d){return function(e){c[a]=this,d[a]=arguments.length>1?R.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=new Array(g),c=new Array(g),d=new Array(g);g>e;e++)f[e]&&ab.isFunction(f[e].promise)?f[e].promise().done(j(e,d,f)).fail(i.reject).progress(j(e,c,b)):--h;return h||i.resolveWith(d,f),i.promise()}});var pb;ab.fn.ready=function(a){return ab.ready.promise().done(a),this},ab.extend({isReady:!1,readyWait:1,holdReady:function(a){a?ab.readyWait++:ab.ready(!0)},ready:function(a){(a===!0?--ab.readyWait:ab.isReady)||(ab.isReady=!0,a!==!0&&--ab.readyWait>0||(pb.resolveWith($,[ab]),ab.fn.trigger&&ab($).trigger("ready").off("ready")))}}),ab.ready.promise=function(b){return pb||(pb=ab.Deferred(),"complete"===$.readyState?setTimeout(ab.ready):($.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1))),pb.promise(b)},ab.ready.promise();var qb=ab.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===ab.type(c)){e=!0;for(h in c)ab.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,ab.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(ab(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f};ab.acceptData=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType},h.uid=1,h.accepts=ab.acceptData,h.prototype={key:function(a){if(!h.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=h.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,b)}catch(d){b[this.expando]=c,ab.extend(a,b)}}return this.cache[c]||(this.cache[c]={}),c},set:function(a,b,c){var d,e=this.key(a),f=this.cache[e];if("string"==typeof b)f[b]=c;else if(ab.isEmptyObject(f))ab.extend(this.cache[e],b);else for(d in b)f[d]=b[d];return f},get:function(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b]},access:function(a,b,c){var d;return void 0===b||b&&"string"==typeof b&&void 0===c?(d=this.get(a,b),void 0!==d?d:this.get(a,ab.camelCase(b))):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d,e,f=this.key(a),g=this.cache[f];if(void 0===b)this.cache[f]={};else{ab.isArray(b)?d=b.concat(b.map(ab.camelCase)):(e=ab.camelCase(b),b in g?d=[b,e]:(d=e,d=d in g?[d]:d.match(nb)||[])),c=d.length;for(;c--;)delete g[d[c]]}},hasData:function(a){return!ab.isEmptyObject(this.cache[a[this.expando]]||{})},discard:function(a){a[this.expando]&&delete this.cache[a[this.expando]]}};var rb=new h,sb=new h,tb=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ub=/([A-Z])/g;ab.extend({hasData:function(a){return sb.hasData(a)||rb.hasData(a)},data:function(a,b,c){return sb.access(a,b,c)},removeData:function(a,b){sb.remove(a,b)},_data:function(a,b,c){return rb.access(a,b,c)},_removeData:function(a,b){rb.remove(a,b)}}),ab.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=sb.get(f),1===f.nodeType&&!rb.get(f,"hasDataAttrs"))){for(c=g.length;c--;)d=g[c].name,0===d.indexOf("data-")&&(d=ab.camelCase(d.slice(5)),i(f,d,e[d]));rb.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){sb.set(this,a)}):qb(this,function(b){var c,d=ab.camelCase(a);if(f&&void 0===b){if(c=sb.get(f,a),void 0!==c)return c;if(c=sb.get(f,d),void 0!==c)return c;if(c=i(f,d,void 0),void 0!==c)return c}else this.each(function(){var c=sb.get(this,d);sb.set(this,d,b),-1!==a.indexOf("-")&&void 0!==c&&sb.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){sb.remove(this,a)})}}),ab.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=rb.get(a,b),c&&(!d||ab.isArray(c)?d=rb.access(a,b,ab.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=ab.queue(a,b),d=c.length,e=c.shift(),f=ab._queueHooks(a,b),g=function(){ab.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return rb.get(a,c)||rb.access(a,c,{empty:ab.Callbacks("once memory").add(function(){rb.remove(a,[b+"queue",c])})})}}),ab.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?ab.queue(this[0],a):void 0===b?this:this.each(function(){var c=ab.queue(this,a,b);ab._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&ab.dequeue(this,a)})},dequeue:function(a){return this.each(function(){ab.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=ab.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};for("string"!=typeof a&&(b=a,a=void 0),a=a||"fx";g--;)c=rb.get(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var vb=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,wb=["Top","Right","Bottom","Left"],xb=function(a,b){return a=b||a,"none"===ab.css(a,"display")||!ab.contains(a.ownerDocument,a)},yb=/^(?:checkbox|radio)$/i;!function(){var a=$.createDocumentFragment(),b=a.appendChild($.createElement("div"));b.innerHTML="<input type='radio' checked='checked' name='t'/>",Z.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",Z.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var zb="undefined";Z.focusinBubbles="onfocusin"in a;var Ab=/^key/,Bb=/^(?:mouse|contextmenu)|click/,Cb=/^(?:focusinfocus|focusoutblur)$/,Db=/^([^.]*)(?:\.(.+)|)$/;ab.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=rb.get(a);if(q)for(c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=ab.guid++),(i=q.events)||(i=q.events={}),(g=q.handle)||(g=q.handle=function(b){return typeof ab!==zb&&ab.event.triggered!==b.type?ab.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(nb)||[""],j=b.length;j--;)h=Db.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n&&(l=ab.event.special[n]||{},n=(e?l.delegateType:l.bindType)||n,l=ab.event.special[n]||{},k=ab.extend({type:n,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&ab.expr.match.needsContext.test(e),namespace:o.join(".")},f),(m=i[n])||(m=i[n]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,o,g)!==!1||a.addEventListener&&a.addEventListener(n,g,!1)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),ab.event.global[n]=!0)},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=rb.hasData(a)&&rb.get(a);if(q&&(i=q.events)){for(b=(b||"").match(nb)||[""],j=b.length;j--;)if(h=Db.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){for(l=ab.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=i[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;f--;)k=m[f],!e&&p!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&l.teardown.call(a,o,q.handle)!==!1||ab.removeEvent(a,n,q.handle),delete i[n])}else for(n in i)ab.event.remove(a,n+b[j],c,d,!0);ab.isEmptyObject(i)&&(delete q.handle,rb.remove(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,j,k,l,m=[d||$],n=X.call(b,"type")?b.type:b,o=X.call(b,"namespace")?b.namespace.split("."):[];if(g=h=d=d||$,3!==d.nodeType&&8!==d.nodeType&&!Cb.test(n+ab.event.triggered)&&(n.indexOf(".")>=0&&(o=n.split("."),n=o.shift(),o.sort()),j=n.indexOf(":")<0&&"on"+n,b=b[ab.expando]?b:new ab.Event(n,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=o.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:ab.makeArray(c,[b]),l=ab.event.special[n]||{},e||!l.trigger||l.trigger.apply(d,c)!==!1)){if(!e&&!l.noBubble&&!ab.isWindow(d)){for(i=l.delegateType||n,Cb.test(i+n)||(g=g.parentNode);g;g=g.parentNode)m.push(g),h=g;h===(d.ownerDocument||$)&&m.push(h.defaultView||h.parentWindow||a)}for(f=0;(g=m[f++])&&!b.isPropagationStopped();)b.type=f>1?i:l.bindType||n,k=(rb.get(g,"events")||{})[b.type]&&rb.get(g,"handle"),k&&k.apply(g,c),k=j&&g[j],k&&k.apply&&ab.acceptData(g)&&(b.result=k.apply(g,c),b.result===!1&&b.preventDefault());return b.type=n,e||b.isDefaultPrevented()||l._default&&l._default.apply(m.pop(),c)!==!1||!ab.acceptData(d)||j&&ab.isFunction(d[n])&&!ab.isWindow(d)&&(h=d[j],h&&(d[j]=null),ab.event.triggered=n,d[n](),ab.event.triggered=void 0,h&&(d[j]=h)),b.result}},dispatch:function(a){a=ab.event.fix(a);var b,c,d,e,f,g=[],h=R.call(arguments),i=(rb.get(this,"events")||{})[a.type]||[],j=ab.event.special[a.type]||{};if(h[0]=a,a.delegateTarget=this,!j.preDispatch||j.preDispatch.call(this,a)!==!1){for(g=ab.event.handlers.call(this,a,i),b=0;(e=g[b++])&&!a.isPropagationStopped();)for(a.currentTarget=e.elem,c=0;(f=e.handlers[c++])&&!a.isImmediatePropagationStopped();)(!a.namespace_re||a.namespace_re.test(f.namespace))&&(a.handleObj=f,a.data=f.data,d=((ab.event.special[f.origType]||{}).handle||f.handler).apply(e.elem,h),void 0!==d&&(a.result=d)===!1&&(a.preventDefault(),a.stopPropagation()));return j.postDispatch&&j.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!==this;i=i.parentNode||this)if(i.disabled!==!0||"click"!==a.type){for(d=[],c=0;h>c;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?ab(e,this).index(i)>=0:ab.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button;return null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||$,d=c.documentElement,e=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),a.pageY=b.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a
}},fix:function(a){if(a[ab.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];for(g||(this.fixHooks[e]=g=Bb.test(e)?this.mouseHooks:Ab.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new ab.Event(f),b=d.length;b--;)c=d[b],a[c]=f[c];return a.target||(a.target=$),3===a.target.nodeType&&(a.target=a.target.parentNode),g.filter?g.filter(a,f):a},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==l()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===l()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&ab.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(a){return ab.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=ab.extend(new ab.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?ab.event.trigger(e,null,b):ab.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},ab.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)},ab.Event=function(a,b){return this instanceof ab.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.getPreventDefault&&a.getPreventDefault()?j:k):this.type=a,b&&ab.extend(this,b),this.timeStamp=a&&a.timeStamp||ab.now(),void(this[ab.expando]=!0)):new ab.Event(a,b)},ab.Event.prototype={isDefaultPrevented:k,isPropagationStopped:k,isImmediatePropagationStopped:k,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=j,a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=j,a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=j,this.stopPropagation()}},ab.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){ab.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!ab.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),Z.focusinBubbles||ab.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){ab.event.simulate(b,a.target,ab.event.fix(a),!0)};ab.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=rb.access(d,b);e||d.addEventListener(a,c,!0),rb.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=rb.access(d,b)-1;e?rb.access(d,b,e):(d.removeEventListener(a,c,!0),rb.remove(d,b))}}}),ab.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(g in a)this.on(g,b,c,a[g],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=k;else if(!d)return this;return 1===e&&(f=d,d=function(a){return ab().off(a),f.apply(this,arguments)},d.guid=f.guid||(f.guid=ab.guid++)),this.each(function(){ab.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,ab(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=k),this.each(function(){ab.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){ab.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?ab.event.trigger(a,b,c,!0):void 0}});var Eb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Fb=/<([\w:]+)/,Gb=/<|&#?\w+;/,Hb=/<(?:script|style|link)/i,Ib=/checked\s*(?:[^=]|=\s*.checked.)/i,Jb=/^$|\/(?:java|ecma)script/i,Kb=/^true\/(.*)/,Lb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Mb={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Mb.optgroup=Mb.option,Mb.tbody=Mb.tfoot=Mb.colgroup=Mb.caption=Mb.thead,Mb.th=Mb.td,ab.extend({clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=ab.contains(a.ownerDocument,a);if(!(Z.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||ab.isXMLDoc(a)))for(g=r(h),f=r(a),d=0,e=f.length;e>d;d++)s(f[d],g[d]);if(b)if(c)for(f=f||r(a),g=g||r(h),d=0,e=f.length;e>d;d++)q(f[d],g[d]);else q(a,h);return g=r(h,"script"),g.length>0&&p(g,!i&&r(a,"script")),h},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k=b.createDocumentFragment(),l=[],m=0,n=a.length;n>m;m++)if(e=a[m],e||0===e)if("object"===ab.type(e))ab.merge(l,e.nodeType?[e]:e);else if(Gb.test(e)){for(f=f||k.appendChild(b.createElement("div")),g=(Fb.exec(e)||["",""])[1].toLowerCase(),h=Mb[g]||Mb._default,f.innerHTML=h[1]+e.replace(Eb,"<$1></$2>")+h[2],j=h[0];j--;)f=f.lastChild;ab.merge(l,f.childNodes),f=k.firstChild,f.textContent=""}else l.push(b.createTextNode(e));for(k.textContent="",m=0;e=l[m++];)if((!d||-1===ab.inArray(e,d))&&(i=ab.contains(e.ownerDocument,e),f=r(k.appendChild(e),"script"),i&&p(f),c))for(j=0;e=f[j++];)Jb.test(e.type||"")&&c.push(e);return k},cleanData:function(a){for(var b,c,d,e,f,g,h=ab.event.special,i=0;void 0!==(c=a[i]);i++){if(ab.acceptData(c)&&(f=c[rb.expando],f&&(b=rb.cache[f]))){if(d=Object.keys(b.events||{}),d.length)for(g=0;void 0!==(e=d[g]);g++)h[e]?ab.event.remove(c,e):ab.removeEvent(c,e,b.handle);rb.cache[f]&&delete rb.cache[f]}delete sb.cache[c[sb.expando]]}}}),ab.fn.extend({text:function(a){return qb(this,function(a){return void 0===a?ab.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=a)})},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=m(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=m(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?ab.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||ab.cleanData(r(c)),c.parentNode&&(b&&ab.contains(c.ownerDocument,c)&&p(r(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(ab.cleanData(r(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return ab.clone(this,a,b)})},html:function(a){return qb(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!Hb.test(a)&&!Mb[(Fb.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Eb,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(ab.cleanData(r(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,ab.cleanData(r(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=S.apply([],a);var c,d,e,f,g,h,i=0,j=this.length,k=this,l=j-1,m=a[0],p=ab.isFunction(m);if(p||j>1&&"string"==typeof m&&!Z.checkClone&&Ib.test(m))return this.each(function(c){var d=k.eq(c);p&&(a[0]=m.call(this,c,d.html())),d.domManip(a,b)});if(j&&(c=ab.buildFragment(a,this[0].ownerDocument,!1,this),d=c.firstChild,1===c.childNodes.length&&(c=d),d)){for(e=ab.map(r(c,"script"),n),f=e.length;j>i;i++)g=c,i!==l&&(g=ab.clone(g,!0,!0),f&&ab.merge(e,r(g,"script"))),b.call(this[i],g,i);if(f)for(h=e[e.length-1].ownerDocument,ab.map(e,o),i=0;f>i;i++)g=e[i],Jb.test(g.type||"")&&!rb.access(g,"globalEval")&&ab.contains(h,g)&&(g.src?ab._evalUrl&&ab._evalUrl(g.src):ab.globalEval(g.textContent.replace(Lb,"")))}return this}}),ab.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){ab.fn[a]=function(a){for(var c,d=[],e=ab(a),f=e.length-1,g=0;f>=g;g++)c=g===f?this:this.clone(!0),ab(e[g])[b](c),T.apply(d,c.get());return this.pushStack(d)}});var Nb,Ob={},Pb=/^margin/,Qb=new RegExp("^("+vb+")(?!px)[a-z%]+$","i"),Rb=function(a){return a.ownerDocument.defaultView.getComputedStyle(a,null)};!function(){function b(){h.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",f.appendChild(g);var b=a.getComputedStyle(h,null);c="1%"!==b.top,d="4px"===b.width,f.removeChild(g)}var c,d,e="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",f=$.documentElement,g=$.createElement("div"),h=$.createElement("div");h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",Z.clearCloneStyle="content-box"===h.style.backgroundClip,g.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",g.appendChild(h),a.getComputedStyle&&ab.extend(Z,{pixelPosition:function(){return b(),c},boxSizingReliable:function(){return null==d&&b(),d},reliableMarginRight:function(){var b,c=h.appendChild($.createElement("div"));return c.style.cssText=h.style.cssText=e,c.style.marginRight=c.style.width="0",h.style.width="1px",f.appendChild(g),b=!parseFloat(a.getComputedStyle(c,null).marginRight),f.removeChild(g),h.innerHTML="",b}})}(),ab.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var Sb=/^(none|table(?!-c[ea]).+)/,Tb=new RegExp("^("+vb+")(.*)$","i"),Ub=new RegExp("^([+-])=("+vb+")","i"),Vb={position:"absolute",visibility:"hidden",display:"block"},Wb={letterSpacing:0,fontWeight:400},Xb=["Webkit","O","Moz","ms"];ab.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=v(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=ab.camelCase(b),i=a.style;return b=ab.cssProps[h]||(ab.cssProps[h]=x(i,h)),g=ab.cssHooks[b]||ab.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:(f=typeof c,"string"===f&&(e=Ub.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(ab.css(a,b)),f="number"),void(null!=c&&c===c&&("number"!==f||ab.cssNumber[h]||(c+="px"),Z.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]="",i[b]=c))))}},css:function(a,b,c,d){var e,f,g,h=ab.camelCase(b);return b=ab.cssProps[h]||(ab.cssProps[h]=x(a.style,h)),g=ab.cssHooks[b]||ab.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=v(a,b,d)),"normal"===e&&b in Wb&&(e=Wb[b]),""===c||c?(f=parseFloat(e),c===!0||ab.isNumeric(f)?f||0:e):e}}),ab.each(["height","width"],function(a,b){ab.cssHooks[b]={get:function(a,c,d){return c?0===a.offsetWidth&&Sb.test(ab.css(a,"display"))?ab.swap(a,Vb,function(){return A(a,b,d)}):A(a,b,d):void 0},set:function(a,c,d){var e=d&&Rb(a);return y(a,c,d?z(a,b,d,"border-box"===ab.css(a,"boxSizing",!1,e),e):0)}}}),ab.cssHooks.marginRight=w(Z.reliableMarginRight,function(a,b){return b?ab.swap(a,{display:"inline-block"},v,[a,"marginRight"]):void 0}),ab.each({margin:"",padding:"",border:"Width"},function(a,b){ab.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+wb[d]+b]=f[d]||f[d-2]||f[0];return e}},Pb.test(a)||(ab.cssHooks[a+b].set=y)}),ab.fn.extend({css:function(a,b){return qb(this,function(a,b,c){var d,e,f={},g=0;if(ab.isArray(b)){for(d=Rb(a),e=b.length;e>g;g++)f[b[g]]=ab.css(a,b[g],!1,d);return f}return void 0!==c?ab.style(a,b,c):ab.css(a,b)},a,b,arguments.length>1)},show:function(){return B(this,!0)},hide:function(){return B(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){xb(this)?ab(this).show():ab(this).hide()})}}),ab.Tween=C,C.prototype={constructor:C,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(ab.cssNumber[c]?"":"px")},cur:function(){var a=C.propHooks[this.prop];return a&&a.get?a.get(this):C.propHooks._default.get(this)},run:function(a){var b,c=C.propHooks[this.prop];return this.pos=b=this.options.duration?ab.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):C.propHooks._default.set(this),this}},C.prototype.init.prototype=C.prototype,C.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=ab.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){ab.fx.step[a.prop]?ab.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[ab.cssProps[a.prop]]||ab.cssHooks[a.prop])?ab.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},C.propHooks.scrollTop=C.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},ab.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},ab.fx=C.prototype.init,ab.fx.step={};var Yb,Zb,$b=/^(?:toggle|show|hide)$/,_b=new RegExp("^(?:([+-])=|)("+vb+")([a-z%]*)$","i"),ac=/queueHooks$/,bc=[G],cc={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=_b.exec(b),f=e&&e[3]||(ab.cssNumber[a]?"":"px"),g=(ab.cssNumber[a]||"px"!==f&&+d)&&_b.exec(ab.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,ab.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};ab.Animation=ab.extend(I,{tweener:function(a,b){ab.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],cc[c]=cc[c]||[],cc[c].unshift(b)},prefilter:function(a,b){b?bc.unshift(a):bc.push(a)}}),ab.speed=function(a,b,c){var d=a&&"object"==typeof a?ab.extend({},a):{complete:c||!c&&b||ab.isFunction(a)&&a,duration:a,easing:c&&b||b&&!ab.isFunction(b)&&b};return d.duration=ab.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in ab.fx.speeds?ab.fx.speeds[d.duration]:ab.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){ab.isFunction(d.old)&&d.old.call(this),d.queue&&ab.dequeue(this,d.queue)},d},ab.fn.extend({fadeTo:function(a,b,c,d){return this.filter(xb).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=ab.isEmptyObject(a),f=ab.speed(b,c,d),g=function(){var b=I(this,ab.extend({},a),f);(e||rb.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=ab.timers,g=rb.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&ac.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&ab.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=rb.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=ab.timers,g=d?d.length:0;for(c.finish=!0,ab.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),ab.each(["toggle","show","hide"],function(a,b){var c=ab.fn[b];ab.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(E(b,!0),a,d,e)}}),ab.each({slideDown:E("show"),slideUp:E("hide"),slideToggle:E("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){ab.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),ab.timers=[],ab.fx.tick=function(){var a,b=0,c=ab.timers;for(Yb=ab.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||ab.fx.stop(),Yb=void 0},ab.fx.timer=function(a){ab.timers.push(a),a()?ab.fx.start():ab.timers.pop()},ab.fx.interval=13,ab.fx.start=function(){Zb||(Zb=setInterval(ab.fx.tick,ab.fx.interval))},ab.fx.stop=function(){clearInterval(Zb),Zb=null},ab.fx.speeds={slow:600,fast:200,_default:400},ab.fn.delay=function(a,b){return a=ab.fx?ab.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a=$.createElement("input"),b=$.createElement("select"),c=b.appendChild($.createElement("option"));a.type="checkbox",Z.checkOn=""!==a.value,Z.optSelected=c.selected,b.disabled=!0,Z.optDisabled=!c.disabled,a=$.createElement("input"),a.value="t",a.type="radio",Z.radioValue="t"===a.value}();var dc,ec,fc=ab.expr.attrHandle;ab.fn.extend({attr:function(a,b){return qb(this,ab.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){ab.removeAttr(this,a)})}}),ab.extend({attr:function(a,b,c){var d,e,f=a.nodeType;return a&&3!==f&&8!==f&&2!==f?typeof a.getAttribute===zb?ab.prop(a,b,c):(1===f&&ab.isXMLDoc(a)||(b=b.toLowerCase(),d=ab.attrHooks[b]||(ab.expr.match.bool.test(b)?ec:dc)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=ab.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void ab.removeAttr(a,b)):void 0},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(nb);if(f&&1===a.nodeType)for(;c=f[e++];)d=ab.propFix[c]||c,ab.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)},attrHooks:{type:{set:function(a,b){if(!Z.radioValue&&"radio"===b&&ab.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),ec={set:function(a,b,c){return b===!1?ab.removeAttr(a,c):a.setAttribute(c,c),c}},ab.each(ab.expr.match.bool.source.match(/\w+/g),function(a,b){var c=fc[b]||ab.find.attr;fc[b]=function(a,b,d){var e,f;return d||(f=fc[b],fc[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,fc[b]=f),e}});var gc=/^(?:input|select|textarea|button)$/i;ab.fn.extend({prop:function(a,b){return qb(this,ab.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[ab.propFix[a]||a]})}}),ab.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;return a&&3!==g&&8!==g&&2!==g?(f=1!==g||!ab.isXMLDoc(a),f&&(b=ab.propFix[b]||b,e=ab.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]):void 0},propHooks:{tabIndex:{get:function(a){return a.hasAttribute("tabindex")||gc.test(a.nodeName)||a.href?a.tabIndex:-1}}}}),Z.optSelected||(ab.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null}}),ab.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ab.propFix[this.toLowerCase()]=this});var hc=/[\t\r\n\f]/g;ab.fn.extend({addClass:function(a){var b,c,d,e,f,g,h="string"==typeof a&&a,i=0,j=this.length;if(ab.isFunction(a))return this.each(function(b){ab(this).addClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(nb)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(hc," "):" ")){for(f=0;e=b[f++];)d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=ab.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0===arguments.length||"string"==typeof a&&a,i=0,j=this.length;if(ab.isFunction(a))return this.each(function(b){ab(this).removeClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(nb)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(hc," "):"")){for(f=0;e=b[f++];)for(;d.indexOf(" "+e+" ")>=0;)d=d.replace(" "+e+" "," ");g=a?ab.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(ab.isFunction(a)?function(c){ab(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c)for(var b,d=0,e=ab(this),f=a.match(nb)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else(c===zb||"boolean"===c)&&(this.className&&rb.set(this,"__className__",this.className),this.className=this.className||a===!1?"":rb.get(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(hc," ").indexOf(b)>=0)return!0;return!1}});var ic=/\r/g;ab.fn.extend({val:function(a){var b,c,d,e=this[0];return arguments.length?(d=ab.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,ab(this).val()):a,null==e?e="":"number"==typeof e?e+="":ab.isArray(e)&&(e=ab.map(e,function(a){return null==a?"":a+""})),b=ab.valHooks[this.type]||ab.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))})):e?(b=ab.valHooks[e.type]||ab.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(ic,""):null==c?"":c)):void 0}}),ab.extend({valHooks:{select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(Z.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&ab.nodeName(c.parentNode,"optgroup"))){if(b=ab(c).val(),f)return b;g.push(b)}return g},set:function(a,b){for(var c,d,e=a.options,f=ab.makeArray(b),g=e.length;g--;)d=e[g],(d.selected=ab.inArray(ab(d).val(),f)>=0)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),ab.each(["radio","checkbox"],function(){ab.valHooks[this]={set:function(a,b){return ab.isArray(b)?a.checked=ab.inArray(ab(a).val(),b)>=0:void 0}},Z.checkOn||(ab.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})}),ab.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){ab.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),ab.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var jc=ab.now(),kc=/\?/;ab.parseJSON=function(a){return JSON.parse(a+"")},ab.parseXML=function(a){var b,c;if(!a||"string"!=typeof a)return null;try{c=new DOMParser,b=c.parseFromString(a,"text/xml")}catch(d){b=void 0}return(!b||b.getElementsByTagName("parsererror").length)&&ab.error("Invalid XML: "+a),b};var lc,mc,nc=/#.*$/,oc=/([?&])_=[^&]*/,pc=/^(.*?):[ \t]*([^\r\n]*)$/gm,qc=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rc=/^(?:GET|HEAD)$/,sc=/^\/\//,tc=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,uc={},vc={},wc="*/".concat("*");try{mc=location.href}catch(xc){mc=$.createElement("a"),mc.href="",mc=mc.href}lc=tc.exec(mc.toLowerCase())||[],ab.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:mc,type:"GET",isLocal:qc.test(lc[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":wc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":ab.parseJSON,"text xml":ab.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?L(L(a,ab.ajaxSettings),b):L(ab.ajaxSettings,a)},ajaxPrefilter:J(uc),ajaxTransport:J(vc),ajax:function(a,b){function c(a,b,c,g){var i,k,r,s,u,w=b;2!==t&&(t=2,h&&clearTimeout(h),d=void 0,f=g||"",v.readyState=a>0?4:0,i=a>=200&&300>a||304===a,c&&(s=M(l,v,c)),s=N(l,s,v,i),i?(l.ifModified&&(u=v.getResponseHeader("Last-Modified"),u&&(ab.lastModified[e]=u),u=v.getResponseHeader("etag"),u&&(ab.etag[e]=u)),204===a||"HEAD"===l.type?w="nocontent":304===a?w="notmodified":(w=s.state,k=s.data,r=s.error,i=!r)):(r=w,(a||!w)&&(w="error",0>a&&(a=0))),v.status=a,v.statusText=(b||w)+"",i?o.resolveWith(m,[k,w,v]):o.rejectWith(m,[v,w,r]),v.statusCode(q),q=void 0,j&&n.trigger(i?"ajaxSuccess":"ajaxError",[v,l,i?k:r]),p.fireWith(m,[v,w]),j&&(n.trigger("ajaxComplete",[v,l]),--ab.active||ab.event.trigger("ajaxStop")))}"object"==typeof a&&(b=a,a=void 0),b=b||{};var d,e,f,g,h,i,j,k,l=ab.ajaxSetup({},b),m=l.context||l,n=l.context&&(m.nodeType||m.jquery)?ab(m):ab.event,o=ab.Deferred(),p=ab.Callbacks("once memory"),q=l.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!g)for(g={};b=pc.exec(f);)g[b[1].toLowerCase()]=b[2];b=g[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(l.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return d&&d.abort(b),c(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,l.url=((a||l.url||mc)+"").replace(nc,"").replace(sc,lc[1]+"//"),l.type=b.method||b.type||l.method||l.type,l.dataTypes=ab.trim(l.dataType||"*").toLowerCase().match(nb)||[""],null==l.crossDomain&&(i=tc.exec(l.url.toLowerCase()),l.crossDomain=!(!i||i[1]===lc[1]&&i[2]===lc[2]&&(i[3]||("http:"===i[1]?"80":"443"))===(lc[3]||("http:"===lc[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=ab.param(l.data,l.traditional)),K(uc,l,b,v),2===t)return v;j=l.global,j&&0===ab.active++&&ab.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!rc.test(l.type),e=l.url,l.hasContent||(l.data&&(e=l.url+=(kc.test(e)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=oc.test(e)?e.replace(oc,"$1_="+jc++):e+(kc.test(e)?"&":"?")+"_="+jc++)),l.ifModified&&(ab.lastModified[e]&&v.setRequestHeader("If-Modified-Since",ab.lastModified[e]),ab.etag[e]&&v.setRequestHeader("If-None-Match",ab.etag[e])),(l.data&&l.hasContent&&l.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",l.contentType),v.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+wc+"; q=0.01":""):l.accepts["*"]);for(k in l.headers)v.setRequestHeader(k,l.headers[k]);if(l.beforeSend&&(l.beforeSend.call(m,v,l)===!1||2===t))return v.abort();u="abort";for(k in{success:1,error:1,complete:1})v[k](l[k]);if(d=K(vc,l,b,v)){v.readyState=1,j&&n.trigger("ajaxSend",[v,l]),l.async&&l.timeout>0&&(h=setTimeout(function(){v.abort("timeout")},l.timeout));try{t=1,d.send(r,c)}catch(w){if(!(2>t))throw w;c(-1,w)}}else c(-1,"No Transport");return v},getJSON:function(a,b,c){return ab.get(a,b,c,"json")},getScript:function(a,b){return ab.get(a,void 0,b,"script")}}),ab.each(["get","post"],function(a,b){ab[b]=function(a,c,d,e){return ab.isFunction(c)&&(e=e||d,d=c,c=void 0),ab.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),ab.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){ab.fn[b]=function(a){return this.on(b,a)}}),ab._evalUrl=function(a){return ab.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},ab.fn.extend({wrapAll:function(a){var b;return ab.isFunction(a)?this.each(function(b){ab(this).wrapAll(a.call(this,b))}):(this[0]&&(b=ab(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstElementChild;)a=a.firstElementChild;return a}).append(this)),this)},wrapInner:function(a){return this.each(ab.isFunction(a)?function(b){ab(this).wrapInner(a.call(this,b))}:function(){var b=ab(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=ab.isFunction(a);return this.each(function(c){ab(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){ab.nodeName(this,"body")||ab(this).replaceWith(this.childNodes)}).end()}}),ab.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0},ab.expr.filters.visible=function(a){return!ab.expr.filters.hidden(a)};var yc=/%20/g,zc=/\[\]$/,Ac=/\r?\n/g,Bc=/^(?:submit|button|image|reset|file)$/i,Cc=/^(?:input|select|textarea|keygen)/i;ab.param=function(a,b){var c,d=[],e=function(a,b){b=ab.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=ab.ajaxSettings&&ab.ajaxSettings.traditional),ab.isArray(a)||a.jquery&&!ab.isPlainObject(a))ab.each(a,function(){e(this.name,this.value)});else for(c in a)O(c,a[c],b,e);return d.join("&").replace(yc,"+")},ab.fn.extend({serialize:function(){return ab.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=ab.prop(this,"elements");return a?ab.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!ab(this).is(":disabled")&&Cc.test(this.nodeName)&&!Bc.test(a)&&(this.checked||!yb.test(a))}).map(function(a,b){var c=ab(this).val();return null==c?null:ab.isArray(c)?ab.map(c,function(a){return{name:b.name,value:a.replace(Ac,"\r\n")}}):{name:b.name,value:c.replace(Ac,"\r\n")}}).get()}}),ab.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};var Dc=0,Ec={},Fc={0:200,1223:204},Gc=ab.ajaxSettings.xhr();a.ActiveXObject&&ab(a).on("unload",function(){for(var a in Ec)Ec[a]()}),Z.cors=!!Gc&&"withCredentials"in Gc,Z.ajax=Gc=!!Gc,ab.ajaxTransport(function(a){var b;return Z.cors||Gc&&!a.crossDomain?{send:function(c,d){var e,f=a.xhr(),g=++Dc;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)f.setRequestHeader(e,c[e]);b=function(a){return function(){b&&(delete Ec[g],b=f.onload=f.onerror=null,"abort"===a?f.abort():"error"===a?d(f.status,f.statusText):d(Fc[f.status]||f.status,f.statusText,"string"==typeof f.responseText?{text:f.responseText}:void 0,f.getAllResponseHeaders()))}},f.onload=b(),f.onerror=b("error"),b=Ec[g]=b("abort"),f.send(a.hasContent&&a.data||null)},abort:function(){b&&b()}}:void 0}),ab.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return ab.globalEval(a),a}}}),ab.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),ab.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=ab("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&e("error"===a.type?404:200,a.type)}),$.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Hc=[],Ic=/(=)\?(?=&|$)|\?\?/;
ab.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Hc.pop()||ab.expando+"_"+jc++;return this[a]=!0,a}}),ab.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(Ic.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ic.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=ab.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Ic,"$1"+e):b.jsonp!==!1&&(b.url+=(kc.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||ab.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Hc.push(e)),g&&ab.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),ab.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||$;var d=gb.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=ab.buildFragment([a],b,e),e&&e.length&&ab(e).remove(),ab.merge([],d.childNodes))};var Jc=ab.fn.load;ab.fn.load=function(a,b,c){if("string"!=typeof a&&Jc)return Jc.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=a.slice(h),a=a.slice(0,h)),ab.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&ab.ajax({url:a,type:e,dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?ab("<div>").append(ab.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,f||[a.responseText,b,a])}),this},ab.expr.filters.animated=function(a){return ab.grep(ab.timers,function(b){return a===b.elem}).length};var Kc=a.document.documentElement;ab.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=ab.css(a,"position"),l=ab(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=ab.css(a,"top"),i=ab.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),ab.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},ab.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){ab.offset.setOffset(this,a,b)});var b,c,d=this[0],e={top:0,left:0},f=d&&d.ownerDocument;return f?(b=f.documentElement,ab.contains(b,d)?(typeof d.getBoundingClientRect!==zb&&(e=d.getBoundingClientRect()),c=P(f),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):e):void 0},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===ab.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),ab.nodeName(a[0],"html")||(d=a.offset()),d.top+=ab.css(a[0],"borderTopWidth",!0),d.left+=ab.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-ab.css(c,"marginTop",!0),left:b.left-d.left-ab.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||Kc;a&&!ab.nodeName(a,"html")&&"static"===ab.css(a,"position");)a=a.offsetParent;return a||Kc})}}),ab.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,c){var d="pageYOffset"===c;ab.fn[b]=function(e){return qb(this,function(b,e,f){var g=P(b);return void 0===f?g?g[c]:b[e]:void(g?g.scrollTo(d?a.pageXOffset:f,d?f:a.pageYOffset):b[e]=f)},b,e,arguments.length,null)}}),ab.each(["top","left"],function(a,b){ab.cssHooks[b]=w(Z.pixelPosition,function(a,c){return c?(c=v(a,b),Qb.test(c)?ab(a).position()[b]+"px":c):void 0})}),ab.each({Height:"height",Width:"width"},function(a,b){ab.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){ab.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return qb(this,function(b,c,d){var e;return ab.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?ab.css(b,c,g):ab.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),ab.fn.size=function(){return this.length},ab.fn.andSelf=ab.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return ab});var Lc=a.jQuery,Mc=a.$;return ab.noConflict=function(b){return a.$===ab&&(a.$=Mc),b&&a.jQuery===ab&&(a.jQuery=Lc),ab},typeof b===zb&&(a.jQuery=a.$=ab),ab}),function(){var a,b,c,d;!function(){var e={},f={};a=function(a,b,c){e[a]={deps:b,callback:c}},d=c=b=function(a){function c(b){if("."!==b.charAt(0))return b;for(var c=b.split("/"),d=a.split("/").slice(0,-1),e=0,f=c.length;f>e;e++){var g=c[e];if(".."===g)d.pop();else{if("."===g)continue;d.push(g)}}return d.join("/")}if(d._eak_seen=e,f[a])return f[a];if(f[a]={},!e[a])throw new Error("Could not find module "+a);for(var g,h=e[a],i=h.deps,j=h.callback,k=[],l=0,m=i.length;m>l;l++)k.push("exports"===i[l]?g={}:b(c(i[l])));var n=j.apply(this,k);return f[a]=g||n}}(),a("promise/all",["./utils","exports"],function(a,b){"use strict";function c(a){var b=this;if(!d(a))throw new TypeError("You must pass an array to all.");return new b(function(b,c){function d(a){return function(b){f(a,b)}}function f(a,c){h[a]=c,0===--i&&b(h)}var g,h=[],i=a.length;0===i&&b([]);for(var j=0;j<a.length;j++)g=a[j],g&&e(g.then)?g.then(d(j),c):f(j,g)})}var d=a.isArray,e=a.isFunction;b.all=c}),a("promise/asap",["exports"],function(a){"use strict";function b(){return function(){process.nextTick(e)}}function c(){var a=0,b=new i(e),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function d(){return function(){j.setTimeout(e,1)}}function e(){for(var a=0;a<k.length;a++){var b=k[a],c=b[0],d=b[1];c(d)}k=[]}function f(a,b){var c=k.push([a,b]);1===c&&g()}var g,h="undefined"!=typeof window?window:{},i=h.MutationObserver||h.WebKitMutationObserver,j="undefined"!=typeof global?global:void 0===this?window:this,k=[];g="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?b():i?c():d(),a.asap=f}),a("promise/config",["exports"],function(a){"use strict";function b(a,b){return 2!==arguments.length?c[a]:void(c[a]=b)}var c={instrument:!1};a.config=c,a.configure=b}),a("promise/polyfill",["./promise","./utils","exports"],function(a,b,c){"use strict";function d(){var a;a="undefined"!=typeof global?global:"undefined"!=typeof window&&window.document?window:self;var b="Promise"in a&&"resolve"in a.Promise&&"reject"in a.Promise&&"all"in a.Promise&&"race"in a.Promise&&function(){var b;return new a.Promise(function(a){b=a}),f(b)}();b||(a.Promise=e)}var e=a.Promise,f=b.isFunction;c.polyfill=d}),a("promise/promise",["./config","./utils","./all","./race","./resolve","./reject","./asap","exports"],function(a,b,c,d,e,f,g,h){"use strict";function i(a){if(!v(a))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof i))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],j(a,this)}function j(a,b){function c(a){o(b,a)}function d(a){q(b,a)}try{a(c,d)}catch(e){d(e)}}function k(a,b,c,d){var e,f,g,h,i=v(c);if(i)try{e=c(d),g=!0}catch(j){h=!0,f=j}else e=d,g=!0;n(b,e)||(i&&g?o(b,e):h?q(b,f):a===D?o(b,e):a===E&&q(b,e))}function l(a,b,c,d){var e=a._subscribers,f=e.length;e[f]=b,e[f+D]=c,e[f+E]=d}function m(a,b){for(var c,d,e=a._subscribers,f=a._detail,g=0;g<e.length;g+=3)c=e[g],d=e[g+b],k(b,c,d,f);a._subscribers=null}function n(a,b){var c,d=null;try{if(a===b)throw new TypeError("A promises callback cannot return that same promise.");if(u(b)&&(d=b.then,v(d)))return d.call(b,function(d){return c?!0:(c=!0,void(b!==d?o(a,d):p(a,d)))},function(b){return c?!0:(c=!0,void q(a,b))}),!0}catch(e){return c?!0:(q(a,e),!0)}return!1}function o(a,b){a===b?p(a,b):n(a,b)||p(a,b)}function p(a,b){a._state===B&&(a._state=C,a._detail=b,t.async(r,a))}function q(a,b){a._state===B&&(a._state=C,a._detail=b,t.async(s,a))}function r(a){m(a,a._state=D)}function s(a){m(a,a._state=E)}var t=a.config,u=(a.configure,b.objectOrFunction),v=b.isFunction,w=(b.now,c.all),x=d.race,y=e.resolve,z=f.reject,A=g.asap;t.async=A;var B=void 0,C=0,D=1,E=2;i.prototype={constructor:i,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(a,b){var c=this,d=new this.constructor(function(){});if(this._state){var e=arguments;t.async(function(){k(c._state,d,e[c._state-1],c._detail)})}else l(this,d,a,b);return d},"catch":function(a){return this.then(null,a)}},i.all=w,i.race=x,i.resolve=y,i.reject=z,h.Promise=i}),a("promise/race",["./utils","exports"],function(a,b){"use strict";function c(a){var b=this;if(!d(a))throw new TypeError("You must pass an array to race.");return new b(function(b,c){for(var d,e=0;e<a.length;e++)d=a[e],d&&"function"==typeof d.then?d.then(b,c):b(d)})}var d=a.isArray;b.race=c}),a("promise/reject",["exports"],function(a){"use strict";function b(a){var b=this;return new b(function(b,c){c(a)})}a.reject=b}),a("promise/resolve",["exports"],function(a){"use strict";function b(a){if(a&&"object"==typeof a&&a.constructor===this)return a;var b=this;return new b(function(b){b(a)})}a.resolve=b}),a("promise/utils",["exports"],function(a){"use strict";function b(a){return c(a)||"object"==typeof a&&null!==a}function c(a){return"function"==typeof a}function d(a){return"[object Array]"===Object.prototype.toString.call(a)}var e=Date.now||function(){return(new Date).getTime()};a.objectOrFunction=b,a.isFunction=c,a.isArray=d,a.now=e}),b("promise/polyfill").polyfill()}(),!function(){"use strict";var a,b=function(){var a=/\-([a-z])/g,b=function(a,b){return b.toUpperCase()};return function(c){return c.replace(a,b)}}(),c=function(a,c){var d,e,f,g,h,i;if(window.getComputedStyle?d=window.getComputedStyle(a,null).getPropertyValue(c):(e=b(c),d=a.currentStyle?a.currentStyle[e]:a.style[e]),"cursor"===c&&(!d||"auto"===d))for(f=a.tagName.toLowerCase(),g=["a"],h=0,i=g.length;i>h;h++)if(f===g[h])return"pointer";return d},d=function(a){if(p.prototype._singleton){a||(a=window.event);var b;this!==window?b=this:a.target?b=a.target:a.srcElement&&(b=a.srcElement),p.prototype._singleton.setCurrent(b)}},e=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)},f=function(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent("on"+b,c)},g=function(a,b){if(a.addClass)return a.addClass(b),a;if(b&&"string"==typeof b){var c=(b||"").split(/\s+/);if(1===a.nodeType)if(a.className){for(var d=" "+a.className+" ",e=a.className,f=0,g=c.length;g>f;f++)d.indexOf(" "+c[f]+" ")<0&&(e+=" "+c[f]);a.className=e.replace(/^\s+|\s+$/g,"")}else a.className=b}return a},h=function(a,b){if(a.removeClass)return a.removeClass(b),a;if(b&&"string"==typeof b||void 0===b){var c=(b||"").split(/\s+/);if(1===a.nodeType&&a.className)if(b){for(var d=(" "+a.className+" ").replace(/[\n\t]/g," "),e=0,f=c.length;f>e;e++)d=d.replace(" "+c[e]+" "," ");a.className=d.replace(/^\s+|\s+$/g,"")}else a.className=""}return a},i=function(){var a,b,c,d=1;return"function"==typeof document.body.getBoundingClientRect&&(a=document.body.getBoundingClientRect(),b=a.right-a.left,c=document.body.offsetWidth,d=Math.round(100*(b/c))/100),d},j=function(a){var b={left:0,top:0,width:0,height:0,zIndex:999999999},d=c(a,"z-index");if(d&&"auto"!==d&&(b.zIndex=parseInt(d,10)),a.getBoundingClientRect){var e,f,g,h=a.getBoundingClientRect();"pageXOffset"in window&&"pageYOffset"in window?(e=window.pageXOffset,f=window.pageYOffset):(g=i(),e=Math.round(document.documentElement.scrollLeft/g),f=Math.round(document.documentElement.scrollTop/g));var j=document.documentElement.clientLeft||0,k=document.documentElement.clientTop||0;b.left=h.left+e-j,b.top=h.top+f-k,b.width="width"in h?h.width:h.right-h.left,b.height="height"in h?h.height:h.bottom-h.top}return b},k=function(a,b){var c=!(b&&b.useNoCache===!1);return c?(-1===a.indexOf("?")?"?":"&")+"nocache="+(new Date).getTime():""},l=function(a){var b=[],c=[];return a.trustedOrigins&&("string"==typeof a.trustedOrigins?c.push(a.trustedOrigins):"object"==typeof a.trustedOrigins&&"length"in a.trustedOrigins&&(c=c.concat(a.trustedOrigins))),a.trustedDomains&&("string"==typeof a.trustedDomains?c.push(a.trustedDomains):"object"==typeof a.trustedDomains&&"length"in a.trustedDomains&&(c=c.concat(a.trustedDomains))),c.length&&b.push("trustedOrigins="+encodeURIComponent(c.join(","))),"string"==typeof a.amdModuleId&&a.amdModuleId&&b.push("amdModuleId="+encodeURIComponent(a.amdModuleId)),"string"==typeof a.cjsModuleId&&a.cjsModuleId&&b.push("cjsModuleId="+encodeURIComponent(a.cjsModuleId)),b.join("&")},m=function(a,b){if(b.indexOf)return b.indexOf(a);for(var c=0,d=b.length;d>c;c++)if(b[c]===a)return c;return-1},n=function(a){if("string"==typeof a)throw new TypeError("ZeroClipboard doesn't accept query strings.");return a.length?a:[a]},o=function(a,b,c,d,e){e?window.setTimeout(function(){a.call(b,c,d)},0):a.call(b,c,d)},p=function(a,b){if(a&&(p.prototype._singleton||this).glue(a),p.prototype._singleton)return p.prototype._singleton;p.prototype._singleton=this,this.options={};for(var c in s)this.options[c]=s[c];for(var d in b)this.options[d]=b[d];this.handlers={},p.detectFlashSupport()&&v()},q=[];p.prototype.setCurrent=function(b){a=b,this.reposition();var d=b.getAttribute("title");d&&this.setTitle(d);var e=this.options.forceHandCursor===!0||"pointer"===c(b,"cursor");return r.call(this,e),this},p.prototype.setText=function(a){return a&&""!==a&&(this.options.text=a,this.ready()&&this.flashBridge.setText(a)),this},p.prototype.setTitle=function(a){return a&&""!==a&&this.htmlBridge.setAttribute("title",a),this},p.prototype.setSize=function(a,b){return this.ready()&&this.flashBridge.setSize(a,b),this},p.prototype.setHandCursor=function(a){return a="boolean"==typeof a?a:!!a,r.call(this,a),this.options.forceHandCursor=a,this};var r=function(a){this.ready()&&this.flashBridge.setHandCursor(a)};p.version="1.2.3";var s={moviePath:"ZeroClipboard.swf",trustedOrigins:null,text:null,hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",allowScriptAccess:"sameDomain",useNoCache:!0,forceHandCursor:!1};p.setDefaults=function(a){for(var b in a)s[b]=a[b]},p.destroy=function(){p.prototype._singleton.unglue(q);var a=p.prototype._singleton.htmlBridge;a.parentNode.removeChild(a),delete p.prototype._singleton},p.detectFlashSupport=function(){var a=!1;if("function"==typeof ActiveXObject)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")&&(a=!0)}catch(b){}return!a&&navigator.mimeTypes["application/x-shockwave-flash"]&&(a=!0),a};var t=null,u=null,v=function(){var a,b,c=p.prototype._singleton,d=document.getElementById("global-zeroclipboard-html-bridge");if(!d){var e={};for(var f in c.options)e[f]=c.options[f];e.amdModuleId=t,e.cjsModuleId=u;var g=l(e),h='      <object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" id="global-zeroclipboard-flash-bridge" width="100%" height="100%">         <param name="movie" value="'+c.options.moviePath+k(c.options.moviePath,c.options)+'"/>         <param name="allowScriptAccess" value="'+c.options.allowScriptAccess+'"/>         <param name="scale" value="exactfit"/>         <param name="loop" value="false"/>         <param name="menu" value="false"/>         <param name="quality" value="best" />         <param name="bgcolor" value="#ffffff"/>         <param name="wmode" value="transparent"/>         <param name="flashvars" value="'+g+'"/>         <embed src="'+c.options.moviePath+k(c.options.moviePath,c.options)+'"           loop="false" menu="false"           quality="best" bgcolor="#ffffff"           width="100%" height="100%"           name="global-zeroclipboard-flash-bridge"           allowScriptAccess="always"           allowFullScreen="false"           type="application/x-shockwave-flash"           wmode="transparent"           pluginspage="http://www.macromedia.com/go/getflashplayer"           flashvars="'+g+'"           scale="exactfit">         </embed>       </object>';d=document.createElement("div"),d.id="global-zeroclipboard-html-bridge",d.setAttribute("class","global-zeroclipboard-container"),d.setAttribute("data-clipboard-ready",!1),d.style.position="absolute",d.style.left="-9999px",d.style.top="-9999px",d.style.width="15px",d.style.height="15px",d.style.zIndex="9999",d.innerHTML=h,document.body.appendChild(d)}c.htmlBridge=d,a=document["global-zeroclipboard-flash-bridge"],a&&(b=a.length)&&(a=a[b-1]),c.flashBridge=a||d.children[0].lastElementChild};p.prototype.resetBridge=function(){return this.htmlBridge.style.left="-9999px",this.htmlBridge.style.top="-9999px",this.htmlBridge.removeAttribute("title"),this.htmlBridge.removeAttribute("data-clipboard-text"),h(a,this.options.activeClass),a=null,this.options.text=null,this},p.prototype.ready=function(){var a=this.htmlBridge.getAttribute("data-clipboard-ready");return"true"===a||a===!0},p.prototype.reposition=function(){if(!a)return!1;var b=j(a);return this.htmlBridge.style.top=b.top+"px",this.htmlBridge.style.left=b.left+"px",this.htmlBridge.style.width=b.width+"px",this.htmlBridge.style.height=b.height+"px",this.htmlBridge.style.zIndex=b.zIndex+1,this.setSize(b.width,b.height),this},p.dispatch=function(a,b){p.prototype._singleton.receiveEvent(a,b)},p.prototype.on=function(a,b){for(var c=a.toString().split(/\s/g),d=0;d<c.length;d++)a=c[d].toLowerCase().replace(/^on/,""),this.handlers[a]||(this.handlers[a]=b);return this.handlers.noflash&&!p.detectFlashSupport()&&this.receiveEvent("onNoFlash",null),this},p.prototype.addEventListener=p.prototype.on,p.prototype.off=function(a,b){for(var c=a.toString().split(/\s/g),d=0;d<c.length;d++){a=c[d].toLowerCase().replace(/^on/,"");for(var e in this.handlers)e===a&&this.handlers[e]===b&&delete this.handlers[e]}return this},p.prototype.removeEventListener=p.prototype.off,p.prototype.receiveEvent=function(b,c){b=b.toString().toLowerCase().replace(/^on/,"");var d=a,e=!0;switch(b){case"load":if(c&&parseFloat(c.flashVersion.replace(",",".").replace(/[^0-9\.]/gi,""))<10)return void this.receiveEvent("onWrongFlash",{flashVersion:c.flashVersion});this.htmlBridge.setAttribute("data-clipboard-ready",!0);break;case"mouseover":g(d,this.options.hoverClass);break;case"mouseout":h(d,this.options.hoverClass),this.resetBridge();break;case"mousedown":g(d,this.options.activeClass);break;case"mouseup":h(d,this.options.activeClass);break;case"datarequested":var f=d.getAttribute("data-clipboard-target"),i=f?document.getElementById(f):null;if(i){var j=i.value||i.textContent||i.innerText;j&&this.setText(j)}else{var k=d.getAttribute("data-clipboard-text");k&&this.setText(k)}e=!1;break;case"complete":this.options.text=null}if(this.handlers[b]){var l=this.handlers[b];"string"==typeof l&&"function"==typeof window[l]&&(l=window[l]),"function"==typeof l&&o(l,d,this,c,e)}},p.prototype.glue=function(a){a=n(a);for(var b=0;b<a.length;b++)-1==m(a[b],q)&&(q.push(a[b]),e(a[b],"mouseover",d));return this},p.prototype.unglue=function(a){a=n(a);for(var b=0;b<a.length;b++){f(a[b],"mouseover",d);var c=m(a[b],q);-1!=c&&q.splice(c,1)}return this},"function"==typeof define&&define.amd?define(["require","exports","module"],function(a,b,c){return t=c&&c.id||null,p}):"object"==typeof module&&module&&"object"==typeof module.exports&&module.exports?(u=module.id||null,module.exports=p):window.ZeroClipboard=p}();var jhtmls="undefined"==typeof exports?jhtmls||{}:exports;void function(a){"use strict";function b(a){return String(a).replace(/["<>& ]/g,function(a){return"&"+e[a]+";"})}function c(a){var b=[];return b.push("with(this){"),b.push(a.replace(/<(script|style)[^>]*>[\s\S]*?<\/\1>/g,function(a){return['!#{unescape("',escape(a),'")}'].join("")}).replace(/[\r\n]+/g,"\n").replace(/^\n+|\s+$/gm,"").replace(/^([ \w\t_$]*([^&\^?|\n\w\/'"{}\[\]+\-():; \t=\.$_]|:\/\/).*$|^(?!\s*(else|do|try|finally|void|typeof\s[\w$_]*)\s*$)[^'":;{}()\n|=&\/^?]+$)\s?/gm,function(a){return a=a.replace(/&none;/g,"").replace(/["'\\]/g,"\\$&").replace(/\n/g,"\\n").replace(/(!?#)\{(.*?)\}|(!?\$)([a-z_]+\w*(?:\.[a-z_]+\w*)*)/g,function(a,b,c,d,e){if(d&&(b=d,c=e),!c)return"";c=c.replace(/\\n/g,"\n").replace(/\\([\\'"])/g,"$1");var f=/^[a-z$][\w+$]+$/i.test(c)&&!/^(true|false|NaN|null|this)$/.test(c);return["',",f?["typeof ",c,"==='undefined'?'':"].join(""):"","#"===b||"$"===b?"_encode_":"","(",c,"),'"].join("")}),a=["'",a,"'"].join("").replace(/^'',|,''$/g,""),a?["_output_.push(",a,");"].join(""):""})),b.push("}"),new Function("_output_","_encode_","helper","jhtmls",b.join(""))}function d(d,e,f){"function"==typeof d&&(d=String(d).replace(/^[^\{]*\{\s*\/\*!?[ \f\t\v]*\n?|[ \f\t\v]*\*\/[;|\s]*\}$/g,""));var g=c(d),h=function(c,d){d=d||a;var e=[];return g.call(c,e,b,d,a),e.join("")};return arguments.length<=1?h:h(e,f)}var e={'"':"quot","<":"lt",">":"gt","&":"amp"," ":"nbsp"};a.render=d}(jhtmls),function(){function use(a){_p.r([moduleMapping[a]])}var _p={r:function(a){if(_p[a].inited)return _p[a].value;if("function"!=typeof _p[a].value)return _p[a].inited=!0,_p[a].value;var b={exports:{}},c=_p[a].value(null,b.exports,b);if(_p[a].inited=!0,_p[a].value=c,void 0!==c)return c;for(var d in b.exports)if(b.exports.hasOwnProperty(d))return _p[a].inited=!0,_p[a].value=b.exports,b.exports}};_p[0]={value:function(){function a(a){var b=d[a.clazz];return b?new b(a):null}var b={},c=_p.r(4),d=_p.r(11);return c.extend(b,{parse:function(b){var d=[];return c.isArray(b)?(c.each(b,function(b,c){d.push(a(c))}),d):a(b)}}),b}},_p[1]={value:function(){var a=_p.r(11);a.___register({Widget:_p.r(58),Icon:_p.r(42),Label:_p.r(48),Button:_p.r(37),ToggleButton:_p.r(57),Buttonset:_p.r(36),Separator:_p.r(54),Item:_p.r(46),Input:_p.r(45),InputButton:_p.r(43),Mask:_p.r(49),ColorPicker:_p.r(38),Tabs:_p.r(56),SpinButton:_p.r(55),Container:_p.r(39),Panel:_p.r(51),PPanel:_p.r(53),LabelPanel:_p.r(47),Menu:_p.r(50),InputMenu:_p.r(44),ButtonMenu:_p.r(34),DropPanel:_p.r(41),Popup:_p.r(52),Dialog:_p.r(40),Utils:_p.r(13),Creator:_p.r(0)}),a.__export()}},_p[2]={value:function(){var a=_p.r(11);a.___register({TablePicker:_p.r(17)})}},_p[3]={value:function(){return jhtmls}},_p[4]={value:function(){return window.jQuery}},_p[5]={value:function(require,exports){function Class(){}function checkBaseConstructorCall(a,b){var c=a.toString();if(!/this\.callBase/.test(c))throw new Error(b+" : 类构造函数没有调用父类的构造函数！为了安全，请调用父类的构造函数")}function inherit(constructor,BaseClass,classname){var KityClass=eval("(function "+classname+"( __inherit__flag ) {if( __inherit__flag != KITY_INHERIT_FLAG ) {KityClass.__KityConstructor.apply(this, arguments);}this.__KityClassName = KityClass.__KityClassName;})||0");KityClass.__KityConstructor=constructor,KityClass.prototype=new BaseClass(KITY_INHERIT_FLAG);for(var methodName in BaseClass.prototype)BaseClass.prototype.hasOwnProperty(methodName)&&0!==methodName.indexOf("__Kity")&&(KityClass.prototype[methodName]=BaseClass.prototype[methodName]);return KityClass.prototype.constructor=KityClass,KityClass}function mixin(a,b){if(!1==b instanceof Array)return a;var c,d,e,f=b.length;for(a.__KityMixins={constructor:[]},c=0;f>c;c++){d=b[c].prototype;for(e in d)!1!==d.hasOwnProperty(e)&&0!==e.indexOf("__Kity")&&("constructor"===e?a.__KityMixins.constructor.push(d[e]):a.prototype[e]=a.__KityMixins[e]=d[e])}return a}function extend(a,b){b.__KityClassName&&(b=b.prototype);for(var c in b)if(b.hasOwnProperty(c)&&c.indexOf("__Kity")&&"constructor"!=c){var d=a.prototype[c]=b[c];d.__KityMethodClass=a,d.__KityMethodName=c}return a}Function.prototype.bind=Function.prototype.bind||function(a){var b=Array.prototype.slice.call(arguments,1);return this.apply(a,b)},Class.__KityClassName="Class",Class.prototype.base=function(a){var b=arguments.callee.caller,c=b.__KityMethodClass.__KityBaseClass.prototype[a];return c.apply(this,Array.prototype.slice.call(arguments,1))},Class.prototype.callBase=function(){var a=arguments.callee.caller,b=a.__KityMethodClass.__KityBaseClass.prototype[a.__KityMethodName];return b.apply(this,arguments)},Class.prototype.mixin=function(a){var b=arguments.callee.caller,c=b.__KityMethodClass.__KityMixins;if(!c)return this;var d=c[a];return d.apply(this,Array.prototype.slice.call(arguments,1))},Class.prototype.callMixin=function(){var a=arguments.callee.caller,b=a.__KityMethodName,c=a.__KityMethodClass.__KityMixins;if(!c)return this;var d=c[b];if("constructor"==b){for(var e=0,f=d.length;f>e;e++)d[e].call(this);return this}return d.apply(this,arguments)},Class.prototype.pipe=function(a){return"function"==typeof a&&a.call(this,this),this},Class.prototype.getType=function(){return this.__KityClassName},Class.prototype.getClass=function(){return this.constructor};var KITY_INHERIT_FLAG="__KITY_INHERIT_FLAG_"+ +new Date;Class.prototype._accessProperty=function(){return this._propertyRawData||(this._propertyRawData={})},exports.createClass=function(a,b){var c,d,e;return 1===arguments.length&&(b=arguments[0],a="AnonymousClass"),e=b.base||Class,b.hasOwnProperty("constructor")?(c=b.constructor,e!=Class&&checkBaseConstructorCall(c,a)):c=function(){this.callBase.apply(this,arguments),this.callMixin.apply(this,arguments)},d=inherit(c,e,a),d=mixin(d,b.mixins),d.__KityClassName=c.__KityClassName=a,d.__KityBaseClass=c.__KityBaseClass=e,d.__KityMethodName=c.__KityMethodName="constructor",d.__KityMethodClass=c.__KityMethodClass=d,delete b.mixins,delete b.constructor,delete b.base,d=extend(d,b)},exports.extendClass=extend}},_p[6]={value:function(){var a=_p.r(4),b="__fui__marker__"+ +new Date;return{isElement:function(a){return 1===a.nodeType},getMarker:function(){return b},getRect:function(a){var b=a.getBoundingClientRect();return{width:b.width,height:b.height,top:b.top,bottom:b.bottom,left:b.left,right:b.right}},getBound:function(b){var c=0,d=0;return"body"===b.tagName.toLowerCase()?(d=a(this.getView(b)),c=d.width(),d=d.height(),{top:0,left:0,bottom:d,right:c,width:c,height:d}):this.getRect(b)},getView:function(a){return a.ownerDocument.defaultView||a.ownerDocument.parentWindow}}}},_p[7]={value:function(){var a=_p.r(3),b=_p.r(4),c={forEach:function(a,c){b.each(a,function(a,b){c.call(null,a,b)})}};return{compile:function(d,e){return d=b.trim(d),0===d.length?"":a.render(d,e,c)}}}},_p[8]={value:function(){function a(a){this.__options=b.extend({},d,a),this.__started=!1,this.__point={x:0,y:0},this.__location={x:0,y:0},this.__range={top:0,left:0,bottom:0,right:0}}var b=_p.r(4),c=_p.r(6),d={handler:null,target:null,axis:"all",range:null};return b.extend(a.prototype,{bind:function(a){if(a&&(this.__options.target=a),!this.__options.target)throw new Error("target unset");this.__target=this.__options.target,this.__handler=this.__options.handler,this.__rangeNode=this.__options.range,this.__initOptions(),this.__initEnv(),this.__initEvent()},__initEvent:function(){var a=this.__handler,d=this;b(a).on("mousedown",function(b){if(1===b.which){var e=c.getRect(a);b.preventDefault(),d.__started=!0,d.__point={x:b.clientX,y:b.clientY},d.__location={x:e.left,y:e.top},d.__range=d.__getRange()}}),b(a.ownerDocument).on("mousemove",function(a){if(d.__started){var b=a.clientX,c=a.clientY;d.__allowAxisX&&d.__xMove(b),d.__allowAxisY&&d.__yMove(c)}}).on("mouseup",function(){d.__started=!1})},__xMove:function(a){var b=a-this.__point.x;b=this.__location.x+b,b<this.__range.left?b=this.__range.left:b>this.__range.right&&(b=this.__range.right),this.__target.style.left=b+"px"},__yMove:function(a){var b=a-this.__point.y;b=this.__location.y+b,b<this.__range.top?b=this.__range.top:b>this.__range.bottom&&(b=this.__range.bottom),this.__target.style.top=b+"px"},__initEnv:function(){var a=b(this.__handler);a.css("cursor","move")},__initOptions:function(){this.__handler||(this.__handler=this.__target),this.__rangeNode||(this.__rangeNode=this.__options.target.ownerDocument.body),this.__allowAxisX="y"!==this.__options.axis,this.__allowAxisY="x"!==this.__options.axis},__getRange:function(){var a=this.__rangeNode,d=c.getRect(this.__target);return"body"===a.tagName.toLowerCase()?(a=b(this.__rangeNode.ownerDocument),a={top:0,left:0,bottom:a.height(),right:a.width()}):a=c.getRect(a),{top:a.top,left:a.left,bottom:a.bottom-d.height,right:a.right-d.width}}}),function(b){return new a(b)}}},_p[9]={value:function(){function a(d){var e=!1,f=!1,g=null;return 1===arguments.length?b(d):(c.each([].slice.call(arguments,1),function(b,h){for(var i in h)g=h[i],h.hasOwnProperty(i)&&(e=c.isPlainObject(g),f=c.isArray(g),e||f?e?(c.isPlainObject(d[i])||(d[i]={}),d[i]=a(d[i],g)):f&&(d[i]=a(g)):d[i]=h[i])}),d)}function b(d){var e=null;return c.isPlainObject(d)?a({},d):c.isArray(d)?(e=[],c.each(d,function(a,d){e.push(c.isPlainObject(d)||c.isArray(d)?b(d):d)}),e):d}var c=_p.r(4);return a}},_p[10]={value:function(){return{isContainer:function(a){return"container"===a.__widgetType}}}},_p[11]={value:function(){var a={};return{widgets:a,__export:function(){window.FUI=this},___register:function(a,b){if("string"==typeof a)this[a]=b;else{b=a;for(var c in b)b.hasOwnProperty(c)&&(this[c]=b[c])}},__registerInstance:function(b){a[b.getId()]=b}}}},_p[12]={value:function(){return{classPrefix:"fui-",layout:{TOP:"top",LEFT:"left",BOTTOM:"bottom",RIGHT:"right",CENTER:"center",MIDDLE:"middle",LEFT_TOP:"left-top",RIGHT_TOP:"right-top",LEFT_BOTTOM:"left-bottom",RIGHT_BOTTOM:"right-bottom"},control:{input:1,textarea:1,button:1,select:1,option:1,object:1,embed:1}}}},_p[13]={value:function(){var a=_p.r(4),b={Tpl:_p.r(7),Widget:_p.r(10),createDraggable:_p.r(8)};return a.extend(b,_p.r(6),_p.r(5))}},_p[14]={value:function(){return'<div unselectable="on" class="fui-t-picker"></div>\n'}},_p[15]={value:function(){return'<div unselectable="on" class="fui-table-picker"></div>\n'}},_p[16]={value:function(){var a=_p.r(4),b=_p.r(12),c=_p.r(14);return _p.r(13).createClass("TPicker",{base:_p.r(58),constructor:function(b){var c={row:10,col:10};b=a.extend({},c,b),this.callBase(b)},__initOptions:function(){this.callBase(),this.widgetName="TPicker",this.__tpl=c,this.__backplane=null},__render:function(){this.callBase(),this.__backplane=this.__createBackplane(),this.__element.appendChild(this.__backplane)},__initEvent:function(){var b=this;this.callBase(),a(this.__backplane).delegate("td","mousemove click",function(a){var c=a.target.getAttribute("data-index").split(",");c={row:parseInt(c[0],10),col:parseInt(c[1],10)},"click"===a.type?b.__select(c.row,c.col):b.__update(c.row,c.col)})},__select:function(a,b){this.trigger("pickerselect",{row:a,col:b})},__update:function(a,c){for(var d=null,e=this.__options.row,f=this.__options.col,g=b.classPrefix+"table-picker-hoverin",h=0;e>h;h++){d=this.__backplane.rows[h];for(var i=0;f>i;i++)d.cells[i].className=a>=h&&c>=i?g:""}this.trigger("pickerhover",{row:a,col:c})},__createBackplane:function(){for(var c=[],d=null,e=0,f=this.__options.row;f>e;e++){d=[];for(var g=0,h=this.__options.col;h>g;g++)d.push('<td data-index="'+e+","+g+'"></td>');c.push("<tr>"+d.join("")+"</tr>")}return c=a("<table><tbody>"+c.join("")+"</tbody></table>"),c.addClass(b.classPrefix+"t-picker-table"),c[0]}})}},_p[17]={value:function(){var a=_p.r(4),b=_p.r(12),c=_p.r(15),d=_p.r(48),e=_p.r(16),f=_p.r(37),g=_p.r(53),h=_p.r(49);return _p.r(13).createClass("TablePicker",{base:_p.r(58),constructor:function(b){var c={button:null,row:10,col:10};b=a.extend({},c,b),this.callBase(b)},open:function(){this.__panelWidget.show(),this.__maskWidget.show()},close:function(){this.__panelWidget.hide(),this.__maskWidget.hide()},appendTo:function(a){a.appendChild(this.__buttonWidget.getElement())},getButton:function(){return this.__buttonWidget},__initOptions:function(){this.callBase(),this.widgetName="TablePicker",this.__tpl=c,this.__pickerWidget=null,this.__labelWidget=null,this.__buttonWidget=null,this.__panelWidget=null,this.__maskWidget=null},__render:function(){this.callBase(),this.__pickerWidget=new e(this.__options),this.__labelWidget=new d({text:"插入表格"}),this.__buttonWidget=new f(this.__options.button),this.__panelWidget=new g({className:b.classPrefix+"table-picker-panel",column:!0,resize:"none"}),this.__maskWidget=new h,this.__panelWidget.appendWidget(this.__labelWidget),this.__panelWidget.appendWidget(this.__pickerWidget),this.__panelWidget.positionTo(this.__buttonWidget)
},__initEvent:function(){var a=this;this.callBase(),this.__buttonWidget.on("btnclick",function(){a.open()}),this.__maskWidget.on("maskclick",function(){a.close()}),this.__pickerWidget.on("pickerhover",function(b,c){var d=c.row+1,e=c.col+1;a.__labelWidget.setText(d+"x"+e+" 表格")}).on("pickerselect",function(b,c){var d=c.row+1,e=c.col+1;a.close(),a.trigger("pickerselect",{row:d,col:e})})},__createBackplane:function(){for(var c=[],d=null,e=0,f=this.__options.row;f>e;e++){d=[];for(var g=0,h=this.__options.col;h>g;g++)d.push('<td data-index="'+e+","+g+'"></td>');c.push("<tr>"+d.join("")+"</tr>")}return c=a("<table><tbody>"+c.join("")+"</tbody></table>"),c.addClass(b.classPrefix+"t-picker-table"),c[0]}})}},_p[18]={value:function(){return'<div unselectable="on" class="fui-button-menu"></div>\n'}},_p[19]={value:function(){return'<div unselectable="on" class="fui-button"></div>\n'}},_p[20]={value:function(){return'<div unselectable="on" class="fui-colorpicker-container">\n<div unselectable="on" class="fui-colorpicker-toolbar">\n<div unselectable="on" class="fui-colorpicker-preview"></div>\n<div unselectable="on" class="fui-colorpicker-clear">$clearText</div>\n</div>\n<div unselectable="on" class="fui-colorpicker-title">$commonText</div>\n<div unselectable="on" class="fui-colorpicker-commoncolor">\nhelper.forEach( commonColor, function ( index, colors ) {\n<div unselectable="on" class="fui-colorpicker-colors fui-colorpicker-colors-line$index">\nhelper.forEach( colors, function( i, color ) {\n<span unselectable="on" class="fui-colorpicker-item" style="background-color: $color; border-color: #{color.toLowerCase() == \'#ffffff\' ? \'#eeeeee\': color};" data-color="$color"></span>\n});\n</div>\n} );\n</div>\n<div unselectable="on" class="fui-colorpicker-title">$standardText</div>\n<div unselectable="on" class="fui-colorpicker-standardcolor fui-colorpicker-colors">\nhelper.forEach( standardColor, function ( i, color ) {\n<span unselectable="on" class="fui-colorpicker-item" style="background-color: $color; border-color: $color;" data-color="$color"></span>\n} );\n</div>\n</div>\n'}},_p[21]={value:function(){return'<div unselectable="on" class="fui-dialog-wrap">\n<div unselectable="on" class="fui-dialog-head">\n<h1 unselectable="on" class="fui-dialog-caption">$caption</h1>\n</div>\n<div unselectable="on" class="fui-dialog-body"></div>\n<div unselectable="on" class="fui-dialog-foot"></div>\n</div>\n'}},_p[22]={value:function(){return"<div unselectable=\"on\" class=\"fui-drop-panel\"  #{ text ? 'title=\"' + m.text + '\"' : '' }></div>\n"}},_p[23]={value:function(){return'<div unselectable="on" class="fui-icon" >\nif ( this.img ) {\n<img unselectable="on" src="#{this.img}" >\n}\n</div>\n'}},_p[24]={value:function(){return'<div unselectable="on" class="fui-input-button"></div>\n'}},_p[25]={value:function(){return'<div unselectable="on" class="fui-input-menu"></div>\n'}},_p[26]={value:function(){return'<input unselectable="on" class="fui-input"  autocomplete="off" !#{ value ? \'value="\' + value + \'"\' : \'\'}>\n'}},_p[27]={value:function(){return"<div unselectable=\"on\" class=\"fui-item!#{ selected ? ' fui-item-selected': '' }\" ></div>\n"}},_p[28]={value:function(){return'<div unselectable="on" class="fui-label">$text</div>\n'}},_p[29]={value:function(){return'<div unselectable="on" class="fui-mask" style="background-color: $bgcolor; opacity: $opacity;"></div>\n'}},_p[30]={value:function(){return'<div unselectable="on" class="fui-panel"></div>\n'}},_p[31]={value:function(){return'<div unselectable="on" class="fui-separator"></div>\n'}},_p[32]={value:function(){return'<div unselectable="on" class="fui-spin-button"></div>\n'}},_p[33]={value:function(){return'<div unselectable="on" class="fui-tabs">\n<div unselectable="on" class="fui-tabs-button-wrap"></div>\n<div unselectable="on" class="fui-tabs-panel-wrap"></div>\n</div>\n'}},_p[34]={value:function(){var a=_p.r(4),b=_p.r(12),c=_p.r(18),d=_p.r(37),e=_p.r(50),f=_p.r(49),g=b.layout;return _p.r(13).createClass("ButtonMenu",{base:_p.r(58),constructor:function(b){var c={menu:null,mask:null,buttons:[],selected:-1,layout:g.RIGHT};b=a.extend({},c,b),this.callBase(b)},open:function(){this.__openState=!0,this.__maskWidget.show(),this.__menuWidget.show(),this.addClass(b.classPrefix+"button-active")},close:function(){this.__openState=!1,this.__maskWidget.hide(),this.__menuWidget.hide(),this.removeClass(b.classPrefix+"button-active")},isOpen:function(){return!!this.__openState},getSelected:function(){return this.__menuWidget.getSelected()},getSelectedItem:function(){return this.__menuWidget.getSelectedItem()},getValue:function(){return this.getSelectedItem().getValue()},__render:function(){this.callBase(),this.__initButtons(),this.__menuWidget=new e(this.__options.menu),this.__maskWidget=new f(this.__options.mask),this.__menuWidget.positionTo(this.__element),this.__menuWidget.appendTo(this.__element.ownerDocument.body)},__initOptions:function(){this.callBase(),this.widgetName="ButtonMenu",this.__tpl=c,this.__buttonWidgets=null,this.__menuWidget=null,this.__maskWidget=null,this.__openState=!1,-1!==this.__options.selected&&(this.__options.menu.selected=this.__options.selected)},__initButtons:function(){var c=[],e=this.__element,f=null,h=this.__options.buttons.length-1;this.__options.layout===g.TOP||this.__options.layout===g.LEFT?(f=new d(this.__options.buttons[h]),f.appendTo(e)):h=-1,a.each(this.__options.buttons,function(a,b){if(h!==a){var g=new d(b);g.appendTo(e),c.push(g)}else c.push(f)}),this.addClass(b.classPrefix+"layout-"+this.__options.layout),c[c.length-1].addClass(b.classPrefix+"open-btn"),this.__buttonWidgets=c},__initEvent:function(){var b=this.__buttonWidgets[this.__buttonWidgets.length-1],c=this;this.callBase(),b.on("click",function(){c.open()}),this.__maskWidget.on("maskclick",function(){c.close()}),this.__menuWidget.on("select",function(a,b){a.stopPropagation(),c.close(),c.trigger("select",b)}).on("change",function(a,b){c.trigger("change",b)}),this.on("btnclick",function(b){b.stopPropagation();var c=a.inArray(b.widget,this.__buttonWidgets);c>-1&&c<this.__buttonWidgets.length-1&&this.trigger("buttonclick",{button:this.__buttonWidgets[c]})})}})}},_p[35]={value:function(){var a=_p.r(4),b=_p.r(25),c=_p.r(43),d=_p.r(50),e=_p.r(49),f=_p.r(13);return _p.r(13).createClass("InputMenu",{base:_p.r(58),constructor:function(a){var c=f.getMarker();this.callBase(c);var d={input:null,menu:null,mask:null};this.__extendOptions(d,a),this.widgetName="InputMenu",this.__tpl=b,this.__lastTime=0,this.__lastSelect=null,this.__inputWidget=null,this.__menuWidget=null,this.__maskWidget=null,this.__menuState=!1,a!==c&&this.__render()},select:function(a){this.__menuWidget.select(a)},setValue:function(a){return this.__inputWidget.setValue(a),this},getValue:function(){return this.__inputWidget.getValue()},__render:function(){return this.__rendered?this:(this.__inputWidget=new c(this.__options.input),this.__menuWidget=new d(this.__options.menu),this.__maskWidget=new e(this.__options.mask),this.callBase(),this.__inputWidget.appendTo(this.__element),this.__menuWidget.positionTo(this.__inputWidget),void this.__initInputMenuEvent())},open:function(){this.__maskWidget.show(),this.__menuWidget.show()},close:function(){this.__maskWidget.hide(),this.__menuWidget.hide()},__initInputMenuEvent:function(){var a=this;this.on("buttonclick",function(){this.__menuState||(this.__appendMenu(),this.__menuState=!0),this.__inputWidget.unfocus(),this.open()}),this.on("keypress",function(){this.__lastTime=new Date}),this.on("keyup",function(a){8!==a.keyCode&&13!==a.keyCode&&new Date-this.__lastTime<500&&this.__update()}),this.on("inputcomplete",function(){this.__inputWidget.selectRange(99999999),this.__inputComplete()}),this.__menuWidget.on("select",function(b,c){b.stopPropagation(),a.setValue(c.value),a.trigger("select",c),a.close()}),this.__menuWidget.on("change",function(b,c){b.stopPropagation(),a.trigger("change",c)}),this.__inputWidget.on("select change",function(a){a.stopPropagation()}),this.__maskWidget.on("maskclick",function(){a.close()}),this.on("select",function(a,b){this.__lastSelect=b})},__update:function(){var b=this.getValue(),c=b.toLowerCase(),d=this.__getItemValues(),e=null;b&&(a.each(d,function(a,b){return 0===b.toLowerCase().indexOf(c)?(e=b,!1):void 0}),e&&(this.__inputWidget.setValue(e),this.__inputWidget.selectRange(b.length)))},__getItemValues:function(){var b=[];return a.each(this.__menuWidget.getWidgets(),function(a,c){b.push(c.getValue())}),b},__inputComplete:function(){var b=this.__getItemValues(),c=-1,d=this.getValue(),e=this.__lastSelect;a.each(b,function(a,b){return b===d?(c=a,!1):void 0}),this.trigger("select",{index:c,value:d}),e&&e.value===d||this.trigger("change",{from:e||{index:-1,value:null},to:{index:c,value:d}})},__appendMenu:function(){this.__menuWidget.appendTo(this.__inputWidget.getElement().ownerDocument.body)}})}},_p[36]={value:function(){var a=_p.r(4),b=_p.r(12),c=_p.r(57);return _p.r(13).createClass("Buttonset",{base:_p.r(51),constructor:function(b){var c={selected:-1};b=a.extend({},c,b),this.callBase(b)},getButtons:function(){return this.getWidgets()},getButton:function(a){return this.getWidgets()[a]||null},getValue:function(){return this.__currentIndex>-1?this.__widgets[this.__currentIndex].getValue():null},getSelectedIndex:function(){return this.__currentIndex},appendButton:function(){return this.appendWidget.apply(this,arguments)},insertButton:function(){return this.insertWidget.apply(this,arguments)},select:function(b){return this.__options.disabled?this:(b instanceof c&&(b=a.inArray(b,this.__widgets)),0>b?this.clearSelect():(b=this.__widgets[b],this.__pressButton(b),this))},selectByValue:function(a){var b=this.__widgets.map(function(a){return a.getValue()});return this.select(b.indexOf(a))},clearSelect:function(){return this.__pressButton(null),this},removeButton:function(){return this.removeWidget.apply(this,arguments)},insertWidget:function(a,b){var c=this.callBase(a,b);return null===c?c:(a<=this.__currentIndex&&this.__currentIndex++,a<=this.__prevIndex&&this.__prevIndex++,c)},removeWidget:function(a){var b=a;return"number"!=typeof b&&(b=this.indexOf(a)),a=this.callBase(a),b===this.__currentIndex?this.__currentIndex=-1:b<this.__currentIndex&&this.__currentIndex--,b===this.__prevIndex?this.__prevIndex=-1:b<this.__prevIndex&&this.__prevIndex--,a},__initOptions:function(){this.callBase(),this.widgetName="Buttonset",this.__currentIndex=this.__options.selected,this.__prevIndex=-1},__render:function(){return this.callBase(),a(this.__element).addClass(b.classPrefix+"buttonset"),this.__initButtons(),this},__initButtons:function(){var b=this,d=null;a.each(this.__options.buttons,function(e,f){d=new c(a.extend({},f,{pressed:e===b.__options.selected,preventDefault:!0})),d.__on("click",function(){b.isDisabled()||b.__pressButton(this)}),d.__on("change",function(a){a.stopPropagation()}),b.appendButton(d)})},__pressButton:function(b){this.__prevIndex=this.__currentIndex,this.__currentIndex=this.indexOf(b),this.__currentIndex!==this.__prevIndex&&(b&&b.press(),a.each(this.__widgets,function(a,c){c!==b&&c.bounce()}),this.trigger("change",{currentIndex:this.__currentIndex,prevIndex:this.__prevIndex}))},__valid:function(a){return a instanceof c}})}},_p[37]={value:function(){var a=_p.r(4),b=_p.r(12),c=_p.r(19),d=_p.r(42),e=_p.r(48);return _p.r(13).createClass("Button",{base:_p.r(58),constructor:function(b){var c={label:null,text:null,icon:null,layout:"right"};b=a.extend({},c,b),this.callBase(b)},getLabel:function(){return this.__labelWidget.getText()},setLabel:function(a){return this.__labelWidget.setText(a)},__render:function(){switch(this.callBase(),this.__iconWidget=new d(this.__options.icon),this.__labelWidget=new e(this.__options.label),this.__options.layout){case"left":case"top":this.__element.appendChild(this.__labelWidget.getElement()),this.__element.appendChild(this.__iconWidget.getElement());break;case"right":case"bottom":default:this.__element.appendChild(this.__iconWidget.getElement()),this.__element.appendChild(this.__labelWidget.getElement())}a(this.__element).addClass(b.classPrefix+"button-layout-"+this.__options.layout)},__initOptions:function(){this.callBase(),this.widgetName="Button",this.__tpl=c,this.__iconWidget=null,this.__labelWidget=null,"object"!=typeof this.__options.label&&(this.__options.label={text:this.__options.label}),"object"!=typeof this.__options.icon&&(this.__options.icon={img:this.__options.icon})},__initEvent:function(){this.callBase(),this.on("click",function(){this.__trigger("btnclick")})}})}},_p[38]={value:function(){var a=_p.r(13),b=_p.r(12),c=_p.r(49),d=_p.r(20),e=_p.r(4);return a.createClass("ColorPicker",{base:_p.r(53),constructor:function(a){var b={clearText:"",commonText:"",commonColor:[["#ffffff","#000000","#eeece1","#1f497d","#4f81bd","#c0504d","#9bbb59","#8064a2","#4bacc6","#f79646"],["#f2f2f2","#808080","#ddd8c2","#c6d9f1","#dbe5f1","#f2dbdb","#eaf1dd","#e5dfec","#daeef3","#fde9d9"],["#d9d9d9","#595959","#c4bc96","#8db3e2","#b8cce4","#e5b8b7","#d6e3bc","#ccc0d9","#b6dde8","#fbd4b4"],["#bfbfbf","#404040","#938953","#548dd4","#95b3d7","#d99594","#c2d69b","#b2a1c7","#92cddc","#fabf8f"],["#a6a6a6","#262626","#4a442a","#17365d","#365f91","#943634","#76923c","#5f497a","#31849b","#e36c0a"],["#7f7f7f","#0d0d0d","#1c1a10","#0f243e","#243f60","#622423","#4e6128","#3f3151","#205867","#974706"]],standardText:"",standardColor:["#c00000","#ff0000","#ffc000","#ffff00","#92d050","#00b050","#00b0f0","#0070c0","#002060","#7030a0"]};a=e.extend({},b,a),this.callBase(a)},show:function(){return this.__inDoc||(this.__inDoc=!0,this.appendTo(this.__element.ownerDocument.body)),this.__maskWidget.show(),this.callBase(),this},hide:function(){return this.callBase(),this.__maskWidget.hide(),this},attachTo:function(a){var b=this;a.on("click",function(){b.appendTo(a.getElement().ownerDocument.body),b.positionTo(a),b.show()})},__initOptions:function(){this.callBase(),this.widgetName="ColorPicker",this.__contentElement=null,this.__maskWidget=null,this.__inDoc=!1},__render:function(){this.callBase(),e(this.__element).addClass(b.classPrefix+"colorpicker");var f=a.Tpl.compile(d,this.__options);this.__contentElement.appendChild(e(f)[0]),this.__previewElement=e(this.__contentElement).find("."+b.classPrefix+"colorpicker-preview"),this.__clearElement=e(this.__contentElement).find("."+b.classPrefix+"colorpicker-clear"),this.__maskWidget=new c(this.__options.mask)},__initEvent:function(){var a=this;this.callBase(),this.on("click",function(c){var d,f=e(c.target);f.hasClass(b.classPrefix+"colorpicker-item")?(d=f.attr("data-color"),a.trigger("selectcolor",d),a.hide()):f.hasClass(b.classPrefix+"colorpicker-clear")&&(a.trigger("selectcolor",""),a.hide())}),this.on("mouseover",function(c){var d,f=e(c.target);f.hasClass(b.classPrefix+"colorpicker-item")&&(d=f.attr("data-color"),e(a.__element).find("."+b.classPrefix+"colorpicker-preview").css({"background-color":d,"border-color":d}))}),this.__maskWidget.on("click",function(){a.hide()})}})}},_p[39]={value:function(){var a=_p.r(13),b=_p.r(12),c=_p.r(58),d=_p.r(0),e=_p.r(4);return a.createClass("Container",{base:c,constructor:function(a){var b={column:!1,widgets:null};a=e.extend({},b,a),this.callBase(a)},indexOf:function(a){return e.inArray(a,this.__widgets)},disable:function(){this.callBase(),e.each(this.__widgets,function(a,b){b.disable()})},enable:function(){this.callBase(),e.each(this.__widgets,function(a,b){b.enable()})},getWidgets:function(){return this.__widgets},getWidget:function(a){return this.__widgets[a]||null},getWidgetByValue:function(a){var b=null;return e.each(this.__widgets,function(c,d){return d.getValue()===a?(b=d,!1):void 0}),b},appendWidget:function(a){return this.__valid(a)?(this.__options.disabled&&a.disable(),this.__widgets.push(a),a.appendTo(this.__contentElement),this.__options.column&&(this.__contentElement.appendChild(e('<span class="fui-column"></span>')[0]),e(a.getElement()).addClass(b.classPrefix+"panel-column-widget")),a):null},appendWidgets:function(a){var b=this,c=a;return e.isArray(a)||(c=arguments),e.each(c,function(a,c){b.appendWidget(c)}),this},insertWidget:function(a,c){var d=null;return 0===this.__widgets.length?this.appendWidget(c):this.__valid(c)?(this.__options.disabled&&c.disable(),d=this.__widgets[a],this.__widgets.splice(a,0,c),this.__contentElement.insertBefore(c.getElement(),d.getElement()),this.__options.column&&(this.__contentElement.insertBefore(e('<span class="fui-column"></span>')[0],d.getElement()),e(c.getElement()).addClass(b.classPrefix+"panel-column-widget")),c):null},insertWidgets:function(a,b){var c=this,d=b;return e.isArray(b)||(d=[].slice.call(arguments,1)),e.each(d,function(b,d){c.insertWidget(a,d),a++}),this},getContentElement:function(){return this.__contentElement},removeWidget:function(a){return"number"==typeof a?a=this.__widgets.splice(a,1):this.__widgets.splice(this.indexOf(a),1),this.__contentElement.removeChild(a.getElement()),e(a.getElement()).removeClass(b.classPrefix+"panel-column-widget"),a},__initOptions:function(){this.widgetName="Container",this.__widgets=[],this.__contentElement=null},__render:function(){return this.callBase(),this.__contentElement=this.__element,e(this.__element).addClass(b.classPrefix+"container"),this.__options.column&&e(this.__element).addClass(b.classPrefix+"container-column"),this},__appendChild:function(a){return this.appendWidget(a)},__initWidgets:function(){if(this.__options.widgets){var a=d.parse(this.__options.widgets),b=this;e.isArray(a)||(a=[a]),e.each(a,function(a,c){b.appendWidget(c)})}},__valid:function(a){return a instanceof c}})}},_p[40]={value:function(){var a=_p.r(13),b=_p.r(12),c=_p.r(58),d=_p.r(49),e=_p.r(21),f=_p.r(37),g=b.layout,h=_p.r(4),i={CANCEL:"cancel",OK:"ok"};return a.createClass("Dialog",{base:_p.r(53),constructor:function(a){var c={layout:g.CENTER,caption:null,resize:"height",draggable:!0,closeButton:!0,mask:{color:"#000",opacity:.2},buttons:[{className:b.classPrefix+"xdialog-ok-btn",action:"ok",label:"确定"},{className:b.classPrefix+"xdialog-cancel-btn",action:"cancel",label:"取消"}]};a=h.extend({},c,a),this.callBase(a)},open:function(){return this.__fire("open",function(){this.show()}),this},close:function(){return this.__fire("close",function(){this.hide()}),this},getButtons:function(){return this.__buttons},getButton:function(a){return this.__buttons[a]},appendTo:function(a){return this.callBase(a),this.__maskWidget.appendTo(a),this.__inDoc=!0,this},show:function(){return this.__target||(this.__target=this.__element.ownerDocument.body),this.__inDoc||this.appendTo(this.__element.ownerDocument.body),this.__maskWidget.show(),this.callBase(),this.__openState=!0,this},hide:function(){return this.callBase(),this.__maskWidget.hide(),this.__openState=!1,this},toggle:function(){return this.isOpen()?this.close():this.open(),this},isOpen:function(){return this.__openState},getHeadElement:function(){return this.__headElement},getBodyElement:function(){return this.getContentElement()},getFootElement:function(){return this.__footElement},__initOptions:function(){this.callBase(),this.widgetName="Dialog",this.__target=this.__options.target,this.__layout=this.__options.layout,this.__inDoc=!1,this.__hinting=!1,this.__openState=!1,this.__headElement=null,this.__bodyElement=null,this.__footElement=null,this.__maskWidget=null,this.__buttons=[],this.__target instanceof c&&(this.__target=this.__target.getElement())},__render:function(){this.callBase(),this.__innerTpl=a.Tpl.compile(e,this.__options),this.__contentElement.appendChild(h(this.__innerTpl)[0]),h(this.__element).addClass(b.classPrefix+"dialog"),this.__headElement=h(".fui-dialog-head",this.__contentElement)[0],this.__bodyElement=h(".fui-dialog-body",this.__contentElement)[0],this.__footElement=h(".fui-dialog-foot",this.__contentElement)[0],this.__maskWidget=new d(this.__options.mask),this.__contentElement=this.__bodyElement,this.__options.draggable&&this.__initDraggable(),this.__options.closeButton&&this.__initCloseButton(),this.__initButtons(),this.__initMaskLint()},__action:function(a){switch(a){case i.OK:this.__triggerHandler(a)!==!1&&this.close();break;case i.CANCEL:this.__triggerHandler(a),this.close()}},__initButtons:function(){var a=this,b=null,c=this.__footElement;h.each(this.__options.buttons,function(d,e){b=new f(e),b.appendTo(c),a.__buttons.push(b)})},__initEvent:function(){var a=this;this.callBase(),h([this.__footElement,this.__headElement]).on("btnclick",function(b,c){a.__action(c.getOptions().action,c)})},__initDraggable:function(){a.createDraggable({handler:this.__headElement,target:this.__element}).bind()},__initCloseButton:function(){var a=new f({className:"fui-close-button",action:"cancel",icon:{className:"fui-close-button-icon"}});a.appendTo(this.__headElement)},__initMaskLint:function(){var a=this;this.__maskWidget.on("click",function(){a.__hint()})},__hint:function(){if(!this.__hinting){this.__hinting=!0;var a=h(this.__element),c=this,d=[b.classPrefix+"mask-hint",b.classPrefix+"mask-animate"];a.addClass(d.join(" ")),window.setTimeout(function(){a.removeClass(d[0]),window.setTimeout(function(){a.removeClass(d[1]),c.__hinting=!1},200)},200)}}})}},_p[41]={value:function(){var a=_p.r(4),b=_p.r(12),c=_p.r(22),d=_p.r(37),e=_p.r(51),f=_p.r(53),g=_p.r(49);return _p.r(13).createClass("DropPanel",{base:_p.r(58),constructor:function(b){var c={button:null,panel:null,width:null,height:null};b=a.extend({},c,b),this.callBase(b)},disable:function(){this.callBase()},enable:function(){this.callBase()},open:function(){this.__popupWidget.appendWidget(this.__panelWidget),this.__maskWidget.show(),this.__popupWidget.show();var b=a(this.__popupWidget.getElement());b.css("top",parseInt(b.css("top"))-a(this.__element).outerHeight()),b.css("min-width",a(this.__element).outerWidth()),b.css("min-height",a(this.__element).height())},close:function(){this.__maskWidget.hide(),this.__popupWidget.hide(),this.__panelWidget.appendTo(this.__contentElement)},getPanelElement:function(){return this.__panelWidget.getElement()},appendWidget:function(a){this.__panelWidget.appendWidget(a)},getWidgets:function(){return this.__panelWidget.getWidgets()},getWidget:function(a){return this.__panelWidget.getWidget(a)},appendWidgets:function(){return this.__panelWidget.appendWidgets.apply(this,arguments),this},insertWidget:function(a,b){this.__panelWidget.insertWidget(a,b)},insertWidgets:function(){return this.__panelWidget.insertWidgets.apply(this,arguments),this},removeWidget:function(a){return this.__panelWidget.removeWidget(a)},__render:function(){this.__initOptions(),this.__buttonWidget=new d(this.__options.button),this.__panelWidget=new e(this.__options.content),this.__popupWidget=new f,this.__maskWidget=new g(this.__options.mask),this.callBase(),this.__popupWidget.positionTo(this.__element),a(this.__popupWidget.getElement()).addClass(b.classPrefix+"drop-panel-popup");var c=a('<div class="'+b.classPrefix+'drop-panel-content"></div>').append(this.__panelWidget.getElement());this.__contentElement=c[0],a(this.__element).append(c).append(this.__buttonWidget.getElement()),this.__initDropPanelEvent()},__initOptions:function(){this.widgetName="DropPanel",this.__tpl=c,this.__buttonWidget=null,this.__popupWidget=null,this.__panelWidget=null,this.__contentElement=null,this.__maskWidget=null,this.__popupState=!1,"object"!=typeof this.__options.button&&(this.__options.input={icon:this.__options.button})},__initDropPanelEvent:function(){var a=this;this.__buttonWidget.on("click",function(){a.__popupState||(a.__appendPopup(),a.__popupState=!0),a.trigger("buttonclick"),a.open()}),this.__panelWidget.on("click",function(){a.trigger("panelclick")}),this.__maskWidget.on("maskclick",function(){a.close()})},__appendPopup:function(){this.__popupWidget.appendTo(this.__element.ownerDocument.body)}})}},_p[42]={value:function(){var a=_p.r(4),b=_p.r(23);return _p.r(13).createClass("Icon",{base:_p.r(58),constructor:function(b){var c={img:null};b=a.extend({},c,b),this.callBase(b)},getValue:function(){return this.__options.value||this.__options.img},setImage:function(a){return this.__options.img===a?this:(this.__image&&(this.__image.src=a),void this.trigger("iconchange",{prevImage:this.__prevIcon,currentImage:this.__currentIcon}))},getImage:function(){return this.__currentIcon},__initOptions:function(){this.callBase(),this.widgetName="Icon",this.__tpl=b,this.__prevIcon=null,this.__currentIcon=this.__options.img,this.__image=null},__render:function(){this.__options.__width=this.__options.width,this.__options.__height=this.__options.height,this.__options.width=null,this.__options.height=null,this.callBase(),this.__options.img&&(this.__image=a("img",this.__element)[0],null!==this.__options.__width&&(this.__image.width=this.__options.__width),null!==this.__options.__height&&(this.__image.height=this.__options.__height))}})}},_p[43]={value:function(){var a=_p.r(4),b=_p.r(12),c=_p.r(24),d=_p.r(37),e=_p.r(45);return _p.r(13).createClass("InputButton",{base:_p.r(58),constructor:function(b){var c={button:null,input:null,placeholder:null,layout:"right"};b=a.extend({},c,b),this.callBase(b)},getValue:function(){return this.__inputWidget.getValue()},setValue:function(a){return this.__inputWidget.setValue(a),this},reset:function(){this.__inputWidget.reset()},selectAll:function(){return this.__inputWidget.selectAll(),this},selectRange:function(a,b){return this.__inputWidget.selectRange(a,b),this},focus:function(){return this.__inputWidget.focus(),this},unfocus:function(){return this.__inputWidget.unfocus(),this},__initOptions:function(){this.callBase(),this.widgetName="InputButton",this.__tpl=c,this.__inputWidget=null,this.__buttonWidget=null,"object"!=typeof this.__options.input&&(this.__options.input={placeholder:this.__options.input}),this.__options.input=a.extend({},this.__options.input,{placeholder:this.__options.placeholder}),"object"!=typeof this.__options.button&&(this.__options.button={icon:this.__options.button})},__render:function(){var c=this;switch(this.callBase(),this.__buttonWidget=new d(this.__options.button),this.__inputWidget=new e(this.__options.input),this.__options.layout){case"left":case"top":this.__buttonWidget.appendTo(this.__element),this.__inputWidget.appendTo(this.__element);break;case"right":case"bottom":default:this.__inputWidget.appendTo(this.__element),this.__buttonWidget.appendTo(this.__element)}a(this.__element).addClass(b.classPrefix+"layout-"+this.__options.layout),this.__buttonWidget.on("click",function(){c.trigger("buttonclick")})}})}},_p[44]={value:function(){var a=_p.r(4),b=_p.r(25),c=_p.r(43),d=_p.r(50),e=_p.r(49);return _p.r(13).createClass("InputMenu",{base:_p.r(58),constructor:function(b){var c={input:null,menu:null,mask:null,selected:-1};b=a.extend({},c,b),this.callBase(b)},select:function(a){this.__menuWidget.select(a)},selectByValue:function(a){return this.__selectBy("values",a)},selectByLabel:function(a){return this.__selectBy("labels",a)},clearSelect:function(){return this.__lastSelect=-1,this.__menuWidget.clearSelect(),this.__inputWidget.reset(),this},setValue:function(){return this},getValue:function(){return this.__menuWidget.getSelectedItem().getValue()},open:function(){this.__maskWidget.show(),this.__menuWidget.show()},close:function(){this.__maskWidget.hide(),this.__menuWidget.hide()},__render:function(){this.__inputWidget=new c(this.__options.input),this.__menuWidget=new d(this.__options.menu),this.__maskWidget=new e(this.__options.mask),this.callBase(),this.__inputWidget.appendTo(this.__element),this.__menuWidget.positionTo(this.__inputWidget),this.__initInputValue()},__selectBy:function(b,c){var d=this.__getItemValues()[b],e=-1;return a.each(d,function(a,b){return c===b?(e=a,!1):void 0}),-1!==e?(this.select(e),this.__menuWidget.getSelectedItem()):null},__initInputValue:function(){var a=this.__menuWidget.getItem(this.__options.selected);a&&this.__inputWidget.setValue(a.getLabel())},__initEvent:function(){var a=this;this.callBase(),this.on("buttonclick",function(){this.__menuState||(this.__appendMenu(),this.__menuState=!0),this.__inputWidget.unfocus(),this.open()}),this.on("keypress",function(){this.__lastTime=new Date}),this.on("keyup",function(a){8!==a.keyCode&&13!==a.keyCode&&new Date-this.__lastTime<500&&this.__update()}),this.on("inputcomplete",function(){this.__inputWidget.selectRange(99999999),this.__inputComplete()}),this.__menuWidget.on("select",function(b,c){b.stopPropagation(),a.__inputWidget.setValue(c.label),a.trigger("select",c),a.close()}),this.__menuWidget.on("change",function(b,c){b.stopPropagation(),a.trigger("change",c)}),this.__inputWidget.on("select change",function(a){a.stopPropagation()}),this.__maskWidget.on("maskclick",function(){a.close()}),this.on("select",function(a,b){this.__lastSelect=b})},__update:function(){var b=this.__inputWidget.getValue(),c=b.toLowerCase(),d=this.__getItemValues().labels,e=null;b&&(a.each(d,function(a,b){return 0===b.toLowerCase().indexOf(c)?(e=b,!1):void 0}),e&&(this.__inputWidget.setValue(e),this.__inputWidget.selectRange(b.length)))},__getItemValues:function(){var b=[],c=[];return a.each(this.__menuWidget.getWidgets(),function(a,d){c.push(d.getLabel()),b.push(d.getValue())}),{labels:c,values:b}},__inputComplete:function(){var b=this.__getItemValues(),c=b.labels,d=-1,e=this.__inputWidget.getValue(),f=this.__lastSelect;a.each(c,function(a,b){return b===e?(d=a,!1):void 0}),this.trigger("select",{index:d,label:e,value:b.values[d]}),f&&f.value===e||this.trigger("change",{from:f||{index:-1,label:null,value:null},to:{index:d,label:e,value:b.values[d]}})},__appendMenu:function(){this.__menuWidget.appendTo(this.__inputWidget.getElement().ownerDocument.body)},__initOptions:function(){this.callBase(),this.widgetName="InputMenu",this.__tpl=b,this.__lastTime=0,this.__lastSelect=null,this.__inputWidget=null,this.__menuWidget=null,this.__maskWidget=null,this.__menuState=!1,-1!==this.__options.selected&&(this.__options.menu.selected=this.__options.selected)}})}},_p[45]={value:function(){var a=_p.r(12),b=_p.r(4),c=_p.r(26);return _p.r(13).createClass("Input",{base:_p.r(58),constructor:function(a){var c={placeholder:null};a=b.extend({},c,a),this.callBase(a)},getValue:function(){return this.__element.value},setValue:function(a){return this.__element.value=a,this},disable:function(){this.callBase(),this.__element.disabled=!0},enable:function(){this.__element.disabled=!1,this.callBase()},reset:function(){return this.__element.value=this.__options.value||"",this},selectAll:function(){this.__element.select()},selectRange:function(a,b){a||(a=0),b||(b=1e9),this.__element.setSelectionRange(a,b)},focus:function(){return this.__element.focus(),this},unfocus:function(){return this.__element.blur(),this},__initOptions:function(){this.callBase(),this.widgetName="Input",this.__tpl=c,this.__allow_focus=!0},__render:function(){this.callBase(),this.__element.removeAttribute("unselectable"),this.__options.placeholder&&this.__element.setAttribute("placeholder",this.__options.placeholder),this.addClass(a.classPrefix+"selectable")},__initEvent:function(){this.callBase(),this.on("keydown",function(a){13===a.keyCode&&this.trigger("inputcomplete",{value:this.getValue()})})}})}},_p[46]={value:function(){var a=_p.r(13),b=_p.r(27),c=_p.r(42),d=_p.r(48),e=_p.r(12),f=_p.r(4);return a.createClass("Item",{base:_p.r(58),constructor:function(a){var b={label:"",icon:null,selected:!1,textAlign:"left"};a=f.extend({},b,a),this.callBase(a)},getValue:function(){return this.__options.value||this.__labelWidget.getValue()||this.__iconWidget.getValue()||null},select:function(){return this.__update(!0),this},unselect:function(){return this.__update(!1),this},isSelected:function(){return this.__selectState},setLabel:function(a){return this.__labelWidget.setText(a),this},getLabel:function(){return this.__labelWidget.getText()},setIcon:function(a){return this.__iconWidget.setImage(a),this},getIcon:function(){return this.__iconWidget.getImage()},__render:function(){this.callBase(),this.__iconWidget=new c(this.__options.icon),this.__labelWidget=new d(this.__options.label),this.__iconWidget.appendTo(this.__element),this.__labelWidget.appendTo(this.__element)
},__update:function(a){var b=a?"addClass":"removeClass";return a=!!a,f(this.__element)[b](e.classPrefix+"item-selected"),this.__selectState=a,this.trigger(a?"itemselect":"itemunselect"),this},__initEvent:function(){this.callBase(),this.on("click",function(){this.trigger("itemclick")})},__initOptions:function(){this.callBase(),this.widgetName="Item",this.__tpl=b,this.__iconWidget=null,this.__labelWidget=null,this.__selectState=this.__options.selected,"object"!=typeof this.__options.label&&(this.__options.label={text:this.__options.label}),this.__options.label.textAlign||(this.__options.label.textAlign=this.__options.textAlign),"object"!=typeof this.__options.icon&&(this.__options.icon={img:this.__options.icon})}})}},_p[47]={value:function(){var a=_p.r(13),b=_p.r(12),c=_p.r(48),d=_p.r(4);return a.createClass("LabelPanel",{base:_p.r(51),constructor:function(a){var b={layout:"bottom"};a=d.extend({},b,a),this.callBase(a)},disable:function(){this.callBase(),this.__labelWidget.disable()},enable:function(){this.callBase(),this.__labelWidget.enable()},__render:function(){var a=null,e=this.__options,f=this.__element,g=b.classPrefix,h="fui-label-panel-content",i=null;return this.__labelWidget=new c(e.label),this.callBase(),i=this.__contentElement,d(f).addClass(g+"label-panel"),d(f).addClass(g+"layout-"+e.layout),a=d('<div class="'+h+'"></div>'),i.appendChild(this.__labelWidget.getElement()),i.appendChild(a[0]),this.__contentElement=a[0],this},__initOptions:function(){var a=this.__options.label;this.callBase(),this.widgetName="LabelPanel",this.__labelWidget=null,"object"!=typeof a&&(this.__options.label={text:a}),this.__options.label.className||(this.__options.label.className=""),this.__options.label.className+=" fui-label-panel-label"}})}},_p[48]={value:function(){var a=_p.r(13),b=_p.r(28),c=_p.r(4);return a.createClass("Label",{base:_p.r(58),constructor:function(a){var b={text:"",textAlign:"center"};a=c.extend({},b,a),this.callBase(a)},getValue:function(){return this.__options.text},setText:function(a){var b=this.__options.text;return this.__options.text=a,c(this.__element).text(a),this.trigger("labelchange",{currentText:a,prevText:b}),this},getText:function(){return this.__options.text},__allowShowTitle:function(){return!1},__initOptions:function(){this.callBase(),this.widgetName="Label",this.__tpl=b,this.__options.text=this.__options.text.toString()}})}},_p[49]={value:function(){function a(){e(window).on("resize",function(){e.each(g,function(a,b){b&&!b.isHide()&&b.__resize()})})}var b=_p.r(13),c=_p.r(29),d=_p.r(58),e=_p.r(4),f=!1,g=[];return b.createClass("Mask",{base:_p.r(58),constructor:function(a){var b={bgcolor:"#000",opacity:0,inner:!0,target:null,scroll:!1,hide:!0};a=e.extend({},b,a),this.callBase(a)},maskTo:function(a){return a&&(this.__target=a),this},show:function(){var a=null;this.__target||(this.__target=this.__element.ownerDocument.body),a=this.__target.ownerDocument.documentElement,e.contains(a,this.__element)||this.appendTo(this.__target.ownerDocument.body),this.callBase(),this.__position(),this.__resize(),this.__hideState=!1},hide:function(){this.callBase(),this.__hideState=!0},isHide:function(){return this.__hideState},__initOptions:function(){this.callBase(),this.widgetName="Mask",this.__tpl=c,this.__cacheId=g.length,this.__hideState=!0,g.push(this),this.__target=this.__options.target,this.__target instanceof d&&(this.__target=this.__target.getElement())},__render:function(){this.callBase(),this.__initMaskEvent(),f||(f=!0,a())},__initMaskEvent:function(){this.on("mousewheel",function(a){var b=a.originalEvent;a.preventDefault(),a.stopPropagation(),this.trigger("scroll",{delta:b.wheelDelta||b.deltaY||b.detail})}),this.on("click",function(a){a.stopPropagation(),a.target===this.__element&&this.trigger("maskclick")})},__resize:function(){var a=null;this.__targetIsBody()?(a=e(b.getView(this.__target)),a={width:a.width(),height:a.height()}):a=b.getRect(this.__target),this.__element.style.width=a.width+"px",this.__element.style.height=a.height+"px"},__position:function(){var a=null,c=null;this.__targetIsBody()?a={top:0,left:0}:(c=b.getRect(this.__target),a={top:c.top,left:c.left}),e(this.__element).css("top",a.top+"px").css("left",a.left+"px")},__targetIsBody:function(){return"body"===this.__target.tagName.toLowerCase()}})}},_p[50]={value:function(){var a=_p.r(13),b=_p.r(46),c=_p.r(12),d=_p.r(4);return a.createClass("Menu",{base:_p.r(53),constructor:function(a){var b={column:!0,selected:-1,textAlign:"left",items:[]};a=d.extend({},b,a),this.callBase(a)},select:function(a){var b=this.__widgets[a];return b?(this.__selectItem(b),this):this},clearSelect:function(){var a=this.getSelectedItem();a&&a.unselect(),this.__currentSelect=-1,this.__prevSelect=-1},getItems:function(){return this.getWidgets.apply(this,arguments)},getItem:function(){return this.getWidget.apply(this,arguments)},appendItem:function(){return this.appendWidget.apply(this,arguments)},insertItem:function(){return this.insertWidget.apply(this,arguments)},removeItem:function(){return this.removeWidget.apply(this,arguments)},getSelected:function(){return this.__currentSelect},getSelectedItem:function(){return this.getItem(this.__currentSelect)},insertWidget:function(a,b){var c=this.callBase(a,b);return null===c?c:(a<=this.__currentSelect&&this.__currentSelect++,a<=this.__prevSelect&&this.__prevSelect++,c)},removeWidget:function(a){var b=a;return"number"!=typeof b&&(b=this.indexOf(a)),a=this.callBase(a),b===this.__currentSelect?this.__currentSelect=-1:b<this.__currentSelect&&this.__currentSelect--,b===this.__prevSelect?this.__prevSelect=-1:b<this.__prevSelect&&this.__prevSelect--,a},__initOptions:function(){this.callBase(),this.__prevSelect=-1,this.__currentSelect=this.__options.selected,this.widgetName="Menu"},__render:function(){var a=this,e=this.__options.textAlign,f=this.__options.selected;this.callBase(),d(this.__element).addClass(c.classPrefix+"menu"),d.each(this.__options.items,function(c,d){"object"!=typeof d&&(d={label:d}),d.selected=c===f,d.textAlign=e,a.appendItem(new b(d))})},__initEvent:function(){this.callBase(),this.on("itemclick",function(a){this.__selectItem(a.widget)})},__selectItem:function(a){if(this.__currentSelect>-1&&this.__widgets[this.__currentSelect].unselect(),this.__prevSelect=this.__currentSelect,this.__currentSelect=this.indexOf(a),a.select(),this.trigger("select",{index:this.__currentSelect,label:a.getLabel(),value:a.getValue()}),this.__prevSelect!==this.__currentSelect){var b=this.__widgets[this.__prevSelect]||null;this.trigger("change",{from:{index:this.__prevSelect,label:b&&b.getLabel(),value:b&&b.getValue()},to:{index:this.__currentSelect,label:a.getLabel(),value:a.getValue()}})}},__valid:function(a){return a instanceof b}})}},_p[51]={value:function(){var a=_p.r(13),b=_p.r(30),c=_p.r(4);return a.createClass("Panel",{base:_p.r(39),constructor:function(a){var b={};a=c.extend({},b,a),this.callBase(a)},__render:function(){var a=null;this.callBase(),a=c('<div class="fui-panel-content"></div>'),this.__contentElement.appendChild(a[0]),this.__contentElement=a[0]},__initOptions:function(){this.callBase(),this.widgetName="Panel",this.__tpl=b}})}},_p[52]={value:function(){var a=_p.r(13),b=_p.r(12),c=_p.r(58),d=_p.r(49),e=_p.r(4);return a.createClass("Popup",{base:_p.r(53),constructor:function(a){var b={mask:{}};a=e.extend({},b,a),this.callBase(a)},open:function(){return this.__fire("open",function(){this.show()}),this},close:function(){return this.__fire("close",function(){this.hide()}),this},show:function(){return this.__target||(this.__target=this.__element.ownerDocument.body),this.__inDoc||(this.__inDoc=!0,this.appendTo(this.__element.ownerDocument.body)),this.__maskWidget.show(),this.callBase(),this.__openState=!0,this},hide:function(){return this.callBase(),this.__maskWidget.hide(),this.__openState=!1,this},toggle:function(){return this.isOpen()?this.close():this.open(),this},isOpen:function(){return this.__openState},__initOptions:function(){this.callBase(),this.widgetName="Popup",this.__target=this.__options.target,this.__layout=this.__options.layout,this.__inDoc=!1,this.__openState=!1,this.__maskWidget=null,this.__target instanceof c&&(this.__target=this.__target.getElement())},__render:function(){this.callBase(),e(this.__element).addClass(b.classPrefix+"popup"),this.__maskWidget=new d(this.__options.mask),this.__options.draggable&&this.__initDraggable(),this.__initMaskEvent()},__initMaskEvent:function(){var a=this;this.__maskWidget.on("click",function(){a.close()})}})}},_p[53]={value:function(){var a=_p.r(13),b=_p.r(12),c=_p.r(58),d=b.layout,e=_p.r(4);return a.createClass("PPanel",{base:_p.r(51),constructor:function(a){var b={layout:d.BOTTOM,target:null,bound:null,diff:10,hide:!0,resize:"all"};a=e.extend({},b,a),this.callBase(a)},positionTo:function(a,b){return a instanceof c&&(a=a.getElement()),this.__target=a,b&&(this.__layout=b),this},show:function(){var b=null;return this.__target?(this.__options.bound||(this.__options.bound=this.__target.ownerDocument.body),b=this.__target.ownerDocument.documentElement,e.contains(b,this.__element)||this.__target.ownerDocument.body.appendChild(this.__element),e.contains(b,this.__target)&&(this.callBase(a.getMarker()),this.__position(),this.__resize()),this):this.callBase()},__initOptions:function(){this.callBase(),this.widgetName="PPanel",this.__target=this.__options.target,this.__layout=this.__options.layout,this.__height_resized=!1},__render:function(){this.callBase(),e(this.__element).addClass(b.classPrefix+"ppanel")},__position:function(){var a=null,c=b.classPrefix+"ppanel-position";e(this.__element).addClass(c),a=this.__getLocation(),e(this.__element).css("top",a.top+"px").css("left",a.left+"px")},__resize:function(){var b=a.getBound(this.__target);switch(this.__options.resize){case"all":this.__resizeWidth(b),this.__resizeHeight();break;case"width":this.__resizeWidth(b);break;case"height":this.__resizeHeight()}},__resizeWidth:function(a){if(this.__target){var b=e(this.__element),c=b.outerWidth(),d=b.outerHeight(),f=a.width-c-d;this.__element.style.minWidth=f+"px"}},__resizeHeight:function(){var b=null,c=null,d=0;c=a.getRect(this.__element),c.height=this.__element.scrollHeight,c.bottom=c.top+c.height,b=this.__getBoundRect(),d=c.bottom-b.bottom,d>0?(this.__height_resized=!0,d=c.height-d-this.__options.diff,e(this.__element).css("height",d+"px")):this.__height_resized&&(this.__element.style.height=null)},__getLocation:function(){var b=a.getBound(this.__target);switch(this.__layout){case d.CENTER:case d.MIDDLE:return this.__getCenterLayout(b);case d.LEFT:case d.RIGHT:case d.BOTTOM:case d.TOP:return this.__getOuterLayout(b);default:return this.__getInnerLayout(b)}return location},__getCenterLayout:function(b){var c={top:0,left:0},d=a.getRect(this.__element),e=0;return e=b.height-d.height,e>0&&(c.top=b.top+e/2),e=b.width-d.width,e>0&&(c.left=b.left+e/2),c},__getOuterLayout:function(b){var c={top:0,left:0},e=a.getRect(this.__element);switch(this.__layout){case d.TOP:c.left=b.left,c.top=b.top-e.height;break;case d.LEFT:c.top=b.top,c.left=b.left-e.width;break;case d.RIGHT:c.top=b.top,c.left=b.right;break;case d.BOTTOM:default:c.left=b.left,c.top=b.bottom}return c},__getInnerLayout:function(b){var c={top:0,left:0},e=b,f=a.getRect(this.__element);switch(this.__layout){case d.LEFT_TOP:c.top=e.top,c.left=e.left;break;case d.RIGHT_TOP:c.top=e.top,c.left=e.left+e.width-f.width;break;case d.LEFT_BOTTOM:c.top=e.top+e.height-f.height,c.left=e.left;break;case d.RIGHT_BOTTOM:c.top=e.top+e.height-f.height,c.left=e.left+e.width-f.width}return this.__correctionLocation(c)},__getBoundRect:function(){var b=-1,c=-1,d=null;return"body"===this.__options.bound.tagName.toLowerCase()?(d=a.getView(this.__options.bound),b=e(d).width(),c=e(d).height(),{top:0,left:0,right:b,bottom:c,width:b,height:c}):a.getRect(this.__options.bound)},__correctionLocation:function(b){var c=a.getRect(this.__element),e=a.getRect(this.__target),f=this.__getBoundRect();switch(this.__layout){case d.LEFT_TOP:case d.LEFT_BOTTOM:b.left+c.width>f.right&&(b.left+=e.width-c.width);break;case d.RIGHT_TOP:case d.RIGHT_BOTTOM:b.left<f.left&&(b.left=e.left)}return b}})}},_p[54]={value:function(){var a=_p.r(13),b=_p.r(31),c=_p.r(4);return a.createClass("Separator",{base:_p.r(58),constructor:function(a){var b={width:1,height:"100%",bgcolor:"#e1e1e1"};a=c.extend({},b,a),this.callBase(a)},__initOptions:function(){this.callBase(),this.widgetName="Separator",this.__tpl=b}})}},_p[55]={value:function(){var a=_p.r(4),b=_p.r(12),c=_p.r(32),d=_p.r(37),e=_p.r(45),f=_p.r(51);return _p.r(13).createClass("SpinButton",{base:_p.r(58),constructor:function(b){var c={suffix:null,selected:-1,items:[]};b=a.extend({},c,b),this.callBase(b)},getValue:function(){return this.__options.items[this.__currentSelected]||null},setValue:function(){},select:function(a){this.__update(a)},selectByValue:function(b){b+="",this.__update(a.inArray(b,this.__options.items))},__render:function(){this.callBase(),this.__buttons=[new d({className:b.classPrefix+"spin-up-btn"}),new d({className:b.classPrefix+"spin-down-btn"})],this.__inputWidget=new e,this.__panelWidget=new f({column:!0}),this.__inputWidget.appendTo(this.__element),this.__panelWidget.appendWidget(this.__buttons[0]),this.__panelWidget.appendWidget(this.__buttons[1]),this.__panelWidget.appendTo(this.__element),this.__initSelected(this.__options.selected)},__initEvent:function(){var a=this;this.callBase(),this.__buttons[0].on("btnclick",function(){a.__update(a.__currentSelected-1)}),this.__buttons[1].on("btnclick",function(){a.__update(a.__currentSelected+1)})},__initSelected:function(a){this.__update(a,!1)},__update:function(a,b){var c=-1,d=null,e=null;0>a||a>=this.__options.items.length||(c=this.__currentSelected,this.__currentSelected=a,e=this.__options.items[this.__currentSelected],d=e+" "+(this.__options.suffix||""),this.__inputWidget.setValue(d),b!==!1&&this.trigger("change",{from:this.__options.items[c]||null,to:e}))},__initOptions:function(){var b=this.__options.items;this.callBase(),this.widgetName="SpinButton",this.__tpl=c,this.__buttons=[],this.__panelWidget=null,this.__inputWidget=null,this.__currentSelected=-1,a.each(b,function(a,c){b[a]=c+""})}})}},_p[56]={value:function(){var a=_p.r(4),b=_p.r(12),c=_p.r(33),d=_p.r(37),e=_p.r(51);return _p.r(13).createClass("Tabs",{base:_p.r(58),constructor:function(b){var c={selected:0,buttons:[],panels:null};b=a.extend({},c,b),this.callBase(b)},getButtons:function(){return this.__btns},getButton:function(a){return this.getButtons()[a]||null},getButtonByValue:function(b){var c=null;return a.each(this.__btns,function(a,d){return d.getValue()===b?(c=d,!1):void 0}),c},getPanels:function(){return this.__panels},getPanel:function(a){return this.getPanels()[a]||null},getPanelByValue:function(b){var c=null;return a.each(this.__panels,function(a,d){return d.getValue()===b?(c=d,!1):void 0}),c},getSelectedIndex:function(){return this.__selected},getSelected:function(){var a=this.getSelectedIndex();return{button:this.getButton(a),panel:this.getPanel(a)}},select:function(a){var b=null;return this.__selectItem(a)?(b=this.__getInfo(a),this.trigger("tabsselect",b),this.__prevSelected!==this.__selected&&this.trigger("tabschange",{from:this.__getInfo(this.__prevSelected),toInfo:b}),this):this},getIndexByButton:function(b){return a.inArray(b,this.__btns)},appendButtonTo:function(b){a.each(this.__btns,function(a,c){c.appendTo(b)})},appendPanelTo:function(b){a.each(this.__panels,function(a,c){c.appendTo(b)})},__render:function(){var b=this,c=null,f=null;this.callBase(),c=a(".fui-tabs-button-wrap",this.__element)[0],f=a(".fui-tabs-panel-wrap",this.__element)[0],a.each(this.__options.buttons,function(a,e){var f=null;"object"!=typeof e&&(e={label:e}),f=new d(e),f.on("click",function(){b.select(b.getIndexByButton(this))}),b.__btns.push(f),f.appendTo(c)}),a.each(this.__options.panels,function(a,c){var d=null;c=c||{hide:!0},c.hide=!0,d=new e(c),b.__panels.push(d),d.appendTo(f)}),this.__selectItem(this.__options.selected)},__initOptions:function(){this.callBase(),this.widgetName="Tabs",this.__tpl=c,this.__btns=[],this.__panels=[],this.__prevSelected=-1,this.__selected=-1,null===this.__options.panels&&(this.__options.panels=[],this.__options.panels.length=this.__options.buttons.length)},__selectItem:function(a){var c=this.getButton(a),d=this.getButton(this.__selected),e=b.classPrefix+"selected";return c?(d&&(d.removeClass(e),this.getPanel(this.__selected).hide()),c.addClass(e),this.getPanel(a).show(),this.__prevSelected=this.__selected,this.__selected=a,!0):!1},__getInfo:function(a){return{index:a,button:this.getButton(a),panel:this.getPanel(a)}}})}},_p[57]={value:function(){var a=_p.r(4),b=_p.r(12);return _p.r(13).createClass("ToggleButton",{base:_p.r(37),constructor:function(b){var c={pressed:!1};b=a.extend({},c,b),this.callBase(b)},isPressed:function(){return this.__state},press:function(){var c=b.classPrefix+"button-pressed";a(this.__element).addClass(c),this.__updateState(!0)},bounce:function(){var c=b.classPrefix+"button-pressed";a(this.__element).removeClass(c),this.__updateState(!1)},toggle:function(){this.__state?this.bounce():this.press()},__initOptions:function(){this.callBase(),this.widgetName="ToggleButton",this.__state=!1},__render:function(){return this.callBase(),a(this.__element).addClass(b.classPrefix+"toggle-button"),this.__initButtonState(),this},__initButtonState:function(){this.__options.pressed&&(a(this.__element).addClass(b.classPrefix+"button-pressed"),this.__state=!0)},__initEvent:function(){this.callBase(),this.on("click",function(){this.toggle()})},__updateState:function(a){a=!!a,this.__state=a,this.trigger("change",a,!a)}})}},_p[58]={value:function(){function a(){return b+ ++c}var b="_fui_",c=0,d=_p.r(12),e=_p.r(11),f=_p.r(4),g=_p.r(13),h=_p.r(13).createClass("Widget",{constructor:function(a){var b={id:null,className:"",disabled:!1,preventDefault:!1,text:"",value:null,hide:!1,width:null,height:null};this.__widgetType="widget",this.__tpl="",this.__compiledTpl="",this.__options={},this.__element=null,this.__allow_focus=!1,this.widgetName="Widget",this.__extendOptions(b,a),this.__initOptions(),this.__render(),this.__initEvent(),this.__initWidgets&&this.__initWidgets()},getId:function(){return this.id},getValue:function(){return this.__options.value},getOptions:function(){return this.__options},setValue:function(a){return this.__options.value=a,this},show:function(){return this.__show(),this},hide:function(){return this.__hide(),this},addClass:function(a){return f(this.__element).addClass(a),this},removeClass:function(a){return f(this.__element).removeClass(a),this},setStyle:function(){return f.fn.css.apply(f(this.__element),arguments),this},getStyle:function(){return f.fn.css.apply(f(this.__element),arguments)},isDisabled:function(){return this.__options.disabled},enable:function(){return this.__options.disabled=!1,f(this.__element).removeClass(d.classPrefix+"disabled"),this},disable:function(){return this.__options.disabled=!0,f(this.__element).addClass(d.classPrefix+"disabled"),this},getElement:function(){return this.__element},appendTo:function(a){if(g.isElement(a))a.appendChild(this.__element);else{if(!(a instanceof h))throw new Error("TypeError: Widget.appendTo()");a.__appendChild(this)}return this},off:function(a,b){return f(this.__element).off(b&&b.__fui_listener),this},on:function(a,b){return this.__options.preventDefault||this.__on(a,b),this},__initOptions:function(){},__render:function(){var a=null,b=this.__tpl,c=this.__options,h=null;return this.id=this.__id(),e.__registerInstance(this),this.__compiledTpl=g.Tpl.compile(b,c),this.__element=f(this.__compiledTpl)[0],this.__element.setAttribute("id",this.id),a=f(this.__element),c.disabled&&a.addClass(d.classPrefix+"disabled"),a.addClass(d.classPrefix+"widget"),h=c.className,h.length>0&&a.addClass(f.isArray(h)?h.join(" "):h),this.__initBasicEnv(),c.hide&&this.__hide(),c.style&&this.setStyle(c.style),this},__appendChild:function(a){return this.__element.appendChild(a.getElement())},__initEvent:function(){this.on("mousedown",function(a){var b=a.target.tagName.toLowerCase();d.control[b]||this.__allowFocus()?a.stopPropagation():a.preventDefault()})},__on:function(a,b){var c=this;return b.__fui_listener=function(a,d){for(var e=[],f=0,g=arguments.length;g>f;f++)1!==f&&e.push(arguments[f]);return a.widget=d,c.isDisabled()?void 0:b.apply(c,e)},f(this.__element).on(a,b.__fui_listener),this},trigger:function(){return this.__options.preventDefault||this.__trigger.apply(this,arguments),this},__allowShowTitle:function(){return!0},__allowFocus:function(){return!!this.__allow_focus},__trigger:function(a){var b=[].slice.call(arguments,1);return f(this.__element).trigger(a,[this].concat(b)),this},__triggerHandler:function(a){var b=[this].concat([].slice.call(arguments,1));return f(this.__element).triggerHandler(a,b)},__fire:function(a,b){var c={cancel:!1};return/^(before|after)/.test(a)?this:(this.__trigger("before"+a,c),c.cancel===!0?this:(c=b.call(this,a),this.__trigger(a),this.__trigger("after"+a,c),this))},__extendOptions:function(){var a=[{},this.__options],b=[!0];a=a.concat([].slice.call(arguments,0));for(var c=0,d=a.length;d>c;c++)"string"!=typeof a[c]&&b.push(a[c]);this.__options=f.extend.apply(f,b)},__hide:function(){f(this.__element).addClass(d.classPrefix+"hide")},__show:function(){f(this.__element).removeClass(d.classPrefix+"hide")},__initBasicEnv:function(){this.__options.text&&this.__allowShowTitle()&&this.__element.setAttribute("title",this.__options.text),this.__options.width&&(this.__element.style.width=this.__options.width+"px"),this.__options.height&&(this.__element.style.height=this.__options.height+"px"),this.widgetName&&this.__element.setAttribute("rule",this.widgetName)},__id:function(){return this.__options.id||a()}});return h}},_p[59]={value:function(){_p.r(1),_p.r(2)}};var moduleMapping={"fui.export":59};use("fui.export")}(),function(a){function b(a,b){this.id=a,this.username=b}function c(a){this.content=a,this.type=a instanceof Blob?g.file.TYPE_BLOB:"string"==typeof a?g.file.TYPE_TEXT:"object"==typeof a?g.file.TYPE_JSON:g.file.TYPE_UNKNOWN}function d(a){this.setPath(a),this.isDir=!1,this.data=null,this.size=0,this.createTime=new Date,this.modifyTime=new Date}function e(a,b,c){this.user=a,this.file=b,this.access=c||0}function f(a,b,c){this.path=a,this.method=b,this.user=c,this.dupPolicy=g.file.DUP_FAIL,this.newPath=null,this.acl=null,this.extra=null}var g={version:"1.0"};g.provider={},g.file={},g.user={};var h={},i=null,j=function(){return new a.resolve(null)},k={check:j,login:j,logout:j};d.prototype.setPath=function(a){var b,c;b=a.substr(a.lastIndexOf("/")+1),c=b.lastIndexOf("."),this.extendsion=~c?b.substr(c):null,this.name=~c?b.substr(0,c):b,this.filename=b,this.path=a},g.user.User=b,g.file.Data=c,g.file.File=d,g.file.Acl=e,g.file.FileRequest=f,g.file.TYPE_TEXT="text",g.file.TYPE_JSON="json",g.file.TYPE_BLOB="blob",g.file.TYPE_UNKNOWN="unknown",g.file.METHOD_READ="read",g.file.METHOD_WRITE="write",g.file.METHOD_LIST="list",g.file.METHOD_MOVE="move",g.file.METHOD_DELETE="delete",g.file.METHOD_MKDIR="mkdir",g.file.METHOD_ACL_READ="readAcl",g.file.METHOD_ACL_WRITE="writeAcl",g.file.DUP_OVERWRITE="overwrite",g.file.DUP_FAIL="fail",g.file.DUP_RENAME="rename",g.file.ACCESS_PUBLIC=1,g.file.ACCESS_READ=2,g.file.ACCESS_WRITE=4,g.file.ACCESS_CREATE=8,g.file.ACCESS_DELETE=16,g.file.ACCESS_ACL_READ=32,g.file.ACCESS_ACL_WRITE=64,g.file.ACCESS_ALL=65534,g.provider.register=function(a,b){if(h[a]=b,i||(i=b),"function"!=typeof b.handle)throw new Error("Not implement: provider.handle()")},g.provider.use=function(a){i=h[a]},g.provider.init=function(a,b){var c=h[a];return c&&"function"==typeof c.init?c.init.call(c,b):null},g.user.impl=function(a){k=a},["check","login","logout"].forEach(function(b){g.user[b]=function(){return a.resolve(k[b].apply(k,arguments))}}),["read","write","list","move","delete","mkdir","readAcl","writeAcl"].forEach(function(b){g.file[b]=function(c){return g.user.check().then(function(d){var e=c.provider?h[c.provider]:i,j=new f(c.path,b,d);return"write"==b&&(j.dupPolicy=c.ondup,j.data=new g.file.Data(c.content),delete c.ondup),"move"==b&&(j.newPath=c.newPath,delete c.newPath),"writeAcl"==b&&(j.acl=c.acl,delete c.acl),delete c.provider,delete c.path,j.extra=c,a.resolve(e.handle(j))})}}),window.fio=g}(Promise),function(a,b){function c(a){o=a.apiKey}function d(a){return Promise.resolve(b.ajax(a))}function e(){for(var a,b=r.current,c=/[&\?#](\w+?)=([^&]+)/g,d={};a=c.exec(b);)d[a[1]]=a[2];return d}function f(){var a=document.cookie,b=new RegExp(o+"_ak=(.+?);"),c=b.exec(a);return c&&decodeURIComponent(c[1])||null}function g(a,b){var c=o+"_ak="+encodeURIComponent(a);c+="; max-age="+(b||60),document.cookie=c}function h(){document.cookie=o+"_ak="}function i(){var a=e();if(a.access_token)g(a.access_token,a.state),document.location.href=r.current.substr(0,document.location.href.indexOf("#"));else if(p=f(),!p)return null;return d({url:r.getLoggedInUser,data:{access_token:p},dataType:"jsonp"}).then(function(a){return a.error?(p=null,h(),null):(q=new fio.user.User(a.uid,a.uname),q.smallImage="http://tb.himg.baidu.com/sys/portraitn/item/"+a.portrait,q.largeImage="http://tb.himg.baidu.com/sys/portrait/item/"+a.portrait,q.access_token=p,q)})}function j(b){a.location.href=r.authorize+"?"+["client_id="+o,"response_type=token","scope=basic netdisk","redirect_uri="+r.current,"display=page","force_login="+(b&&b.force?1:0),"state="+b.remember].join("&")}function k(){var a=q;return q=null,p=null,h(),a}function l(a){var b=new fio.file.File(a.path);return b.createTime=new Date(1e3*a.ctime),b.modifyTime=new Date(1e3*a.mtime),b.size=a.size,b.isDir=!!a.isdir,b}function m(a){return d({url:r.file,data:{method:"meta",access_token:p,path:a},dataType:"json"})}function n(a){function b(a){throw new Error([a.error_code,a.error_msg])}if(!p)throw new Error("Not Authorized");var c={access_token:p},e={url:r.file,type:"GET",data:c,dataType:"JSON"};switch(a.method!=fio.file.METHOD_MOVE?c.path=a.path:c.from=a.path,a.method){case fio.file.METHOD_ACL_READ:case fio.file.METHOD_ACL_WRITE:throw new Error("Not Supported File Request:"+a.method);case fio.file.METHOD_READ:e.dataType="text",c.method="download";break;case fio.file.METHOD_WRITE:e.type="POST",c.method="upload",c.file=a.data.content,c.ondup=a.dupPolicy==fio.file.DUP_OVERWRITE?"overwrite":"newcopy";break;case fio.file.METHOD_LIST:c.method="list";break;case fio.file.METHOD_MKDIR:e.type="POST",c.method="mkdir";break;case fio.file.METHOD_MOVE:e.type="POST",c.method="move",c.to=a.newPath;break;case fio.file.METHOD_DELETE:e.type="POST",c.method="delete"}return d(e).then(function(d){if(d.error_code&&b(d),a.method===fio.file.METHOD_READ)return m(c.path).then(function(a){var b=l(a.list[0]);return b.data=new fio.file.Data(d),b});if(a.method==fio.file.METHOD_LIST)return d.list.map(l);if(a.method==fio.file.METHOD_MOVE)return m(d.to).then(l);if(a.method==fio.file.METHOD_DELETE)return new fio.file.File(a.path);var e=l(d);return a.method===fio.file.METHOD_WRITE&&(e.data=a.data),e},function(a){if(console.log(a),!a.responseText)throw a;b(JSON.parse(a.responseText))})}var o,p,q,r={authorize:"https://openapi.baidu.com/oauth/2.0/authorize",getLoggedInUser:"https://openapi.baidu.com/rest/2.0/passport/users/getLoggedInUser",current:a.location.href,file:"https://pcs.baidu.com/rest/2.0/pcs/file"};fio.user.impl({check:i,login:j,logout:k}),fio.provider.register("netdisk",{init:c,handle:n})}(window,jQuery),window.jQuery&&function(a){a.extend({xml2json:function(b,c){function d(b,g){if(!b)return null;{var h="",i=null,j=null;b.nodeType,e(b.localName||b.nodeName),b.text||b.nodeValue||""}b.childNodes&&b.childNodes.length>0&&a.each(b.childNodes,function(a,b){var c=b.nodeType,g=e(b.localName||b.nodeName),j=b.text||b.nodeValue||"";if(8!=c)if(3!=c&&4!=c&&g)i=i||{},i[g]?(i[g].length||(i[g]=f(i[g])),i[g]=f(i[g]),i[g][i[g].length]=d(b,!0),i[g].length=i[g].length):i[g]=d(b);else{if(j.match(/^\s+$/))return;h+=j.replace(/^\s+/,"").replace(/\s+$/,"")}}),b.attributes&&b.attributes.length>0&&(j={},i=i||{},a.each(b.attributes,function(a,b){var c=e(b.name),d=b.value;j[c]=d,i[c]?(i[cnn]=f(i[cnn]),i[c][i[c].length]=d,i[c].length=i[c].length):i[c]=d})),i&&(i=a.extend(""!=h?new String(h):{},i||{}),h=i.text?[i.text||""].concat([h]):h,h&&(i.text=h),h="");var k=i||h;return c&&(h&&(k={}),h=k.text||h||"",h&&(k.text=h),g||(k=f(k))),k}if(!b)return{};var e=function(a){return String(a||"").replace(/-/g,"_")},f=function(b){return a.isArray(b)||(b=[b]),b.length=b.length,b};if("string"==typeof b&&(b=a.text2xml(b)),b.nodeType){if(3==b.nodeType||4==b.nodeType)return b.nodeValue;var g=9==b.nodeType?b.documentElement:b,h=d(g,!0);return b=null,g=null,h}},text2xml:function(b){return a.parseXML(b)}})}(jQuery),function(a){function b(){var a=-1,b=this;b.append=function(c){var d,e=b.table;for(d=0;d<c.length;d++)a=a>>>8^e[255&(a^c[d])]},b.get=function(){return~a}}function c(a,b,c){return a.slice?a.slice(b,b+c):a.webkitSlice?a.webkitSlice(b,b+c):a.mozSlice?a.mozSlice(b,b+c):a.msSlice?a.msSlice(b,b+c):void 0}function d(a,b){var c,d;return c=new ArrayBuffer(a),d=new Uint8Array(c),b&&d.set(b,0),{buffer:c,array:d,view:new DataView(c)}}function e(){}function f(a){function b(b,c){var f=new Blob([a],{type:"text/plain"});d=new h(f),d.init(function(){e.size=d.size,b()},c)}function c(a,b,c,e){d.readUint8Array(a,b,c,e)}var d,e=this;e.size=0,e.init=b,e.readUint8Array=c}function g(b){function c(a){for(var c=b.length;"="==b.charAt(c-1);)c--;f=b.indexOf(",")+1,g.size=Math.floor(.75*(c-f)),a()}function e(c,e,g){var h,i=d(e),j=4*Math.floor(c/3),k=4*Math.ceil((c+e)/3),l=a.atob(b.substring(j+f,k+f)),m=c-3*Math.floor(j/4);for(h=m;m+e>h;h++)i.array[h-m]=l.charCodeAt(h);g(i.array)}var f,g=this;g.size=0,g.init=c,g.readUint8Array=e}function h(a){function b(b){this.size=a.size,b()}function d(b,d,e,f){var g=new FileReader;g.onload=function(a){e(new Uint8Array(a.target.result))},g.onerror=f,g.readAsArrayBuffer(c(a,b,d))}var e=this;e.size=0,e.init=b,e.readUint8Array=d}function i(a){function b(b,c){var d;e.data?b():(d=new XMLHttpRequest,d.addEventListener("load",function(){e.size||(e.size=Number(d.getResponseHeader("Content-Length"))),e.data=new Uint8Array(d.response),b()},!1),d.addEventListener("error",c,!1),d.open("GET",a),d.responseType="arraybuffer",d.send())}function c(b,c){var d=new XMLHttpRequest;d.addEventListener("load",function(){e.size=Number(d.getResponseHeader("Content-Length")),b()},!1),d.addEventListener("error",c,!1),d.open("HEAD",a),d.send()}function d(a,c,d,f){b(function(){d(new Uint8Array(e.data.subarray(a,a+c)))},f)}var e=this;e.size=0,e.init=c,e.readUint8Array=d}function j(a){function b(b,c){var d=new XMLHttpRequest;d.addEventListener("load",function(){e.size=Number(d.getResponseHeader("Content-Length")),"bytes"==d.getResponseHeader("Accept-Ranges")?b():c(M)},!1),d.addEventListener("error",c,!1),d.open("HEAD",a),d.send()}function c(b,c,d,e){var f=new XMLHttpRequest;f.open("GET",a),f.responseType="arraybuffer",f.setRequestHeader("Range","bytes="+b+"-"+(b+c-1)),f.addEventListener("load",function(){d(f.response)},!1),f.addEventListener("error",e,!1),f.send()}function d(a,b,d,e){c(a,b,function(a){d(new Uint8Array(a))},e)}var e=this;e.size=0,e.init=b,e.readUint8Array=d}function k(){}function l(){function a(a){d=new Blob([],{type:"text/plain"}),a()}function b(a,b){d=new Blob([d,D?a:a.buffer],{type:"text/plain"}),b()}function c(a,b){var c=new FileReader;c.onload=function(b){a(b.target.result)},c.onerror=b,c.readAsText(d)}var d,e=this;e.init=a,e.writeUint8Array=b,e.getData=c}function m(b){function c(a){g+="data:"+(b||"")+";base64,",a()}function d(b,c){var d,e=h.length,f=h;for(h="",d=0;d<3*Math.floor((e+b.length)/3)-e;d++)f+=String.fromCharCode(b[d]);for(;d<b.length;d++)h+=String.fromCharCode(b[d]);f.length>2?g+=a.btoa(f):h=f,c()}function e(b){b(g+a.btoa(h))}var f=this,g="",h="";f.init=c,f.writeUint8Array=d,f.getData=e}function n(a,b){function c(b,c){a.createWriter(function(a){f=a,b()
},c)}function d(a,c,d){var e=new Blob([D?a:a.buffer],{type:b});f.onwrite=function(){f.onwrite=null,c()},f.onerror=d,f.write(e)}function e(b){a.file(b)}var f,g=this;g.init=c,g.writeUint8Array=d,g.getData=e}function o(a){function b(b){e=new Blob([],{type:a}),b()}function c(b,c){e=new Blob([e,D?b:b.buffer],{type:a}),c()}function d(a){a(e)}var e,f=this;f.init=b,f.writeUint8Array=c,f.getData=d}function p(a,b,c,d,e,f,g,h,i,j){function k(){a.removeEventListener("message",l,!1),h(o)}function l(a){var b=a.data,d=b.data;b.onappend&&(o+=d.length,c.writeUint8Array(d,function(){f(!1,d),m()},j)),b.onflush&&(d?(o+=d.length,c.writeUint8Array(d,function(){f(!1,d),k()},j)):k()),b.progress&&g&&g(n+b.current,e)}function m(){n=p*N,e>n?b.readUint8Array(d+n,Math.min(N,e-n),function(b){a.postMessage({append:!0,data:b}),p++,g&&g(n,e),f(!0,b)},i):a.postMessage({flush:!0})}var n,o,p=0;o=0,a.addEventListener("message",l,!1),m()}function q(a,b,c,d,e,f,g,h,i,j){function k(){var o;l=m*N,e>l?b.readUint8Array(d+l,Math.min(N,e-l),function(b){var h=a.append(b,function(){g&&g(d+l,e)});n+=h.length,f(!0,b),c.writeUint8Array(h,function(){f(!1,h),m++,setTimeout(k,1)},j),g&&g(l,e)},i):(o=a.flush(),o?(n+=o.length,c.writeUint8Array(o,function(){f(!1,o),h(n)},j)):h(n))}var l,m=0,n=0;k()}function r(c,d,e,f,g,h,i,j,k){function l(a,b){g&&!a&&o.append(b)}function m(a){h(a,o.get())}var n,o=new b;return a.zip.useWebWorkers?(n=new Worker(a.zip.inflateJSPath||O),p(n,c,d,e,f,l,i,m,j,k)):q(new a.zip.Inflater,c,d,e,f,l,i,m,j,k),n}function s(c,d,e,f,g,h,i){function j(a,b){a&&n.append(b)}function k(a){f(a,n.get())}function l(){m.removeEventListener("message",l,!1),p(m,c,d,0,c.size,j,g,k,h,i)}var m,n=new b;return a.zip.useWebWorkers?(m=new Worker(a.zip.workerScriptsPath+P),m.addEventListener("message",l,!1),m.postMessage({init:!0,level:e})):q(new a.zip.Deflater,c,d,0,c.size,j,g,k,h,i),m}function t(a,c,d,e,f,g,h,i,j){function k(){var b=l*N;e>b?a.readUint8Array(d+b,Math.min(N,e-b),function(a){f&&m.append(a),h&&h(b,e,a),c.writeUint8Array(a,function(){l++,k()},j)},i):g(e,m.get())}var l=0,m=new b;k()}function u(a){var b,c,d="",e=["Ç","ü","é","â","ä","à","å","ç","ê","ë","è","ï","î","ì","Ä","Å","É","æ","Æ","ô","ö","ò","û","ù","ÿ","Ö","Ü","ø","£","Ø","×","ƒ","á","í","ó","ú","ñ","Ñ","ª","º","¿","®","¬","½","¼","¡","«","»","_","_","_","¦","¦","Á","Â","À","©","¦","¦","+","+","¢","¥","+","+","-","-","+","-","+","ã","Ã","+","+","-","-","¦","-","+","¤","ð","Ð","Ê","Ë","È","i","Í","Î","Ï","+","+","_","_","¦","Ì","_","Ó","ß","Ô","Ò","õ","Õ","µ","þ","Þ","Ú","Û","Ù","ý","Ý","¯","´","­","±","_","¾","¶","§","÷","¸","°","¨","·","¹","³","²","_"," "];for(b=0;b<a.length;b++)c=255&a.charCodeAt(b),d+=c>127?e[c-128]:String.fromCharCode(c);return d}function v(a){var b=[],c=0,d=0,e=0,f=0,g=0;for(a+="";c<a.length;)e=a.charCodeAt(c),128>e?(b[d++]=String.fromCharCode(e),c++):e>191&&224>e?(f=a.charCodeAt(c+1),b[d++]=String.fromCharCode((31&e)<<6|63&f),c+=2):(f=a.charCodeAt(c+1),g=a.charCodeAt(c+2),b[d++]=String.fromCharCode((15&e)<<12|(63&f)<<6|63&g),c+=3);return b.join("")}function w(a){var b,c="";for(b=0;b<a.length;b++)c+=String.fromCharCode(a[b]);return c}function x(a){var b=(4294901760&a)>>16,c=65535&a;try{return new Date(1980+((65024&b)>>9),((480&b)>>5)-1,31&b,(63488&c)>>11,(2016&c)>>5,2*(31&c),0)}catch(d){}}function y(a,b,c,d,e){return a.version=b.view.getUint16(c,!0),a.bitFlag=b.view.getUint16(c+2,!0),a.compressionMethod=b.view.getUint16(c+4,!0),a.lastModDateRaw=b.view.getUint32(c+6,!0),a.lastModDate=x(a.lastModDateRaw),1===(1&a.bitFlag)?void e(F):((d||8!=(8&a.bitFlag))&&(a.crc32=b.view.getUint32(c+10,!0),a.compressedSize=b.view.getUint32(c+14,!0),a.uncompressedSize=b.view.getUint32(c+18,!0)),4294967295===a.compressedSize||4294967295===a.uncompressedSize?void e(G):(a.filenameLength=b.view.getUint16(c+22,!0),void(a.extraFieldLength=b.view.getUint16(c+24,!0))))}function z(a,b){function c(){}function e(c,f){a.readUint8Array(a.size-c,c,function(a){var g=d(a.length,a).view;try{1347093766!=g.getUint32(0)?e(c+1,f):f(g)}catch(h){console.log(h),b(H)}},function(){b(H)})}return c.prototype.getData=function(c,e,f,g){function h(a,b){m&&m.terminate(),m=null,a&&a(b)}function i(a){var b=d(4);return b.view.setUint32(0,a),n.crc32==b.view.getUint32(0)}function j(a,b){g&&!i(b)?k():c.getData(function(a){h(e,a)})}function k(){h(b,K)}function l(){h(b,J)}var m,n=this;a.readUint8Array(n.offset,30,function(e){var h,i=d(e.length,e);return 1347093252!=i.view.getUint32(0)?void b(E):(y(n,i,4,!1,function(a){b(a)}),h=n.offset+30+n.filenameLength+n.extraFieldLength,void c.init(function(){0===n.compressionMethod?t(a,c,h,n.compressedSize,g,j,f,k,l):m=r(a,c,h,n.compressedSize,g,j,f,k,l)},l))},k)},{getEntries:function(f){return a.size<22?void b(E):void e(22,function(e){var g,h;g=e.getUint32(16,!0),h=e.getUint16(8,!0),a.readUint8Array(g,a.size-g,function(a){var e,g,i,j,k=0,l=[],m=d(a.length,a);for(e=0;h>e;e++){if(g=new c,1347092738!=m.view.getUint32(k))return void b(E);y(g,m,k+6,!0,function(a){b(a)}),g.commentLength=m.view.getUint16(k+32,!0),g.directory=16==(16&m.view.getUint8(k+38)),g.offset=m.view.getUint32(k+42,!0),i=w(m.array.subarray(k+46,k+46+g.filenameLength)),g.filename=2048===(2048&g.bitFlag)?v(i):u(i),g.directory||"/"!=g.filename.charAt(g.filename.length-1)||(g.directory=!0),j=w(m.array.subarray(k+46+g.filenameLength+g.extraFieldLength,k+46+g.filenameLength+g.extraFieldLength+g.commentLength)),g.comment=2048===(2048&g.bitFlag)?v(j):u(j),l.push(g),k+=46+g.filenameLength+g.extraFieldLength+g.commentLength}f(l)},function(){b(H)})})},close:function(a){a&&a()}}}function A(a){var b,c,d,e=[],f=0,g=0,h=a.length;for(b=0;h>b;b++)c=a.charCodeAt(b),d=null,128>c?g++:d=c>127&&2048>c?String.fromCharCode(c>>6|192)+String.fromCharCode(63&c|128):String.fromCharCode(c>>12|224)+String.fromCharCode(c>>6&63|128)+String.fromCharCode(63&c|128),null!=d&&(g>f&&(e+=a.slice(f,g)),e+=d,f=g=b+1);return g>f&&(e+=a.slice(f,h)),e}function B(a){var b,c=[];for(b=0;b<a.length;b++)c.push(a.charCodeAt(b));return c}function C(a,b,c){function e(a,b){h&&h.terminate(),h=null,a&&a(b)}function f(){e(b,I)}function g(){e(b,K)}var h,i=[],j=[],k=0;return{add:function(b,l,m,n,o){function p(e){var g;w=o.lastModDate||new Date,u=d(26),i[b]={headerArray:u.array,directory:o.directory,filename:v,offset:k,comment:B(A(o.comment||""))},u.view.setUint32(0,335546376),o.version&&u.view.setUint8(0,o.version),c||0==o.level||o.directory||u.view.setUint16(4,2048),u.view.setUint16(6,(w.getHours()<<6|w.getMinutes())<<5|w.getSeconds()/2,!0),u.view.setUint16(8,(w.getFullYear()-1980<<4|w.getMonth()+1)<<5|w.getDate(),!0),u.view.setUint16(22,v.length,!0),g=d(30+v.length),g.view.setUint32(0,1347093252),g.array.set(u.array,4),g.array.set(v,30),k+=g.array.length,a.writeUint8Array(g.array,e,f)}function q(b,c){var g=d(16);k+=b||0,g.view.setUint32(0,1347094280),"undefined"!=typeof c&&(u.view.setUint32(10,c,!0),g.view.setUint32(4,c,!0)),l&&(g.view.setUint32(8,b,!0),u.view.setUint32(14,b,!0),g.view.setUint32(12,l.size,!0),u.view.setUint32(18,l.size,!0)),a.writeUint8Array(g.array,function(){k+=16,e(m)},f)}function r(){if(o=o||{},b=b.trim(),o.directory&&"/"!=b.charAt(b.length-1)&&(b+="/"),i[b])throw L;v=B(A(b)),j.push(b),p(function(){l?c||0==o.level?t(l,a,0,l.size,!0,q,n,g,f):h=s(l,a,o.level,q,n,g,f):q()},f)}var u,v,w;l?l.init(r,g):r()},close:function(b){var c,g=0,h=0;j.forEach(function(a){var b=i[a];g+=46+b.filename.length+b.comment.length}),c=d(g+22),j.forEach(function(a){var b=i[a];c.view.setUint32(h,1347092738),c.view.setUint16(h+4,5120),c.array.set(b.headerArray,h+6),c.view.setUint16(h+32,b.comment.length,!0),b.directory&&c.view.setUint8(h+38,16),c.view.setUint32(h+42,b.offset,!0),c.array.set(b.filename,h+46),c.array.set(b.comment,h+46+b.filename.length),h+=46+b.filename.length+b.comment.length}),c.view.setUint32(h,1347093766),c.view.setUint16(h+8,j.length,!0),c.view.setUint16(h+10,j.length,!0),c.view.setUint32(h+12,g,!0),c.view.setUint32(h+16,k,!0),a.writeUint8Array(c.array,function(){e(function(){a.getData(b)})},f)}}}var D,E="File format is not recognized.",F="File contains encrypted entry.",G="File is using Zip64 (4gb+ file size).",H="Error while reading zip file.",I="Error while writing zip file.",J="Error while writing file data.",K="Error while reading file data.",L="File already exists.",M="HTTP Range not supported.",N=524288,O="inflate.js",P="deflate.js";try{D=0==new Blob([d(0).view]).size}catch(Q){}b.prototype.table=function(){var a,b,c,d=[];for(a=0;256>a;a++){for(c=a,b=0;8>b;b++)1&c?c=c>>>1^3988292384:c>>>=1;d[a]=c}return d}(),f.prototype=new e,f.prototype.constructor=f,g.prototype=new e,g.prototype.constructor=g,h.prototype=new e,h.prototype.constructor=h,i.prototype=new e,i.prototype.constructor=i,j.prototype=new e,j.prototype.constructor=j,k.prototype.getData=function(a){a(this.data)},l.prototype=new k,l.prototype.constructor=l,m.prototype=new k,m.prototype.constructor=m,n.prototype=new k,n.prototype.constructor=n,o.prototype=new k,o.prototype.constructor=o,a.zip={Reader:e,Writer:k,BlobReader:h,HttpReader:i,HttpRangeReader:j,Data64URIReader:g,TextReader:f,BlobWriter:o,FileWriter:n,Data64URIWriter:m,TextWriter:l,createReader:function(a,b,c){a.init(function(){b(z(a,c))},c)},createWriter:function(a,b,c,d){a.init(function(){b(C(a,c,d))},c)},workerScriptsPath:"",inflateJSPath:"",useWebWorkers:!0}}(this),function(){var a=[];KityMinder.registerUI=function(b,c,d){"function"==typeof c&&(d=c,c=null),a.push({id:b,ui:d,deps:c})},kity.extendClass(Minder,{initUI:function(){var b=this._ui={},c=this;a.forEach(function(a){var d=a.deps;d&&(d=d.map(function(a){return c.getUI(a)})),b[a.id]=a.ui.apply(null,[c].concat(d||[]))}),$("#content-wrapper").delegate("#panel, #tab-container, .fui-dialog","click mousedown keydown keyup",function(a){a.stopPropagation()}),this.fire("interactchange")},getUI:function(a){return this._ui[a]}})}(),kity.extendClass(FUI.Widget,{setEnable:function(a){a===!1?this.disable():this.enable()},setActive:function(a){a===!1?this.removeClass("active"):this.addClass("active")},bindCommandState:function(a,b,c){var d=this;a.on("interactchange",function(){d.setEnable(-1!==this.queryCommandState(b)),d.setActive(1===this.queryCommandState(b)),c&&c.call(d,this.queryCommandValue(b))})}}),KityMinder.registerUI("mainmenu",function(){var a,b=new FUI.Button({id:"main-menu-btn"});return b.setLabel("百度脑图"),b.appendTo(document.getElementById("panel")),b.on("click",function(){a.addClass("show")}),a=$('<div id="main-menu"></div>').appendTo("body"),a.click(function(){a.removeClass("show")}),a}),KityMinder.registerUI("commandbutton",function(a){return{generate:function(b,c){var d=new FUI.Button({label:a.getLang("ui."+b),text:a.getLang("ui."+b),className:["command-widget","command-button",b]});return d.on("click",c||function(){a.execCommand(b)}),d.bindCommandState(a,b),d}}}),KityMinder.registerUI("commandbuttonset",function(a){function b(b,c){return c.map(function(c){var d=a.getLang([b,c].join("."))||c;return{label:d,text:d,value:c,className:[b,c].join(" ")}})}function c(c,d){var e=new FUI.Buttonset({id:"template-set",buttons:"object"==typeof d[0]?d:b(c,d),className:["command-widget","command-buttonset",c].join(" ")});return e.on("change",function(){a.execCommand(c,e.getValue())}),e.bindCommandState(a,c,function(a){this.selectByValue(a)}),e}return{generate:c}}),KityMinder.registerUI("commandinputmenu",function(a){function b(b,c){var d=new FUI.InputMenu({menu:{items:c},input:{placeholder:a.getLang("ui."+b)},className:["command-widget","command-inputmenu",b]}),e=!1;d.bindCommandState(a,b,function(a){e=!0,d.selectByValue(a)||d.clearSelect(),e=!1});var f=-1;return d.on("select",function(c,g){e||(~g.index?a.execCommand(b,g.value):d.select(f),f=g.index)}),d}return{generate:b}}),KityMinder.registerUI("history",["commandbutton"],function(a,b){var c={};return["undo","redo"].forEach(function(a){c[a]=b.generate(a).appendTo(document.getElementById("panel"))}),c}),KityMinder.registerUI("tabs",function(){var a=new FUI.Tabs({buttons:["思路","展现","视图"]}),b=$('<div id="tab-select"></div>').appendTo("#panel"),c=$('<div id="tab-container"></div>');$("#panel").after(c),a.appendButtonTo(b[0]),a.appendPanelTo(c[0]);var d=0;return a.on("tabsselect",function(a,e){e.index==d?(c.toggleClass("collapsed"),b.toggleClass("collapsed")):(c.removeClass("collapsed"),b.removeClass("collapsed")),d=e.index}),a.idea=a.getPanel(0),a.edit=a.getPanel(1),a.view=a.getPanel(2),a}),KityMinder.registerUI("title",function(){var a=$("<h1>").appendTo("#panel").text("百度脑图");return a}),KityMinder.registerUI("account",function(){}),KityMinder.registerUI("template",["tabs"],function(a,b){var c=a.getUI("commandbuttonset"),d=new FUI.LabelPanel({id:"template-panel",label:a.getLang("panels.template")}),e=new FUI.DropPanel({id:"template-select"});b.edit.appendWidget(d),d.appendWidget(e);var f=KityMinder.Utils.keys(KityMinder.getTemplateList());return e.appendWidget(c.generate("template",f)),d}),KityMinder.registerUI("theme",["tabs"],function(a,b){var c=a.getUI("commandbuttonset"),d=new FUI.LabelPanel({id:"theme-panel",label:a.getLang("panels.theme")}),e=new FUI.DropPanel({id:"theme-select"});b.edit.appendWidget(d),d.appendWidget(e);var f=KityMinder.Utils.keys(KityMinder.getThemeList());return e.appendWidget(c.generate("theme",f.map(function(b){var c=KityMinder._themes[b];return{label:{text:a.getLang("theme."+b),style:{background:c["root-background"],color:c["root-color"],borderRadius:c["root-radius"]/2}},text:a.getLang("theme."+b),value:b,className:["theme",b].join(" ")}}))),d}),KityMinder.registerUI("layout",["tabs","commandbuttonset","commandbutton"],function(a,b,c,d){var e=new FUI.LabelPanel({id:"layout-panel",label:a.getLang("panels.layout")}).appendTo(b.edit),f=new FUI.DropPanel({id:"layout-select"}).appendTo(e),g=KityMinder.Utils.keys(KityMinder.getLayoutList());return f.appendWidget(c.generate("layout",g)),d.generate("resetlayout").appendTo(e).addClass("large"),e}),KityMinder.registerUI("style",["tabs","commandbutton"],function(a,b,c){var d=new FUI.LabelPanel({label:a.getLang("panels.style")}).appendTo(b.edit);c.generate("clearstyle").addClass("large").appendTo(d);var e=new FUI.Panel({column:!0}).appendTo(d);return c.generate("copystyle").appendTo(e),c.generate("pastestyle").appendTo(e),d}),KityMinder.registerUI("font",["tabs","commandinputmenu","commandbutton"],fontUI),KityMinder.registerUI("color",["tabs","commandbuttonset"],function(a,b,c){var d=new FUI.LabelPanel({label:a.getLang("panels.color")}).appendTo(b.edit),e=new FUI.LabelPanel({label:a.getLang("panels.background")}).appendTo(b.edit),f=generateSerisColor();return d.appendWidget(c.generate("forecolor",f.map(function(a){return{icon:{style:{background:a}},label:a,text:a,value:a}})).addClass("color-picker")),e.appendWidget(c.generate("background",f.map(function(a){return{icon:{style:{background:a}},label:a,text:a,value:a}})).addClass("color-picker")),{color:d,background:e}}),KityMinder.registerUI("insertnode",["tabs","commandbutton"],function(a,b,c){var d=new FUI.LabelPanel({label:a.getLang("panels.insert"),column:!0});return c.generate("appendchildnode").appendTo(d),c.generate("appendsiblingnode").appendTo(d),b.idea.appendWidget(d),d}),KityMinder.registerUI("arrange",["tabs","commandbutton"],function(a,b,c){var d=new FUI.LabelPanel({label:a.getLang("panels.arrange"),column:!0});return c.generate("arrangeup").appendTo(d),c.generate("arrangedown").appendTo(d),b.idea.appendWidget(d),d}),KityMinder.registerUI("nodeop",["tabs","commandbutton"],function(a,b,c){var d=new FUI.LabelPanel({label:a.getLang("panels.nodeop"),column:!0}).appendTo(b.idea);["editnode","removenode"].forEach(function(a){c.generate(a).appendTo(d)})}),KityMinder.registerUI("priority",["tabs","commandbuttonset"],function(a,b,c){var d=new FUI.LabelPanel({label:a.getLang("panels.priority")}).appendTo(b.idea);return c.generate("priority",[1,2,3,4,5,6,7,8,9,0].map(function(b){return{label:b,text:a.getLang("ui.priority")+b,value:b,className:["priority",b].join("-")}})).appendTo(d),d}),KityMinder.registerUI("progress",["tabs","commandbuttonset"],function(a,b,c){var d=new FUI.LabelPanel({label:a.getLang("panels.progress")}).appendTo(b.idea);return c.generate("progress",[1,2,3,4,5,6,7,8,9,0].map(function(b){return{label:b,text:a.getLang("ui.progress.p"+b),value:b,className:["progress",b].join("-")}})).appendTo(d),d}),KityMinder.registerUI("resource",["tabs","commandbuttonset"],function(a,b){function c(){var b=h.getValue(),c=a.queryCommandValue("resource");b&&(c.push(b),a.execCommand("resource",c)),h.setValue(null),f(),h.focus()}function d(a,b){return[a.join(","),b.join(",")].join(";")}function e(a,b){var c=d(a,b);return c==e.lastHash?!0:(e.lastHash=c,!1)}function f(){var b=a.queryCommandValue("resource"),c=a.getUsedResource();if(e(b,c))switch(l.empty().append(c.map(function(c){{var d=$("<li></li>"),e=$("<label></label>").appendTo(d);$('<input type="checkbox" />').data("resource",c).prop("checked",~b.indexOf(c)).appendTo(e)}e.append(c);var f=a.getResourceColor(c);return d.css({color:f.dec("l",60).toString(),backgroundColor:~b.indexOf(c)?f:f.dec("a",.85).toRGBA()})})),a.queryCommandState("resource")){case 0:h.enable(),i.enable(),j.enable(),l.find("input[type=checkbox]").removeProp("disabled");break;case-1:h.disable(),i.disable(),j.disable(),l.find("input[type=checkbox]").prop("disabled","disabled")}}var g=new FUI.LabelPanel({label:a.getLang("panels.resource"),id:"resource-panel"}).appendTo(b.idea),h=(new FUI.Input).appendTo(g),i=new FUI.Button({label:"添加"}).appendTo(g),j=(new FUI.DropPanel).appendTo(g),k=$(j.getPanelElement()),l=$("<ul></ul>").addClass("resource-list").appendTo(k);return h.on("inputcomplete",function(){c()}),i.on("click",c),k.delegate("input[type=checkbox]","change",function(){a.execCommand("resource",k.find("input[type=checkbox]:checked").map(function(a,b){return $(b).data("resource")}).toArray()),f()}),a.on("interactchange",f),g}),KityMinder.registerUI("attachment",["tabs"],function(a,b){var c=new FUI.LabelPanel({label:a.getLang("panels.attachment"),coloum:!0}).appendTo(b.idea);return c}),KityMinder.registerUI("link",["attachment"],function(a,b){function c(a){a?(g.addClass("validate-error"),i.text("地址格式错误"),h.disable()):(g.removeClass("validate-error"),i.text(""),h.enable())}var d=new FUI.ButtonMenu({id:"link-button-menu",text:a.getLang("ui.link"),layout:"bottom",buttons:[{},{label:a.getLang("ui.link")}],menu:{items:[a.getLang("ui.removelink")]}}).appendTo(b);d.bindCommandState(a,"hyperlink");var e=new FUI.Dialog({width:600,height:200,caption:a.getLang("ui.link")}).appendTo(document.getElementById("content-wrapper")),f=$(e.getBodyElement());f.html(['<p><label>连接地址：</label><input type="url" class="link-href" /></p>','<p><label>提示文本：</label><input type="text" class="link-title /"></p>'].join(""));var g=f.find(".link-href"),h=e.getButton(0),i=$('<span class="validate-error"></span>');return g.after(i),g.on("input",function(){var a=g.val();c(!/^https?\:\/\/(\w+\.)+\w+/.test(a))}),d.on("buttonclick",function(){e.open(),g[0].focus()}),d.on("select",function(){a.execCommand("unhyperlink")}),e.on("ok",function(){a.execCommand("hyperlink",g.val())}),e.on("open",function(){g.val(a.queryCommandValue("hyperlink")),c(!1)}),d}),KityMinder.registerUI("image",["attachment"],function(a,b){function c(a){return a?(g.addClass("validate-error"),j.text("图片无法加载"),i.disable()):(g.removeClass("validate-error"),j.text(""),i.enable()),a}var d=new FUI.ButtonMenu({id:"image-button-menu",text:a.getLang("ui.image"),layout:"bottom",buttons:[{},{label:a.getLang("ui.image")}],menu:{items:[a.getLang("ui.removeimage")]}}).appendTo(b);d.bindCommandState(a,"image");var e=new FUI.Dialog({width:500,height:400,caption:a.getLang("ui.image")}).appendTo(document.getElementById("content-wrapper"));e.on("ok",function(){a.execCommand("image",g.val())}),e.on("open",function(){g.val(a.queryCommandValue("image")),h.attr("src",""),c(!1)});var f=$(e.getBodyElement());f.html(['<p><label>图片地址：</label><input type="url" class="image-url" /></p>','<p><label>提示文本：</label><input type="text" class="image-title /"></p>','<img class="image-preview" src="" style="max-height: 200px;" />'].join(""));var g=f.find(".image-url"),h=f.find(".image-preview"),i=e.getButton(0),j=$('<span class="validate-error"></span>');return g.after(j),g.on("input",function(){var a=g.val();/^https?\:\/\/(\w+\.)+\w+/.test(a)?(h.attr("src",a),c(!1),i.disable(),h.addClass("loading")):c(!0)}),h.on("load",function(){c(!1),h.removeClass("loading")}).on("error",function(){h.attr("src")&&c(!0),h.removeClass("loading")}),d.on("buttonclick",function(){e.open(),g[0].focus()}),d.on("select",function(){a.execCommand("removeimage")}),d})}(window);